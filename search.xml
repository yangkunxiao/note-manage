<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>webpackåŸºç¡€</title>
      <link href="/2019/12/24/Webpack/index/"/>
      <url>/2019/12/24/Webpack/index/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> webpack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptå¼ºåˆ¶ç±»å‹è½¬æ¢</title>
      <link href="/2019/12/20/JavaScript/%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"/>
      <url>/2019/12/20/JavaScript/%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<h3 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h3><p>åœ¨è¯´JavaScriptçš„å¼ºåˆ¶ç±»å‹è½¬æ¢ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸‹JavaScriptä¸­çš„æ•°æ®ç±»å‹æœ‰å“ªäº›ã€‚JavaScriptä¸­ç±»å‹åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ï¼š</p><ul><li>åŸå§‹æ•°æ®ç±»å‹ï¼šnullã€undefinedã€boolã€stringã€numberã€booleanä»¥åŠsymbolï¼ˆes6æå‡ºï¼‰</li><li>å¯¹è±¡æ•°æ®ç±»å‹ï¼šObjectï¼ˆfunctionã€date ç­‰å±äºObjectçš„å­ç±»å‹ï¼‰</li></ul><p>é‚£ä¹ˆè¿™ä¸¤ç§æ•°æ®ç±»å‹æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><p>åŸå§‹æ•°æ®ç±»å‹åœ¨å†…å­˜ä¸­çš„å­˜æ”¾åœ°ç‚¹æ˜¯å­˜æ”¾åœ¨æ ˆä¸­ï¼Œæ‰€ä»¥åœ¨ä¼ é€’çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯å€¼ä¼ é€’ã€‚</p><p>è€Œå¯¹è±¡æ•°æ®ç±»å‹çš„å­˜æ”¾æ–¹å¼æ˜¯ï¼šçœŸå®æ•°æ®å­˜æ”¾åœ¨å †ä¸­ï¼Œè€Œåœ¨æ ˆä¸­å­˜æ”¾çš„æ˜¯æŒ‡å‘å®é™…æ•°æ®å­˜å‚¨çš„åœ°æ–¹ï¼Œå³å †çš„æŒ‡é’ˆã€‚</p><p>è¿™ä¹Ÿå°±æ˜¯å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’ã€‚</p><h3 id="å­—ç¬¦ä¸²ã€æ•°å­—å’Œå¸ƒå°”ç±»å‹ä¹‹é—´çš„è½¬æ¢"><a href="#å­—ç¬¦ä¸²ã€æ•°å­—å’Œå¸ƒå°”ç±»å‹ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="å­—ç¬¦ä¸²ã€æ•°å­—å’Œå¸ƒå°”ç±»å‹ä¹‹é—´çš„è½¬æ¢"></a>å­—ç¬¦ä¸²ã€æ•°å­—å’Œå¸ƒå°”ç±»å‹ä¹‹é—´çš„è½¬æ¢</h3><h4 id="ToString"><a href="#ToString" class="headerlink" title="ToString"></a>ToString</h4><p>å®ƒè´Ÿè´£å¤„ç†éå­—ç¬¦ä¸²åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢ã€‚</p><p>åŸºæœ¬ç±»å‹å€¼çš„è½¬æ¢è§„åˆ™æ˜¯ï¼šnullè½¬æ¢ä¸ºâ€nullâ€ï¼Œundefinedè½¬æ¢ä¸ºâ€undefinedâ€,å¸ƒå°”è½¬æ¢æˆå¯¹åº”çš„æ•°å­—ï¼štrueè½¬æ¢ä¸º1ï¼Œfalseè½¬æ¢ä¸º0ã€‚æ•°å­—ç›´æ¥è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ä¸²ã€‚</p><p>å¯¹åº”å¯¹è±¡ï¼Œé™¤éå¯¹è±¡å†…éƒ¨å®šä¹‰äº†tostringæ–¹æ³•ï¼Œå¦åˆ™toString()ï¼ˆObject.prototype.toString()ï¼‰è¿”å›å…¶å†…éƒ¨å±æ€§[[class]]çš„å€¼ã€‚å¦‚æœå†…éƒ¨è‡ªå®šä¹‰äº†toStringæ–¹æ³•ï¼Œåˆ™è°ƒç”¨è¯¥å†…éƒ¨æ–¹æ³•å¹¶ä½¿ç”¨å…¶è¿”å›å€¼ã€‚</p><p>å¯¹è±¡çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ºstringæ˜¯é€šè¿‡<code>Toprimitive</code>æŠ½è±¡æ“ä½œæ¥å®Œæˆçš„ã€‚</p><blockquote><p>ToPrimitive(input,PreferredType?)ï¼šå…¶ä¸­PreferredTypeä¸ºnumberæˆ–è€…stringã€‚</p><p>å¦‚æœinputæ˜¯åŸå§‹å€¼ï¼Œåˆ™è¿”å›è¯¥åŸå§‹å€¼å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚</p><p>å¦‚æœinputä¸æ˜¯åŸå§‹å€¼ï¼Œåˆ™è°ƒç”¨valueOf()æ–¹æ³•ï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å›åŸå§‹å€¼ï¼Œåˆ™ä½¿ç”¨è¯¥æ–¹æ³•è¿”å›å€¼ã€‚</p><p>å¦‚æœvalueOf()è¿”å›çš„ä¸æ˜¯åŸå§‹å€¼ï¼Œåˆ™è°ƒç”¨toString()æ–¹æ³•ï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å›åŸå§‹å€¼ï¼Œåˆ™ä½¿ç”¨è¯¥æ–¹æ³•è¿”å›çš„åŸå§‹å€¼ã€‚</p><p>å¦åˆ™ï¼ŒæŠ¥é”™TypeError</p></blockquote><p>JSONå­—ç¬¦ä¸²åŒ–</p><p>å·¥å…·å‡½æ•°JSON.stringifyå¯ä»¥å°†JSONå¯¹è±¡åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œå†…éƒ¨ä¹Ÿæ˜¯è°ƒç”¨äº†ToStringã€‚</p><p>JSON.stringifyä½¿ç”¨è§„åˆ™ï¼šå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ï¼Œä½¿ç”¨JSON.stringifyå’Œä½¿ç”¨toStringè¿”å›ç»“æœä¸€æ ·ã€‚å¯¹äºæ‰€æœ‰å®‰å…¨çš„JSONå€¼ï¼Œéƒ½å¯ä»¥ä½¿ç”¨JSON.stringifyæ–¹æ³•ï¼Œæ‰€è°“çš„JSONå®‰å…¨å€¼æ˜¯æŒ‡ï¼šé™¤äº†undefinedã€symbolã€functionä»¥åŠåŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ã€‚</p><p>JSON.stringifyæ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°ï¼šå¯ä»¥ä¸ºå­—ç¬¦ä¸²æ•°ç»„æˆ–è€…å‡½æ•°ã€‚å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œåˆ™æ ¹æ®æ•°ç»„å†…çš„å…ƒç´ ï¼Œè¿”å›æŒ‡å®šçš„å¯¹è±¡å±æ€§å’Œå±æ€§å€¼ã€‚å¦‚æœä¸ºå‡½æ•°ï¼Œåˆ™ä¸ºè¿‡æ»¤å‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œkeyã€valueï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è‡ªè¡Œè®¾å®šè¿”å›å€¼ã€‚å¦‚æœä¸éœ€è¦æŸä¸ªå±æ€§ï¼Œè¿”å›undefinedå³å¯è¿‡æ»¤ã€‚</p><p>JSON.stringifyæ¥æ”¶ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šç”¨äºæŒ‡å®šè¾“å‡ºå­—ç¬¦ä¸²çš„è¾“å‡ºæ ¼å¼ã€‚</p><p>å¦‚æœå¯¹è±¡å†…éƒ¨æœ‰è‡ªå®šä¹‰çš„toJSONæ–¹æ³•ï¼Œåˆ™ä½¿ç”¨è¯¥æ–¹æ³•ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>  a<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span>  b<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// toJSON:function(){</span>  <span class="token comment" spellcheck="true">//     return 0</span>  <span class="token comment" spellcheck="true">// }</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">let</span> str <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//è¿‡æ»¤å‡½æ•°</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token number">100</span>  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> value  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> o <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//è¿˜åŸå‡½æ•°</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token number">1</span>  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> value  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="ToNumber"><a href="#ToNumber" class="headerlink" title="ToNumber"></a>ToNumber</h4><p>ç”¨æ¥å°†éæ•°å­—å¤„ç†æˆæ•°å­—ã€‚è½¬æ¢æ–¹å¼éµå¾ªToPrimitiveï¼Œ</p><h4 id="ToBoolean"><a href="#ToBoolean" class="headerlink" title="ToBoolean"></a>ToBoolean</h4><p>JavaScriptä¸­çš„å€¼å¤§æ¦‚å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>å¯ä»¥è¢«å¼ºåˆ¶è½¬æ¢ä¸ºfalseçš„å€¼ï¼Œå¦‚ï¼šundefinedã€nullã€falseã€+0ã€-0ã€NaNå’Œâ€â€</li><li>å…¶ä»–å¯ä»¥è¢«è½¬æ¢ä¸ºtrueçš„å€¼</li></ul><p>å‡å€¼å¯¹è±¡ï¼šå°è£…äº†å‡å€¼çš„å¯¹è±¡ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span> <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//true</span><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//true</span><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span> <span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//true</span></code></pre><p>å®ƒä»¬çš„å€¼ä¸ºtrueï¼Œä½†æ˜¯å¦‚æœå¯¹å…¶è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œåˆ™ç»“æœä¸ºfalseã€‚</p><h3 id="å¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#å¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="å¼ºåˆ¶ç±»å‹è½¬æ¢"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢</h3><h4 id="éšå¼å¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#éšå¼å¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="éšå¼å¼ºåˆ¶ç±»å‹è½¬æ¢"></a>éšå¼å¼ºåˆ¶ç±»å‹è½¬æ¢</h4><h5 id="å­—ç¬¦ä¸²å’Œæ•°å­—çš„éšå¼å¼ºåˆ¶è½¬æ¢"><a href="#å­—ç¬¦ä¸²å’Œæ•°å­—çš„éšå¼å¼ºåˆ¶è½¬æ¢" class="headerlink" title="å­—ç¬¦ä¸²å’Œæ•°å­—çš„éšå¼å¼ºåˆ¶è½¬æ¢"></a>å­—ç¬¦ä¸²å’Œæ•°å­—çš„éšå¼å¼ºåˆ¶è½¬æ¢</h5><p>è¿ç®—ç¬¦ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">"42"</span><span class="token punctuation">;</span><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "420"</span>c <span class="token operator">+</span> d<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 42</span><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "1,23,4"</span></code></pre><blockquote><p>æ ¹æ® ES5 è§„èŒƒ 11.6.1 èŠ‚ï¼Œå¦‚æœæŸä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²æˆ–è€…èƒ½å¤Ÿé€šè¿‡ä»¥ä¸‹æ­¥éª¤è½¬æ¢ä¸ºå­—ç¬¦ä¸² çš„è¯ï¼Œ+ å°†è¿›è¡Œæ‹¼æ¥æ“ä½œã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªæ“ä½œæ•°æ˜¯å¯¹è±¡(åŒ…æ‹¬æ•°ç»„)ï¼Œåˆ™é¦–å…ˆå¯¹å…¶è°ƒç”¨ ToPrimitive æŠ½è±¡æ“ä½œ(è§„èŒƒ 9.1 èŠ‚)ï¼Œè¯¥æŠ½è±¡æ“ä½œå†è°ƒç”¨ [[DefaultValue]](è§„èŒƒ 8.12.8 èŠ‚)ï¼Œä»¥æ•°å­—ä½œä¸ºä¸Šä¸‹æ–‡ã€‚ </p></blockquote><h5 id="å®½æ¾ç›¸ç­‰å’Œä¸¥æ ¼ç›¸ç­‰"><a href="#å®½æ¾ç›¸ç­‰å’Œä¸¥æ ¼ç›¸ç­‰" class="headerlink" title="å®½æ¾ç›¸ç­‰å’Œä¸¥æ ¼ç›¸ç­‰"></a>å®½æ¾ç›¸ç­‰å’Œä¸¥æ ¼ç›¸ç­‰</h5><p>å®½æ¾ç›¸ç­‰(loose equals)== å’Œä¸¥æ ¼ç›¸ç­‰(strict equals)=== éƒ½ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦â€œç›¸ç­‰â€ï¼Œä½†æ˜¯å®ƒä»¬ä¹‹é—´æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„åŒºåˆ«ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ¤æ–­æ¡ä»¶ä¸Šã€‚</p><ul><li>== åœ¨ç›¸ç­‰æ¯”è¾ƒä¸­ï¼Œå…è®¸è¿›è¡Œç±»å‹è½¬æ¢</li><li>=== ä¸å…è®¸ç±»å‹è½¬æ¢</li></ul><h5 id="æŠ½è±¡ç›¸ç­‰"><a href="#æŠ½è±¡ç›¸ç­‰" class="headerlink" title="æŠ½è±¡ç›¸ç­‰"></a>æŠ½è±¡ç›¸ç­‰</h5><ul><li>å¦‚æœè¡¨è¾¾å¼ä¸¤ç«¯éƒ½æ˜¯nullã€undefinedï¼Œåˆ™ä¸ºtrueã€‚</li><li>å¦‚æœNaNåœ¨å…¶ä¸­ä¸€ç«¯ï¼Œåˆ™è¿”å›falseã€‚</li><li>å¦‚æœæ˜¯stringã€numberã€booleanå¹¶ä¸”ç±»å‹ä¸ä¸€è‡´ï¼Œåˆ™å…ˆä½¿ç”¨ToNumberè½¬æ¢ä¸ºnumberåœ¨æ¯”è¾ƒã€‚</li><li>å¦‚æœæ˜¯å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨ToPrimitiveï¼Œè·å–åŸå§‹å€¼å†æ¯”è¾ƒã€‚</li></ul><h4 id="æ˜¾ç¤ºç±»å‹è½¬æ¢"><a href="#æ˜¾ç¤ºç±»å‹è½¬æ¢" class="headerlink" title="æ˜¾ç¤ºç±»å‹è½¬æ¢"></a>æ˜¾ç¤ºç±»å‹è½¬æ¢</h4><h5 id="å­—ç¬¦ä¸²å’Œæ•°å­—çš„æ˜¾ç¤ºå¼ºåˆ¶è½¬æ¢"><a href="#å­—ç¬¦ä¸²å’Œæ•°å­—çš„æ˜¾ç¤ºå¼ºåˆ¶è½¬æ¢" class="headerlink" title="å­—ç¬¦ä¸²å’Œæ•°å­—çš„æ˜¾ç¤ºå¼ºåˆ¶è½¬æ¢"></a>å­—ç¬¦ä¸²å’Œæ•°å­—çš„æ˜¾ç¤ºå¼ºåˆ¶è½¬æ¢</h5><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span> a <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">"3.14"</span><span class="token punctuation">;</span><span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span> c <span class="token punctuation">)</span><span class="token punctuation">;</span>b<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "42"</span>d<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 3.14</span></code></pre><p>String(..) éµå¾ªå‰é¢è®²è¿‡çš„ ToString è§„åˆ™ï¼Œå°†å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²åŸºæœ¬ç±»å‹ã€‚Number(..) éµå¾ª å‰é¢è®²è¿‡çš„ ToNumber è§„åˆ™ï¼Œå°†å€¼è½¬æ¢ä¸ºæ•°å­—åŸºæœ¬ç±»å‹ã€‚ </p><h5 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h5><p>å­—ä½è¿ç®—ç¬¦åªé€‚ç”¨äº 32 ä½æ•´æ•°ï¼Œè¿ç®—ç¬¦ä¼šå¼ºåˆ¶æ“ä½œæ•°ä½¿ç”¨ 32 ä½ æ ¼å¼ã€‚è¿™æ˜¯é€šè¿‡æŠ½è±¡æ“ä½œ ToInt32 æ¥å®ç°çš„ </p><blockquote><p>ToInt32:å…ˆè¯•ç”¨ToNumberè½¬æ¢ä¸ºæ•°å­—ï¼Œå†æ‰§è¡ŒToInt32ã€‚</p></blockquote><p>ï½ï½ï¼š~~ ä¸­çš„ç¬¬ä¸€ä¸ª ~ æ‰§è¡Œ ToInt32 å¹¶åè½¬å­—ä½ã€‚ç„¶åç¬¬äºŒä¸ª ~ å†è¿›è¡Œä¸€æ¬¡å­—ä½åè½¬ï¼Œå³å°†æ‰€æœ‰ å­—ä½åè½¬å›åŸå€¼</p><p>parseIntï¼šåªæ”¯æŒå­—ç¬¦ä¸²è§£ææˆæ•°å­—ã€‚</p><blockquote><p>~~å’ŒparseIntçš„åŒºåˆ«ï¼š</p><p>1ã€è§£ææˆæ•°å­—å…è®¸å­—ç¬¦ä¸²ä¸­æœ‰éæ•°å­—å­—ç¬¦ï¼Œä»å·¦åˆ°å³ä¾æ¬¡è§£æï¼Œé‡åˆ°éæ•°å­—å­—ç¬¦åœæ­¢è§£æ</p><p>2ã€å¼ºåˆ¶è½¬æ¢æˆæ•°å­—ï¼Œä¸å…è®¸å­˜åœ¨éæ•°å­—å­—ç¬¦ï¼Œå¦åˆ™è½¬æ¢å¤±è´¥NaN</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML5æ‹–æ‹½äº‹ä»¶</title>
      <link href="/2019/12/15/JavaScript/drag/"/>
      <url>/2019/12/15/JavaScript/drag/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ç½‘é¡µä¸­ï¼Œæ‹–æ”¾æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„ä¸€ä¸ªç”¨æˆ·ç•Œé¢æ¨¡å¼ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯é¼ æ ‡ç‚¹å‡»ç›®æ ‡å…ƒç´ ä¸æ”¾ï¼Œç§»åŠ¨é¼ æ ‡ä½ç½®ï¼Œç„¶åæ¾å¼€é¼ æ ‡ï¼Œå³å¯å°†ç›®æ ‡å…ƒç´ ç§»åŠ¨åˆ°å¦ä¸€ä¸ªåŒºåŸŸã€‚å®ƒçš„å®ç°å…¶å®å¾ˆç®€å•ã€‚ä»¥ä¸‹ä»‹ç»ä¸¤ç§å¸¸è§çš„å®ç°æ–¹æ³•ã€‚</p><h4 id="ä½¿ç”¨onmouseäº‹ä»¶å®ç°æ‹–æ”¾"><a href="#ä½¿ç”¨onmouseäº‹ä»¶å®ç°æ‹–æ”¾" class="headerlink" title="ä½¿ç”¨onmouseäº‹ä»¶å®ç°æ‹–æ”¾"></a>ä½¿ç”¨onmouseäº‹ä»¶å®ç°æ‹–æ”¾</h4><p>é€šè¿‡ç›‘å¬é¼ æ ‡äº‹ä»¶å®ç°å…ƒç´ æ‹–æ”¾ï¼šå¿…é¡»å€Ÿç”¨<code>onmousedown</code>ã€<code>onmousemove</code>ã€<code>onmouseup</code>ä¸‰ä¸ªäº‹ä»¶å®ç°ï¼Œä¸”ä¸‰è€…çš„é¡ºåºä¸èƒ½ä¹±ã€‚</p><ul><li>onmousedownï¼šé¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ï¼Œä¸€èˆ¬ç”¨åœ¨æ‹–æ”¾å…ƒç´ ä¸Šã€‚</li><li>onmousemoveï¼šé¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œä¸€èˆ¬ç”¨åœ¨documentæˆ–è€…windowä¸Šã€‚</li><li>onmouseupï¼šé¼ æ ‡æŠ¬èµ·äº‹ä»¶ï¼ŒåŒä¸Šã€‚</li></ul><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//è·å–æ‹–æ”¾å…ƒç´ </span><span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è®°å½•é¼ æ ‡ç‚¹å‡»ä½ç½®å’Œå…ƒç´ è¾¹ç•Œçš„è·ç¦»</span><span class="token keyword">var</span> dirX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>dirY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ç»™å…ƒç´ æ·»åŠ ç›‘å¬äº‹ä»¶</span>img<span class="token punctuation">.</span>onmousedown <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  dirX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>    dirY <span class="token operator">=</span> e<span class="token punctuation">.</span>clientY <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>  document<span class="token punctuation">.</span>onmousemove <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//è®°å½•é¼ æ ‡ç§»åŠ¨è·ç¦»</span>    <span class="token keyword">let</span> moveX<span class="token punctuation">,</span> moveY<span class="token punctuation">;</span>     moveX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> dirX<span class="token punctuation">;</span>    moveY <span class="token operator">=</span> e<span class="token punctuation">.</span>clientY <span class="token operator">-</span> dirY<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å¤„ç†è¾¹ç•Œé—®é¢˜</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>moveX <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      moveX <span class="token operator">=</span> <span class="token number">0</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveX <span class="token operator">></span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">)</span> <span class="token punctuation">{</span>      moveX <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetWidth    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>moveY <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      moveY <span class="token operator">=</span> <span class="token number">0</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveY <span class="token operator">></span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>      moveY <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetHeight    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å®æ—¶çš„æ”¹å˜å…ƒç´ ä½ç½®</span>    img<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> moveX <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>    img<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> moveY <span class="token operator">+</span> <span class="token string">'px'</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//ç›‘å¬é¼ æ ‡æŠ¬èµ·äº‹ä»¶</span>  document<span class="token punctuation">.</span>onmouseup <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//äº‹ä»¶å–æ¶ˆ</span>    document<span class="token punctuation">.</span>onmouseup <span class="token operator">=</span> document<span class="token punctuation">.</span>onmousemove <span class="token operator">=</span> <span class="token keyword">null</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="ä½¿ç”¨HTML5Dragå®ç°æ‹–æ”¾"><a href="#ä½¿ç”¨HTML5Dragå®ç°æ‹–æ”¾" class="headerlink" title="ä½¿ç”¨HTML5Dragå®ç°æ‹–æ”¾"></a>ä½¿ç”¨HTML5Dragå®ç°æ‹–æ”¾</h4><p>æ‹–æ‹½å…ƒç´ æ—¶ï¼Œå°†ä¾æ¬¡å‘ç”Ÿä»¥ä¸‹äº‹ä»¶ï¼š</p><ul><li>ondragstart</li><li>ondragï¼šæ‹–æ‹½æœŸé—´æŒç»­è§¦å‘è¯¥äº‹ä»¶</li><li>ondragend</li></ul><p>åœ¨ç›®æ ‡å…ƒç´ ï¼ˆæ”¾ç½®ç›®æ ‡å…ƒç´ ï¼‰ä¸Šå°†ä¼šå‘ç”Ÿä»¥ä¸‹äº‹ä»¶ï¼š</p><ul><li>ondragenterï¼šå…ƒç´ è¿›å…¥ç›®æ ‡å…ƒç´ </li><li>ondragoverï¼šå…ƒç´ åœ¨ç›®æ ‡å…ƒç´ ä¹‹ä¸­ç§»åŠ¨</li><li>ondragleave/ondropï¼šå…ƒç´ ç¦»å¼€ç›®æ ‡å…ƒç´ /é¼ æ ‡æŠ¬èµ·</li></ul><p><strong>dataTransfer</strong> å¯¹è±¡ï¼šä½¿ç”¨è¯¥å¯¹è±¡è¿›è¡Œæ•°æ®ä¼ è¾“</p><ul><li>setDataï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®ä¼ è¾“æ•°æ®çš„ç±»å‹ï¼štext æˆ–è€… URLï¼Œç¬¬äºŒä¸ªå‚æ•°è®¾ç½®å€¼</li><li>getDataï¼šæ¥æ”¶å€¼ï¼Œåªå‘ç”Ÿåœ¨ondrop</li></ul><p><strong>dropEffect</strong>ä¸<strong>effectAllowed</strong> ï¼šé€šè¿‡<strong>dataTransfer</strong>å¯¹è±¡è¿˜å¯ä»¥ç¡®å®šè¢«æ‹–æ‹½å…ƒç´ ä»¥åŠæ”¾ç½®ç›®æ ‡çš„å…ƒç´ èƒ½å¤Ÿæ¥å—ä»€ä¹ˆæ“ä½œã€‚å…¶ä¸­<strong>dropEffect</strong>å¯ä»¥çŸ¥é“è¢«æ‹–æ‹½å…ƒç´ å¯ä»¥æ‰§è¡Œé‚£ç§æ”¾ç½®è¡Œä¸ºã€‚<strong>effectAllowed</strong>å¯ä»¥çŸ¥é“å…è®¸æ‹–æ‹½å…ƒç´ æ‰§è¡Œå“ªç§<strong>dropEffect</strong>ã€‚</p><p><strong>effectAllowed</strong>æœ‰å››ç§å€¼ï¼š</p><ul><li>â€œnoneâ€:ä¸èƒ½æŠŠæ‹–åŠ¨çš„å…ƒç´ æ”¾åœ¨è¿™é‡Œã€‚è¿™æ˜¯é™¤æ–‡æœ¬æ¡†ä¹‹å¤–æ‰€æœ‰å…ƒç´ çš„é»˜è®¤å€¼ã€‚</li><li>â€œmoveâ€:åº”è¯¥æŠŠæ‹–åŠ¨çš„å…ƒç´ ç§»åŠ¨åˆ°æ”¾ç½®ç›®æ ‡ã€‚</li><li>â€œcopyâ€:åº”è¯¥æŠŠæ‹–åŠ¨çš„å…ƒç´ å¤åˆ¶åˆ°æ”¾ç½®ç›®æ ‡ã€‚</li><li>â€œlinkâ€:è¡¨ç¤ºæ”¾ç½®ç›®æ ‡ä¼šæ‰“å¼€æ‹–åŠ¨çš„å…ƒç´ (ä½†æ‹–åŠ¨çš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªé“¾æ¥ï¼Œæœ‰ URL)ã€‚ </li></ul><blockquote><p>è¦ä½¿ç”¨ dropEffect å±æ€§ï¼Œå¿…é¡»åœ¨ ondragenter äº‹ä»¶å¤„ç†ç¨‹åºä¸­é’ˆå¯¹æ”¾ç½®ç›®æ ‡æ¥è®¾ç½®å®ƒã€‚ </p></blockquote><p><strong>effectAllowed</strong>çš„å±æ€§å€¼å¦‚ä¸‹ï¼š</p><ul><li>â€œuninitializedâ€:æ²¡æœ‰ç»™è¢«æ‹–åŠ¨çš„å…ƒç´ è®¾ç½®ä»»ä½•æ”¾ç½®è¡Œä¸ºã€‚ </li><li>â€œnoneâ€:è¢«æ‹–åŠ¨çš„å…ƒç´ ä¸èƒ½æœ‰ä»»ä½•è¡Œä¸ºã€‚</li><li>â€œcopyâ€:åªå…è®¸å€¼ä¸ºâ€copyâ€çš„ dropEffectã€‚</li><li>â€œlinkâ€:åªå…è®¸å€¼ä¸ºâ€linkâ€çš„ dropEffectã€‚ </li><li>â€œmoveâ€:åªå…è®¸å€¼ä¸ºâ€moveâ€çš„ dropEffectã€‚</li><li>â€œcopyLinkâ€:å…è®¸å€¼ä¸ºâ€copyâ€å’Œâ€linkâ€çš„ dropEffectã€‚ </li><li>â€œcopyMoveâ€:å…è®¸å€¼ä¸ºâ€copyâ€å’Œâ€moveâ€çš„ dropEffectã€‚ </li><li>â€œlinkMoveâ€:å…è®¸å€¼ä¸ºâ€linkâ€å’Œâ€moveâ€çš„ dropEffectã€‚ </li><li>â€œallâ€:å…è®¸ä»»æ„ dropEffectã€‚ </li></ul><blockquote><p>å¿…é¡»åœ¨ ondragstart äº‹ä»¶å¤„ç†ç¨‹åºä¸­è®¾ç½® effectAllowed å±æ€§</p></blockquote><p>ä½¿ç”¨HTML5Dragäº‹ä»¶æ¥å®ç°è‡ªç”±æ‹–æ‹½ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> EventUtil <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * ç»‘å®šäº‹ä»¶     * @param { type } = { äº‹ä»¶ç±»å‹ }       * @param { callback }  = { å›è°ƒå‡½æ•° }      * @param { bool }   = { æŒ‡å®šäº‹ä»¶æ˜¯å¦åœ¨æ•è·æˆ–å†’æ³¡é˜¶æ®µæ‰§è¡Œã€‚true - äº‹ä»¶å¥æŸ„åœ¨æ•è·é˜¶æ®µæ‰§è¡Œã€‚é»˜è®¤ï¼Œäº‹ä»¶å¥æŸ„åœ¨å†’æ³¡é˜¶æ®µæ‰§è¡Œ }     * */</span>    addHandler<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> type<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> bool <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>            el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> bool<span class="token punctuation">)</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>attachEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">attactEvent</span><span class="token punctuation">(</span><span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//é»˜è®¤ä½¿ç”¨DOM0çº§çš„äº‹ä»¶</span>            el<span class="token punctuation">[</span><span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">]</span> <span class="token operator">=</span> callback<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span></code></pre><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è®°å½•é¼ æ ‡ç‚¹å‡»ä½ç½®å’Œè¾¹ç•Œçš„è·ç¦»</span><span class="token keyword">var</span> dirX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>dirY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">var</span> dirX<span class="token punctuation">,</span> dirY<span class="token punctuation">;</span>EventUtil<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'dragstart'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token string">'å¼€å§‹æ‹–æ‹½'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  dirX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>  dirY <span class="token operator">=</span> e<span class="token punctuation">.</span>clientY <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dirX<span class="token punctuation">,</span> dirY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>EventUtil<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">'dragenter'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¿›å…¥ç›®æ ‡å…ƒç´ '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>EventUtil<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">'dragover'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// console.log('åœ¨ç›®æ ‡å…ƒç´ ä¸­ç§»åŠ¨');</span>  <span class="token comment" spellcheck="true">//è®¡ç®—é¼ æ ‡ç§»åŠ¨è·ç¦»</span>  <span class="token keyword">let</span> moveX <span class="token operator">=</span> moveY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  moveX <span class="token operator">=</span> e<span class="token punctuation">.</span>clientX <span class="token operator">-</span> dirX<span class="token punctuation">;</span>  moveY <span class="token operator">=</span> e<span class="token punctuation">.</span>clientY <span class="token operator">-</span> dirY<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//è¾¹ç•Œå¤„ç†</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>moveX <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    moveX <span class="token operator">=</span> <span class="token number">0</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveX <span class="token operator">></span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    moveX <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetWidth  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>moveY <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    moveY <span class="token operator">=</span> <span class="token number">0</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveY <span class="token operator">></span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerHeight <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    moveY <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetHeight  <span class="token punctuation">}</span>  img<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> moveX <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>  img<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> moveY <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//é˜»æ­¢é»˜è®¤è¡Œä¸º</span>  EventUtil<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>EventUtil<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">'dragleave'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç¦»å¼€ç›®æ ‡å…ƒç´ '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>EventUtil<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">'drop'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//è®¾ç½®ç£å¸æ•ˆæœ</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX <span class="token operator">></span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    img<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">-</span> img<span class="token punctuation">.</span>offsetWidth <span class="token operator">+</span> <span class="token string">'px'</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    img<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// console.log(e,'drop');</span>  <span class="token comment" spellcheck="true">// let data = e.dataTransfer.getData('text');</span>  <span class="token comment" spellcheck="true">// console.log('drop');</span>  <span class="token comment" spellcheck="true">// EventUtil.removeHandler()</span>  <span class="token comment" spellcheck="true">// e.target.appendChild(document.getElementById(data))</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="http://cdn.yangkunxiao.cn/%E6%8B%96%E6%8B%BD%E4%BA%8B%E4%BB%B6.png" alt="æ‹–æ”¾äº‹ä»¶æµç¨‹"></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è°ˆJavaScriptå¼‚æ­¥ç¼–ç¨‹</title>
      <link href="/2019/12/07/JavaScript/JavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"/>
      <url>/2019/12/07/JavaScript/JavaScript%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptå¼‚æ­¥ç¼–ç¨‹</p><h4 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h4><p>Promiseæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œå®ƒæ¯”ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆæ›´åŠ åˆé€‚ã€å¼ºå¤§ã€‚æ‰€è°“Promiseï¼Œå°±æ˜¯ä¸€ç§å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢ä¿å­˜ç€æœªæ¥æ‰ä¼šå‘ç”Ÿçš„äº‹æƒ…ï¼ˆä¸€èˆ¬æ˜¯å¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚</p><p>Promiseæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæä¾›ä¸€ç³»åˆ—çš„APIå¯ä»¥å°†å¼‚æ­¥æ“ä½œçš„äº‹æƒ…ä»¥åŒæ­¥çš„å½¢å¼è¡¨ç°å‡ºæ¥ï¼Œæ¯”èµ·â€å›è°ƒåœ°ç‹±â€ï¼Œå®ƒçœ‹èµ·æ¥æ›´åŠ åˆé€‚ã€å¼ºå¤§ã€‚å®ƒå…·æœ‰ä»¥ä¸‹å‡ å¤§ç‰¹ç‚¹ï¼š</p><ul><li><code>Promise</code>çš„çŠ¶æ€ä¸å—ä»»ä½•å¤–ç•Œçš„å½±å“ã€‚Promiseçš„å¼‚æ­¥æ“ä½œæœ‰ä¸‰ç§çŠ¶æ€ï¼š    <code>pending</code>(æ‰§è¡Œä¸­)ã€<code>fulfilled</code>(å·²æˆåŠŸ)ã€<code>rejected</code>(å·²å¤±è´¥)ã€‚åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœæ‰èƒ½å¤Ÿå†³å®š<code>Promise</code>çŠ¶æ€çš„èµ°å‘ã€‚</li><li><code>Promise</code>çš„çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå˜ä¸å¯å†æ¬¡å˜åŠ¨ã€‚å®ƒçš„çŠ¶æ€å˜åŒ–åªæœ‰ä¸¤ç§æƒ…å†µï¼š<code>pending</code> =&gt; <code>fulfilled</code>ã€<code>pengding</code> =&gt; <code>rejected</code>ã€‚çŠ¶æ€ä¸€æ—¦å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¸å†æ”¹å˜ï¼Œç§°ä¹‹ä¸º <code>resolved</code>(å·²å®šå‹)ã€‚</li></ul><p>Promiseä¸€æ—¦æ–°å»ºä¹‹åï¼Œå°±ä¼šç«‹å³æ‰§è¡Œã€‚è€ŒthenæŒ‡å®šçš„å›è°ƒå‡½æ•°åªæœ‰åŒæ­¥æ“ä½œæ‰§è¡Œå®Œä¹‹åæ‰ä¼šæ‰§è¡Œã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æˆåŠŸå›è°ƒ</span>  <span class="token comment" spellcheck="true">//todo</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å¤±è´¥å›è°ƒ</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//todo</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p><code>Promise</code>æ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯<code>resolve</code>å’Œ<code>reject</code>ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”± JavaScript å¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚</p><p><code>resolve</code>å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œæˆåŠŸâ€ï¼ˆå³ä» <code>pending</code> å˜ä¸º <code>resolved</code>ï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ï¼›<code>reject</code>å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œå¤±è´¥â€ï¼ˆå³ä» <code>pending</code> å˜ä¸º <code>rejected</code>ï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚</p><p><code>Promise</code>å®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨<code>then</code>æ–¹æ³•åˆ†åˆ«æŒ‡å®š<code>resolved</code>çŠ¶æ€å’Œ<code>rejected</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚ä½†æ˜¯ä¸€èˆ¬é»˜è®¤ä¸æŒ‡å®š<code>rejected</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨<code>catch</code>ã€‚</p><p><code>finally</code>ä¸ç®¡<code>promise</code>æœ€ç»ˆçš„æ‰§è¡Œç»“æœå¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œã€‚</p><p><code>all</code>ï¼šæ–¹æ³•ç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚</p><p><code>Promise.all()</code>æ–¹æ³•æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œ<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>éƒ½æ˜¯ Promise å®ä¾‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¼šå…ˆè°ƒç”¨<code>Promise.resolve</code>æ–¹æ³•ï¼Œå°†å‚æ•°è½¬ä¸º Promise å®ä¾‹ï¼Œå†è¿›ä¸€æ­¥å¤„ç†ã€‚å¦å¤–ï¼Œ<code>Promise.all()</code>æ–¹æ³•çš„å‚æ•°å¯ä»¥ä¸æ˜¯æ•°ç»„ï¼Œä½†å¿…é¡»å…·æœ‰ Iterator æ¥å£ï¼Œä¸”è¿”å›çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ Promise å®ä¾‹</p><p>ä¸¾ä¸ªğŸŒ°ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        msg<span class="token punctuation">:</span> <span class="token string">'p1'</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        msg<span class="token punctuation">:</span> <span class="token string">'p2'</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span>resolve <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        msg<span class="token punctuation">:</span> <span class="token string">'p3'</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">,</span>p3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>res1<span class="token punctuation">,</span>res2<span class="token punctuation">,</span>res3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰§è¡Œç»“æœï¼šp1 p2 p3</span></code></pre><p><code>p</code>çš„çŠ¶æ€ç”±p1,p2,p3å†³å®šï¼š</p><ul><li><p>åªæœ‰<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>çš„çŠ¶æ€éƒ½å˜æˆ<code>fulfilled</code>ï¼Œ<code>p</code>çš„çŠ¶æ€æ‰ä¼šå˜æˆ<code>fulfilled</code>ï¼Œæ­¤æ—¶<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>çš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°ã€‚</p></li><li><p>åªè¦<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>ä¹‹ä¸­æœ‰ä¸€ä¸ªè¢«<code>rejected</code>ï¼Œ<code>p</code>çš„çŠ¶æ€å°±å˜æˆ<code>rejected</code>ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªè¢«<code>reject</code>çš„å®ä¾‹çš„è¿”å›å€¼ï¼Œä¼šä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°ã€‚</p></li></ul><p><code>race</code>ï¼šè¯¥æ–¹æ³•åŒæ ·æ˜¯å°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åªè¦åªè¦<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œ<code>p</code>çš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°ã€‚</p><p><code>allSettled</code>ï¼šè¯¥æ–¹æ³•ç”±<code>ES2020</code>å¼•å…¥ã€‚<code>Promise.allSettled()</code>æ–¹æ³•æ¥å—ä¸€ç»„ Promise å®ä¾‹ä½œä¸ºå‚æ•°ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚åªæœ‰ç­‰åˆ°æ‰€æœ‰è¿™äº›å‚æ•°å®ä¾‹éƒ½è¿”å›ç»“æœï¼Œä¸ç®¡æ˜¯<code>fulfilled</code>è¿˜æ˜¯<code>rejected</code>ï¼ŒåŒ…è£…å®ä¾‹æ‰ä¼šç»“æŸã€‚</p><p><code>any</code>ï¼š<code>Promise.any()</code>æ–¹æ³•æ¥å—ä¸€ç»„ Promise å®ä¾‹ä½œä¸ºå‚æ•°ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚åªè¦å‚æ•°å®ä¾‹æœ‰ä¸€ä¸ªå˜æˆ<code>fulfilled</code>çŠ¶æ€ï¼ŒåŒ…è£…å®ä¾‹å°±ä¼šå˜æˆ<code>fulfilled</code>çŠ¶æ€ï¼›å¦‚æœæ‰€æœ‰å‚æ•°å®ä¾‹éƒ½å˜æˆ<code>rejected</code>çŠ¶æ€ï¼ŒåŒ…è£…å®ä¾‹å°±ä¼šå˜æˆ<code>rejected</code>çŠ¶æ€ã€‚è¯¥æ–¹æ³•ç›®å‰æ˜¯ä¸€ä¸ªç¬¬ä¸‰é˜¶æ®µçš„<a href="https://github.com/tc39/proposal-promise-any" target="_blank" rel="noopener">ææ¡ˆ</a> ã€‚</p><p><code>resolve</code>ï¼š<code>Promise.resolve()</code>å°†ç°æœ‰å¯¹è±¡è½¬ä¸º Promise å¯¹è±¡ã€‚</p><ul><li><p>å‚æ•°æ˜¯ä¸€ä¸ª<code>Promise</code>å®ä¾‹ï¼šé‚£ä¹ˆ<code>Promise.resolve</code>å°†ä¸åšä»»ä½•ä¿®æ”¹ã€åŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå®ä¾‹ã€‚</p></li><li><p>å‚æ•°æ˜¯ä¸€ä¸ª <code>thenable</code> å®ä¾‹ï¼š<code>thenable</code>å¯¹è±¡æŒ‡çš„æ˜¯å…·æœ‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¯¹è±¡ã€‚ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> thenable <span class="token operator">=</span> <span class="token punctuation">{</span>  then<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><code>Promise.resolve</code>æ–¹æ³•ä¼šå°†è¿™ä¸ªå¯¹è±¡è½¬ä¸º Promise å¯¹è±¡ï¼Œç„¶åå°±ç«‹å³æ‰§è¡Œ<code>thenable</code>å¯¹è±¡çš„<code>then</code>æ–¹æ³•ã€‚</p></li><li><p>å‚æ•°ä¸æ˜¯å…·æœ‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–æ ¹æœ¬å°±ä¸æ˜¯å¯¹è±¡ï¼šå¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªä¸å…·æœ‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œåˆ™<code>Promise.resolve</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼ŒçŠ¶æ€ä¸º<code>resolved</code>ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Hello</span></code></pre></li></ul><p><code>reject</code>ï¼š<code>Promise.reject(reason)</code>æ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œè¯¥å®ä¾‹çš„çŠ¶æ€ä¸º<code>rejected</code>ã€‚</p><h4 id="Generator-yield"><a href="#Generator-yield" class="headerlink" title="Generator/yield"></a>Generator/yield</h4><p>Generator å‡½æ•°æ˜¯ ES6 æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œè¯­æ³•è¡Œä¸ºä¸ä¼ ç»Ÿå‡½æ•°å®Œå…¨ä¸åŒã€‚</p><p>Generator å‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚è¯­æ³•ä¸Šï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚</p><p>æ‰§è¡Œ Generator å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGenerator å‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ª<code>éå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°</code>ã€‚è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚</p><p>å½¢å¼ä¸Šï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹å¾:</p><p>1ã€<code>function</code>å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼›</p><p>2ã€å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨<code>yield</code>è¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€</p><blockquote><p> Generator å‡½æ•°æ˜¯åˆ†æ®µæ‰§è¡Œçš„ï¼Œ<code>yield</code>è¡¨è¾¾å¼æ˜¯æš‚åœæ‰§è¡Œçš„æ ‡è®°ï¼Œè€Œ<code>next</code>æ–¹æ³•å¯ä»¥æ¢å¤æ‰§è¡Œã€‚</p></blockquote><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">helloWorldGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">yield</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>  <span class="token keyword">yield</span> <span class="token string">'world'</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token string">'ending'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">let</span> hwg <span class="token operator">=</span> <span class="token function">helloWorldGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hwg<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//{ value:hello,done:false }</span>hwg<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//{ value:world,done:false }</span>hwg<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//{ value:ending,done:true }</span>hwg<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//{ value:undefined,done:true }</span></code></pre><p>æ€»ç»“ï¼šè°ƒç”¨Generatorå‡½æ•°ï¼Œä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå®ƒæ˜¯å‡½æ•°å†…éƒ¨çš„æŒ‡é’ˆï¼Œä»¥åæ¯è°ƒç”¨ä¸€æ¬¡nextå‡½æ•°ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªå¸¦æœ‰valueå’Œdoneå±æ€§çš„å¯¹è±¡ã€‚<code>next</code>æ–¹æ³•å¯ä»¥å¸¦ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°å°±ä¼šè¢«å½“ä½œä¸Šä¸€ä¸ª<code>yield</code>è¡¨è¾¾å¼çš„è¿”å›å€¼ã€‚<code>value</code>å±æ€§è¡¨ç¤ºå½“å‰çš„å†…éƒ¨çŠ¶æ€çš„å€¼ï¼Œæ˜¯<code>yield</code>è¡¨è¾¾å¼åé¢é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼›<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦éå†ç»“æŸã€‚</p><p>Generator å‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>return</code>æ–¹æ³•ï¼Œå¯ä»¥è¿”å›ç»™å®šçš„å€¼ï¼Œå¹¶ä¸”ç»ˆç»“éå† Generator å‡½æ•°ã€‚</p><h4 id="async-await"><a href="#async-await" class="headerlink" title="async/await"></a>async/await</h4><p>ES2017 æ ‡å‡†å¼•å…¥äº† async å‡½æ•°ï¼Œä½¿å¾—å¼‚æ­¥æ“ä½œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚å®ƒæ˜¯Generatorçš„è¯­æ³•ç³–ã€‚<code>async</code>å‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰æ›¿æ¢æˆ<code>async</code>ï¼Œå°†<code>yield</code>æ›¿æ¢æˆ<code>await</code>ã€‚</p><p><code>async</code>å‡½æ•°å¯¹ Generator å‡½æ•°çš„æ”¹è¿›ï¼Œä½“ç°åœ¨ä»¥ä¸‹å‡ ç‚¹ã€‚</p><ul><li><p>å†…ç½®æ‰§è¡Œå™¨ã€‚</p><p>Generator å‡½æ•°çš„æ‰§è¡Œå¿…é¡»é æ‰§è¡Œå™¨ã€‚è€Œ<code>async</code>å‡½æ•°è‡ªå¸¦æ‰§è¡Œå™¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>async</code>å‡½æ•°çš„æ‰§è¡Œï¼Œä¸æ™®é€šå‡½æ•°ä¸€æ¨¡ä¸€æ ·ï¼Œåªè¦ä¸€è¡Œã€‚</p></li><li><p>è¿”å›å€¼æ˜¯ Promise</p><p><code>async</code>å‡½æ•°çš„è¿”å›å€¼æ˜¯ Promise å¯¹è±¡ï¼Œè¿™æ¯” Generator å‡½æ•°çš„è¿”å›å€¼æ˜¯ Iterator å¯¹è±¡æ–¹ä¾¿å¤šäº†ã€‚ä½ å¯ä»¥ç”¨<code>then</code>æ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œã€‚</p></li></ul><p>è¿›ä¸€æ­¥è¯´ï¼Œ<code>async</code>å‡½æ•°å®Œå…¨å¯ä»¥çœ‹ä½œå¤šä¸ªå¼‚æ­¥æ“ä½œï¼ŒåŒ…è£…æˆçš„ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè€Œ<code>await</code>å‘½ä»¤å°±æ˜¯å†…éƒ¨<code>then</code>å‘½ä»¤çš„è¯­æ³•ç³–ã€‚</p><p><code>async</code>å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚<code>async</code>å‡½æ•°å†…éƒ¨<code>return</code>è¯­å¥è¿”å›çš„å€¼ï¼Œä¼šæˆä¸º<code>then</code>æ–¹æ³•å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p><p><code>async</code>å‡½æ•°è¿”å›çš„ Promise å¯¹è±¡ï¼Œå¿…é¡»ç­‰åˆ°å†…éƒ¨æ‰€æœ‰<code>await</code>å‘½ä»¤åé¢çš„ Promise å¯¹è±¡æ‰§è¡Œå®Œï¼Œæ‰ä¼šå‘ç”ŸçŠ¶æ€æ”¹å˜ï¼Œé™¤éé‡åˆ°<code>return</code>è¯­å¥æˆ–è€…æŠ›å‡ºé”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰<code>async</code>å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œ<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p><p>ä¸¾ä¸ªğŸŒ°ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">timeFn</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//Promise æ–°å»ºåå°±ä¼šç«‹å³æ‰§è¡Œã€‚</span>  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        msg<span class="token punctuation">:</span><span class="token string">'hello'</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//Promiseçš„å†™æ³•</span>  <span class="token comment" spellcheck="true">// timeFn(time).then(res => {</span>  <span class="token comment" spellcheck="true">//     console.log(res);</span>  <span class="token comment" spellcheck="true">// })</span>  <span class="token comment" spellcheck="true">//async awaitçš„å†™æ³•</span>  <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">timeFn</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span></code></pre><p>ç¨‹åºä¼šåœ¨3sä¹‹åæ‰“å°{msg:â€™helloâ€™}</p><p><code>await</code>ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼Œ<code>await</code>å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿”å›è¯¥å¯¹è±¡çš„ç»“æœã€‚å¦‚æœä¸æ˜¯ Promise å¯¹è±¡ï¼Œå°±ç›´æ¥è¿”å›å¯¹åº”çš„å€¼ã€‚å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œ<code>await</code>å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª<code>thenable</code>å¯¹è±¡ï¼ˆå³å®šä¹‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆ<code>await</code>ä¼šå°†å…¶ç­‰åŒäº Promise å¯¹è±¡ã€‚</p><p>å¦‚æœ<code>await</code>åé¢çš„å¼‚æ­¥æ“ä½œå‡ºé”™ï¼Œé‚£ä¹ˆç­‰åŒäº<code>async</code>å‡½æ•°è¿”å›çš„ Promise å¯¹è±¡è¢«<code>reject</code>ã€‚</p><p><code>await</code>å‘½ä»¤åªèƒ½ç”¨åœ¨<code>async</code>å‡½æ•°ä¹‹ä¸­ï¼Œå¦‚æœç”¨åœ¨æ™®é€šå‡½æ•°ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p>async å‡½æ•°çš„å®ç°åŸç†ï¼Œå°±æ˜¯å°† Generator å‡½æ•°å’Œè‡ªåŠ¨æ‰§è¡Œå™¨ï¼ŒåŒ…è£…åœ¨ä¸€ä¸ªå‡½æ•°é‡Œã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// ...</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ç­‰åŒäº</span><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// ...</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//spawn è‡ªåŠ¨æ‰§è¡Œå™¨</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯¦è§£JSçš„forå¾ªç¯</title>
      <link href="/2019/12/01/JavaScript/for/"/>
      <url>/2019/12/01/JavaScript/for/</url>
      
        <content type="html"><![CDATA[<h4 id="for"><a href="#for" class="headerlink" title="for"></a>for</h4><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>arr1<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'l'</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> arr1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>forå¾ªç¯å¯ä»¥ä½¿ç”¨<code>break</code>å’Œ<code>continue</code></p><h4 id="for-in"><a href="#for-in" class="headerlink" title="for in"></a>for in</h4><ul><li>for-in åªèƒ½éå†â€œå¯æšä¸¾çš„å±æ€§â€  å¯ä»¥ä½¿ç”¨æŸ¥çœ‹æ˜¯å¦å¯æšä¸¾<code>Object.getOwnPropertyDescriptor(object,property)</code></li><li>å®ƒå®é™…ä¸Šéå†çš„æ˜¯å¯¹è±¡çš„å±æ€§ï¼Œè€Œä¸æ˜¯â€œç´¢å¼•å€¼â€ï¼Œ æ‰€ä»¥for inå¯ä»¥éå†å¯¹è±¡</li><li>éå†åŸå‹ä¸Šçš„å±æ€§(å¯ä»¥é…åˆ Object.hasOwnProperty())</li><li>for inéå†çš„é¡ºåºå¹¶ä¸ç¡®å®š</li><li>æ€§èƒ½ï¼šæ¯æ¬¡è¿­ä»£æ“ä½œä¼šåŒæ—¶æœç´¢å®ä¾‹æˆ–è€…åŸå‹å±æ€§ï¼Œ for-in å¾ªç¯çš„æ¯æ¬¡è¿­ä»£éƒ½ä¼šäº§ç”Ÿæ›´å¤šå¼€é”€ï¼Œå› æ­¤è¦æ¯”å…¶ä»–å¾ªç¯ç±»å‹æ…¢</li></ul><pre class=" language-javascript"><code class="language-javascript">Array<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> arr1<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`arr1[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">] = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arr1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr1<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h4><ul><li>forEach æ–¹æ³•ä¸ºæ•°ç»„ä¸­å«æœ‰æœ‰æ•ˆå€¼çš„æ¯ä¸€é¡¹æ‰§è¡Œä¸€æ¬¡ callback å‡½æ•°</li><li>é‚£äº›å·²åˆ é™¤ï¼ˆä½¿ç”¨ delete æ–¹æ³•ç­‰æƒ…å†µï¼‰æˆ–è€…ä»æœªèµ‹å€¼çš„é¡¹å°†è¢«è·³è¿‡ï¼ˆä¸åŒ…æ‹¬é‚£äº›å€¼ä¸º undefined æˆ– null çš„é¡¹ï¼‰</li><li>ä¸èƒ½ä½¿ç”¨break å’Œ continue</li><li>forEach çš„é€Ÿåº¦ä¸å¦‚ for</li></ul><pre class=" language-javascript"><code class="language-javascript">arr1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>arr1<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">,</span>arr1<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">,</span>arr1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>çœ‹ğŸŒ°ï¼šmacç”µè„‘ã€chromeæµè§ˆå™¨çš„æ‰§è¡Œç¯å¢ƒä¸‹</p><pre class=" language-javascript"><code class="language-javascript">console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'for'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> <span class="token number">100000</span> <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'for'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è€—æ—¶çº¦8.5s</span>arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">'foreach'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">'foreach'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è€—æ—¶çº¦10.34s</span></code></pre><h4 id="for-of"><a href="#for-of" class="headerlink" title="for of"></a>for of</h4><ul><li><p>for of æ˜¯ç”¨æ¥éå†å¯è¿­ä»£å¯¹è±¡çš„ï¼Œjs å¼•æ“æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡æ˜¯å¦å…·æœ‰ <code>Symbol.iterator</code> æ¥åˆ¤æ–­çš„ï¼Œ</p><ul><li>[][Symbol.iterator]</li><li>{}[Symbol.iterator]</li></ul></li><li><p>è¿­ä»£å™¨ï¼šæœ‰next()æ–¹æ³•çš„å¯¹è±¡ï¼Œnext()æ–¹æ³•è¿”å›ï¼šdoneå’Œvalueï¼Œdoneæ ‡ç¤ºæ˜¯å¦éå†å®Œï¼Œvalueå°±æ˜¯å½“å‰çš„å€¼</p></li><li><p>è·Ÿ forEach ç›¸æ¯”ï¼Œå®ƒå¯ä»¥æ­£ç¡®å“åº” break, continue, returnã€‚</p></li><li><p>for-of å¾ªç¯ä¸ä»…æ”¯æŒæ•°ç»„ï¼Œè¿˜æ”¯æŒå¤§å¤šæ•°ç±»æ•°ç»„å¯¹è±¡ï¼Œä¾‹å¦‚ DOM nodelist å¯¹è±¡ã€‚</p></li><li><p>for-of å¾ªç¯ä¹Ÿæ”¯æŒå­—ç¬¦ä¸²éå†ï¼Œå®ƒå°†å­—ç¬¦ä¸²è§†ä¸ºä¸€ç³»åˆ— Unicode å­—ç¬¦æ¥è¿›è¡Œéå†</p></li><li><p>for-ofå¾ªç¯ä¸æ”¯æŒæ™®é€šå¯¹è±¡ï¼Œä½†å¦‚æœä½ æƒ³è¿­ä»£ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œä½ å¯ä»¥ç”¨for-in å¾ªç¯</p></li></ul><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>item<span class="token punctuation">,</span>index<span class="token punctuation">]</span> <span class="token keyword">of</span> arr1<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">,</span><span class="token string">'===========for of'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>æ—¢ç„¶çŸ¥é“äº†<code>for of</code>çš„å·¥ä½œåŸç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æ‰‹åŠ¨å®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œè®©å¯¹è±¡å¯ä»¥è¢«<code>for of</code>éå†å‘¢ï¼Ÿ</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">createIterator</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">let</span> propKeys <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> propKey <span class="token keyword">of</span> propKeys<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">yield</span> <span class="token punctuation">[</span>propKey<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>propKey<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>  name<span class="token punctuation">:</span><span class="token string">'kaka'</span><span class="token punctuation">,</span>  age<span class="token punctuation">:</span><span class="token number">24</span><span class="token punctuation">}</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span>value<span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token function">createIterator</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">,</span><span class="token string">'=========forof'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµè§ˆå™¨ä¸­çš„è¿›ç¨‹ã€çº¿ç¨‹å’ŒEvent Loop</title>
      <link href="/2019/12/01/JavaScript/EventLoop/"/>
      <url>/2019/12/01/JavaScript/EventLoop/</url>
      
        <content type="html"><![CDATA[<p>#æµè§ˆå™¨</p><p>æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„ã€‚æ¯ä¸€ä¸ªTabé¡µå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ã€‚</p><ul><li>ä¸»è¿›ç¨‹ï¼šä¸ªäººç†è§£é—®â€œç®¡å®¶â€çš„è§’è‰²ï¼Œå®ƒæ§åˆ¶ç€æµè§ˆå™¨çš„å„ä¸ªä»»åŠ¡ï¼Œé¡µé¢å±•ç¤ºã€ç½‘ç»œè¯·æ±‚ã€å†å²å›é€€ã€å‰è¿›ç­‰ç­‰</li><li>ç¬¬ä¸‰æ–¹æ’ä»¶è¿›ç¨‹ï¼šç®¡ç†ç¬¬ä¸‰æ–¹æ’ä»¶</li><li>GPUçº¿ç¨‹ï¼šç”¨äº3Dç»˜åˆ¶</li><li>æ¸²æŸ“è¿›ç¨‹ï¼šå¯¹å‰ç«¯æ¥è¯´ï¼Œæœ€é‡è¦çš„è¿›ç¨‹ã€‚</li></ul><h1 id="æµè§ˆå™¨å†…æ ¸ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰"><a href="#æµè§ˆå™¨å†…æ ¸ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰" class="headerlink" title="æµè§ˆå™¨å†…æ ¸ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰"></a>æµè§ˆå™¨å†…æ ¸ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰</h1><p>æ¸²æŸ“è¿›ç¨‹æ˜¯å¤šçº¿ç¨‹çš„ã€‚å®ƒåŒ…å«ä¸€ä¸‹å‡ å¤§çº¿ç¨‹ï¼š</p><ul><li>GUIçº¿ç¨‹<ul><li>å®ƒè´Ÿè´£é¡µé¢çš„æ¸²æŸ“ã€å¸ƒå±€ã€‚</li><li>å½“é¡µé¢å‘ç”Ÿé‡ç»˜æˆ–è€…å›æµçš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¯¥çº¿ç¨‹</li><li>å®ƒå’ŒJSå¼•æ“çº¿ç¨‹äº’æ–¥</li></ul></li><li>JSå¼•æ“çº¿ç¨‹<ul><li>è´Ÿè´£ç¨‹åºçš„è§£æå’Œæ‰§è¡Œ</li></ul></li><li>äº‹ä»¶è§¦å‘çº¿ç¨‹<ul><li>å®ƒæ§åˆ¶äº‹ä»¶å¾ªç¯ï¼Œç®¡ç†ç€ä¸€ä¸ªäº‹ä»¶ä»»åŠ¡é˜Ÿåˆ—TaskQueue</li><li>å½“å¼‚æ­¥ä»»åŠ¡æ»¡è¶³æ¡ä»¶æ—¶ï¼Œä¼šå°†è¯¥å¼‚æ­¥ä»»åŠ¡çš„å›è°ƒå‡½æ•°æ”¾å…¥åˆ°JSå¼•æ“çº¿ç¨‹æ‰€åœ¨çš„æ‰§è¡Œæ ˆä¸­æ‰§è¡Œ</li></ul></li><li>å®šæ—¶è§¦å‘å™¨çº¿ç¨‹<ul><li>setTimeOut å’Œ setInterval æ‰€åœ¨çš„çº¿ç¨‹</li><li>å®šæ—¶å™¨ä»»åŠ¡çš„è®¡æ—¶ä¸æ˜¯ç”±JSå¼•æ“è®¡æ—¶çš„ï¼Œè€Œæ˜¯ç”±è¯¥çº¿ç¨‹æ§åˆ¶</li><li>å½“å®šæ—¶ä»»åŠ¡è®¡æ—¶å®Œæˆä¹‹åï¼Œä¼šé€šçŸ¥äº‹ä»¶è§¦å‘çº¿ç¨‹</li></ul></li><li>å¼‚æ­¥httpè¯·æ±‚çº¿ç¨‹<ul><li>ä¸€ä¸ªç‹¬ç«‹çš„ajaxè¯·æ±‚çº¿ç¨‹</li><li>å½“è¯·æ±‚å®Œæˆä¹‹åï¼Œä¼šé€šçŸ¥äº‹ä»¶è§¦å‘çº¿ç¨‹</li></ul></li></ul><h4 id="ä¸ºä»€ä¹ˆGUIçº¿ç¨‹å’ŒJSå¼•æ“çº¿ç¨‹äº’æ–¥"><a href="#ä¸ºä»€ä¹ˆGUIçº¿ç¨‹å’ŒJSå¼•æ“çº¿ç¨‹äº’æ–¥" class="headerlink" title="ä¸ºä»€ä¹ˆGUIçº¿ç¨‹å’ŒJSå¼•æ“çº¿ç¨‹äº’æ–¥"></a>ä¸ºä»€ä¹ˆGUIçº¿ç¨‹å’ŒJSå¼•æ“çº¿ç¨‹äº’æ–¥</h4><p>å› ä¸ºJSæ˜¯å¯ä»¥æ“ä½œDOMçš„ï¼Œå¦‚æœä½¿ç”¨JSæ“ä½œDOMçš„åŒæ—¶ï¼ŒGUIçº¿ç¨‹ä¹Ÿåœ¨æ¸²æŸ“DOMï¼Œé‚£ä¹ˆæ¸²æŸ“å®Œæˆä¹‹åçš„å…ƒç´ å¯èƒ½å°±ä¸æ˜¯ä¹‹å‰çš„å…ƒç´ äº†</p><h4 id="ä¸ºä»€ä¹ˆJSå¼•æ“æ˜¯å•çº¿ç¨‹"><a href="#ä¸ºä»€ä¹ˆJSå¼•æ“æ˜¯å•çº¿ç¨‹" class="headerlink" title="ä¸ºä»€ä¹ˆJSå¼•æ“æ˜¯å•çº¿ç¨‹"></a>ä¸ºä»€ä¹ˆJSå¼•æ“æ˜¯å•çº¿ç¨‹</h4><ul><li>åˆ›å»ºJavaScriptè¯­è¨€çš„æ—¶å€™ï¼Œå¤šè¿›ç¨‹å¤šçº¿ç¨‹çš„æ¶æ„å¹¶ä¸æµè¡Œï¼Œç¡¬ä»¶æ”¯æŒåº¦ä¸é«˜</li><li>å¤šè¿›ç¨‹å¤šçº¿ç¨‹æ“ä½œéœ€è¦åŠ é”ï¼Œæ“ä½œæˆæœ¬è¾ƒé«˜ï¼Œè¾ƒä¸ºå¤æ‚</li><li>å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªDOMï¼Œé‚£ä¹ˆç»“æœä¼šæ˜¯ä¸å¯é¢„æ–™çš„</li></ul><h1 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h1><ul><li>JSçš„ä»»åŠ¡åˆ†ä¸ºåŒæ­¥ä»»ä½•å’Œå¼‚æ­¥ä»»åŠ¡çš„</li><li>åŒæ­¥ä»»åŠ¡éƒ½åœ¨JSå¼•æ“çš„æ‰§è¡Œæ ˆä¸Šæ‰§è¡Œ</li><li>äº‹ä»¶è§¦å‘çº¿ç¨‹ç®¡ç†ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼ŒTaskQueueï¼Œå½“å¼‚æ­¥ä»»åŠ¡æ»¡è¶³æ¡ä»¶æ—¶ï¼Œäº‹ä»¶è§¦å‘çº¿ç¨‹ä¼šå°†å…¶æ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—å½“ä¸­ï¼Œå½“ä¸»çº¿ç¨‹ï¼ˆJSå¼•æ“çº¿ç¨‹ï¼‰æ‰§è¡Œå®Œæ‰§è¡Œæ ˆä¸­çš„ä»»åŠ¡ä¹‹åï¼Œä¼šè¯»å–ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œå°±å°†å¯æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡çš„å›è°ƒå‡½æ•°æ¨å…¥åˆ°æ‰§è¡Œæ ˆä¸­ï¼Œå¼€å§‹æ‰§è¡Œã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™å†æ¬¡å‘äº‹ä»¶è§¦å‘çº¿ç¨‹å‘èµ·è¯¢é—®ï¼Œç›´åˆ°æœ‰ä¸ºæ­¢ã€‚</li></ul><p><img src="http://cdn.yangkunxiao.cn/EventLoop.png" alt="Event Loop"></p><p>ä»£ç è§£é‡Šï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> timerCallback <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timerCallback'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">let</span> httpCallback <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'httpCallback'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// åŒæ­¥ä»»åŠ¡</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŒæ­¥ä»»åŠ¡1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åŒæ­¥ä»»åŠ¡</span><span class="token comment" spellcheck="true">// é€šçŸ¥å®šæ—¶å™¨çº¿ç¨‹ 1s åå°† timerCallback äº¤ç”±äº‹ä»¶è§¦å‘çº¿ç¨‹å¤„ç†</span><span class="token comment" spellcheck="true">// 1s åäº‹ä»¶è§¦å‘çº¿ç¨‹å°† timerCallback åŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>timerCallback<span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åŒæ­¥ä»»åŠ¡</span><span class="token comment" spellcheck="true">// é€šçŸ¥å¼‚æ­¥httpè¯·æ±‚çº¿ç¨‹å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¯·æ±‚æˆåŠŸåå°† httpCallback äº¤ç”±äº‹ä»¶è§¦å‘çº¿ç¨‹å¤„ç†</span><span class="token comment" spellcheck="true">// è¯·æ±‚æˆåŠŸåäº‹ä»¶è§¦å‘çº¿ç¨‹å°† httpCallback åŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­</span>$<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'www.xxxx.com'</span><span class="token punctuation">,</span>httpCallback<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åŒæ­¥ä»»åŠ¡</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŒæ­¥ä»»åŠ¡2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//...</span><span class="token comment" spellcheck="true">// æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œå</span><span class="token comment" spellcheck="true">// è¯¢é—®äº‹ä»¶è§¦å‘çº¿ç¨‹åœ¨äº‹ä»¶äº‹ä»¶é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰éœ€è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°</span><span class="token comment" spellcheck="true">// å¦‚æœæ²¡æœ‰ï¼Œä¸€ç›´è¯¢é—®ï¼Œç›´åˆ°æœ‰ä¸ºæ­¢</span><span class="token comment" spellcheck="true">// å¦‚æœæœ‰ï¼Œå°†å›è°ƒäº‹ä»¶åŠ å…¥æ‰§è¡Œæ ˆä¸­ï¼Œå¼€å§‹æ‰§è¡Œå›è°ƒä»£ç </span></code></pre><p>æ€»ç»“ï¼š</p><ul><li>JSå¼•æ“çº¿ç¨‹åªæ‰§è¡Œæ‰§è¡Œæ ˆä¸­çš„äº‹ä»¶</li><li>æ‰§è¡Œæ ˆä¸­çš„ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå°±ä¼šè¯»å–äº‹ä»¶é˜Ÿåˆ—ä¸­çš„äº‹ä»¶</li><li>äº‹ä»¶é˜Ÿåˆ—ä¸­çš„å›è°ƒäº‹ä»¶ï¼Œæ˜¯ç”±å„è‡ªçº¿ç¨‹æ’å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­çš„</li><li>å¦‚æ­¤å¾ªç¯</li></ul><h4 id="å®ä»»åŠ¡ã€å¾®ä»»åŠ¡"><a href="#å®ä»»åŠ¡ã€å¾®ä»»åŠ¡" class="headerlink" title="å®ä»»åŠ¡ã€å¾®ä»»åŠ¡"></a>å®ä»»åŠ¡ã€å¾®ä»»åŠ¡</h4><p>å®ä»»åŠ¡ï¼šå¯ä»¥ç†è§£ä¸ºæµè§ˆå™¨çº§åˆ«çš„ä»»åŠ¡ã€‚ä¸»ä»£ç å—ï¼ŒsetTimeoutï¼ŒsetIntervalç­‰ï¼Œéƒ½å±äºå®ä»»åŠ¡</p><p>å¾®ä»»åŠ¡ï¼šJSå¼•æ“çº§åˆ«çš„ä»»åŠ¡ã€‚Promiseï¼Œprocess.nextTickç­‰ï¼Œå±äº<code>å¾®ä»»åŠ¡</code>ã€‚</p><p>æ‰§è¡Œé¡ºåºï¼š</p><ul><li>å½“å‰ä»£ç å—å¯¹åº”çš„å®ä»»åŠ¡</li><li>å½“å‰å®ä»»åŠ¡ç»“æŸä¹‹åï¼Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡å¼€å§‹ä¹‹å‰ï¼Œæ‰§è¡Œå½“å‰å¯¹åˆ—çš„å¾®ä»»åŠ¡</li><li>GUIå¼•æ“æ¸²æŸ“</li><li>ä¸‹ä¸€ä¸ªå®ä»»åŠ¡</li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tree-shaking</title>
      <link href="/2019/11/30/Webpack/tree-shaking/"/>
      <url>/2019/11/30/Webpack/tree-shaking/</url>
      
        <content type="html"><![CDATA[<h4 id="jsï¼štree-shaking"><a href="#jsï¼štree-shaking" class="headerlink" title="jsï¼štree-shaking"></a>jsï¼štree-shaking</h4><ul><li><p>å®ƒæ˜¯æŒ‡å¸®åŠ©å¼€å‘è€…æ¶ˆé™¤ä¸åŒæ¨¡å—ä¹‹é—´çš„ä¸€äº›æ— æ•ˆä»£ç çš„featureã€‚åœ¨webpackä¸­ï¼Œä¹Ÿæ˜¯æœ‰tree-shakingåŠŸèƒ½çš„ï¼Œä½†æ˜¯å®ƒçš„åŠŸèƒ½ååˆ†ç®€å•ç²—æš´ï¼šåªå¯»æ‰¾<code>import</code>å¼•å…¥è¿›æ¥çš„å˜é‡æ˜¯å¦å‡ºç°è¿‡åœ¨æ¨¡å—å†…ï¼Œéå¸¸ç®€å•ç²—æš´ã€‚å› ä¸ºåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¼€å‘è€…ç»å¸¸ä¼šçŠ¯è¿™ç§é”™è¯¯ï¼šä¸€äº›æ¨¡å—æ›¾ç»å¼•å…¥äº†è¿›æ¥ï¼Œä½†æ˜¯åæ¥å´æ²¡æœ‰ä½¿ç”¨åˆ°ï¼Œå¿˜è®°åˆ é™¤äº†ï¼Œè¿™å°±ä¼šå¯¼è‡´æ‰“åŒ…çš„æ—¶å€™ï¼Œwebpackè‡ªå¸¦çš„tree-shakingåŠŸèƒ½æ— æ³•å°†è¿™äº›æ— æ•ˆçš„featureå»é™¤ã€‚</p></li><li><p>è¿™æ˜¯æˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€äº›ç¬¬ä¸‰æ–¹æ’ä»¶å»åšè¿™ä¸ªäº‹æƒ…ï¼š</p><pre class=" language-base"><code class="language-base">npm install --save-dev webpack-deep-scope-plugin//åœ¨webpack.config.jsä¸­å¼•ç”¨const WebpackDeepScopeAnalysisPlugin = require('webpack-deep-scope-plugin').default;module.export = {    ......    plugins:[        new WebpackDeepScopeAnalysisPlugin()    ]}</code></pre><p>è¯¦æƒ…è¯·å‚è€ƒï¼š<a href="https://diverse.space/2018/05/better-tree-shaking-with-scope-analysis" target="_blank" rel="noopener">https://diverse.space/2018/05/better-tree-shaking-with-scope-analysis</a></p></li></ul><h4 id="css-tree-shaking"><a href="#css-tree-shaking" class="headerlink" title="css:tree-shaking"></a>css:tree-shaking</h4><ul><li><p>spaï¼š<a href="https://www.npmjs.com/package/purifycss-webpack" target="_blank" rel="noopener">purifycss-webpack</a>è¯¥æ’ä»¶ä¼šæŠŠæ‰€æœ‰æœªè¢«å¼•ç”¨çš„csså…¨éƒ¨å»é™¤</p><pre class=" language-javascript"><code class="language-javascript">productionï¼šnpm install <span class="token operator">--</span>save<span class="token operator">-</span>dev purifycss<span class="token operator">-</span>webpack<span class="token comment" spellcheck="true">//åœ¨webpack.config.jsä¸­å¼•ç”¨</span><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æŸ¥æ‰¾æ–‡ä»¶</span><span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> PurifyCSSPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'purifycss-webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span><span class="token keyword">export</span> <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token operator">...</span><span class="token operator">...</span>    plugins<span class="token punctuation">:</span><span class="token punctuation">[</span>        <span class="token keyword">new</span> <span class="token class-name">PurifyCSSPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// Give paths to parse for rules. These should be absolute!</span>      paths<span class="token punctuation">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist/*.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre></li><li><p>mpaï¼š<a href="https://www.npmjs.com/package/mini-css-extract-plugin" target="_blank" rel="noopener">mini-css-extract-plugin</a>å°†cssä»jsä¸­æŠ½ç¦»å‡ºæ¥</p><blockquote><p>æ³¨æ„ï¼šå®ƒå’Œstyle-loader äº’æ–¥ï¼Œ ä¸èƒ½åŒæ—¶å¼€å¯ï¼Œä¸”HMR(çƒ­æ›´æ–°çš„æ—¶å€™ä¹Ÿä¸æ”¯æŒ) ï¼Œ åªç”¨äºå¼€å‘ç¯å¢ƒã€‚</p></blockquote><pre class=" language-javascript"><code class="language-javascript">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev mini<span class="token operator">-</span>css<span class="token operator">-</span>extract<span class="token operator">-</span>plugin<span class="token punctuation">;</span><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span><span class="token keyword">export</span> <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token operator">...</span><span class="token operator">...</span>  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      test<span class="token punctuation">:</span> <span class="token regex">/\.css$/i</span><span class="token punctuation">,</span>      use<span class="token punctuation">:</span> <span class="token punctuation">[</span>        <span class="token comment" spellcheck="true">// 'style-loader',</span>        <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å’Œstyle-loader äº’æ–¥ ä¸èƒ½åŒæ—¶å¼€å¯ HMR(çƒ­æ›´æ–°çš„æ—¶å€™ä¹Ÿä¸æ”¯æŒ)  åªç”¨äºå¼€å‘ç¯å¢ƒ</span>          loader<span class="token punctuation">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>          options<span class="token punctuation">:</span> <span class="token punctuation">{</span>            publicPath<span class="token punctuation">:</span> <span class="token string">'../'</span><span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        loader<span class="token punctuation">:</span> <span class="token string">'css-loader'</span>        <span class="token punctuation">}</span>      <span class="token punctuation">]</span>    <span class="token punctuation">}</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span></code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> webpack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å•å…ƒæµ‹è¯•</title>
      <link href="/2019/11/30/Mocha/index/"/>
      <url>/2019/11/30/Mocha/index/</url>
      
        <content type="html"><![CDATA[<h4 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><p>å•å…ƒæµ‹è¯•æ˜¯æŒ‡å¯¹è½¯ä»¶ä¸­æœ€å°å¯æµ‹è¯•å•å…ƒè¿›è¡Œæ£€æŸ¥éªŒè¯ï¼Œä¹Ÿç§°ä½œæ¨¡å—æµ‹è¯•ã€‚åœ¨nodeJsä¸­é€šå¸¸æ˜¯æŒ‡å¯¹æŸä¸ªå‡½æ•°æˆ–è€…APIè¿›è¡Œæ­£ç¡®éªŒè¯ï¼Œä»¥ä¿è¯ä»£ç çš„å¯ç”¨æ€§ã€‚</p><p>å•å…ƒæµ‹è¯•æœ‰å¾ˆå¤šç§ï¼Œå¸¸è§çš„æœ‰ï¼šè¡Œä¸ºé©±åŠ¨å¼€å‘ï¼ˆBDDï¼‰å’Œ æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰ã€‚</p><ul><li>è¡Œä¸ºé©±åŠ¨å¼€å‘ï¼ˆBDDï¼‰ï¼šè¡Œä¸ºé©±åŠ¨å¼€å‘å…³æ³¨çš„æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æœ€ç»ˆå®ç°æ˜¯å¦å’Œç”¨æˆ·æœŸæœ›ä¸€è‡´ã€‚</li><li>æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰ï¼šæµ‹è¯•é©±åŠ¨å¼€å‘çš„ç›®çš„æ˜¯å–å¾—å¿«é€Ÿåé¦ˆï¼Œä½¿æ‰€æœ‰åŠŸèƒ½éƒ½æ˜¯å¯ç”¨çš„ã€‚</li></ul><h4 id="Mocha"><a href="#Mocha" class="headerlink" title="Mocha"></a>Mocha</h4><p>Mochaæ˜¯ç°åœ¨æœ€æµè¡Œçš„ä¸€ç§å•å…ƒæµ‹è¯•æ¡†æ¶ã€‚MochaåŠŸèƒ½æ¯”è¾ƒä¸°å¯Œï¼Œæ”¯æŒBDDã€TDD</p><p>é£æ ¼çš„æµ‹è¯•ï¼Œè€Œä¸”æ”¯æŒå¼‚æ­¥ã€åŒæ­¥çš„æµ‹è¯•ã€‚</p><p>å®‰è£…ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g mochaor<span class="token function">npm</span> <span class="token function">install</span> -S mocha</code></pre><h4 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="headerlink" title="ç®€å•ä½¿ç”¨"></a>ç®€å•ä½¿ç”¨</h4><p>åˆ›å»ºä¸€ä¸ªdemo01.jsæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­åŒ…å«ä¸€ä¸ªæ±‚å’Œå‡½æ•°ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">...</span>rest<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> rest<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> a <span class="token operator">+</span> b    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>    add<span class="token punctuation">}</span></code></pre><p>å†åˆ›å»ºä¸€ä¸ªtestçš„æ–‡ä»¶å¤¹ï¼Œè¿›è¡Œæµ‹è¯•ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> lib <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../demo01.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> should <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'should'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Math'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'#add'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'add(0,0) should return 0'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">//ä½¿ç”¨assertæ–­è¨€åº“</span>            <span class="token comment" spellcheck="true">// assert.strictEqual(0,lib.add(0,0));</span>            <span class="token comment" spellcheck="true">//ä½¿ç”¨should.jsæ–­è¨€åº“è¿›è¡Œæµ‹è¯•</span>            lib<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>should<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'add(1,-1) should return 0'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// assert.strictEqual(0,lib.add(1,-1))</span>            lib<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>should<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'add(1,1) should return 2'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// assert.strictEqual(2,lib.add(1,1))</span>            lib<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>should<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p>describe(moduleName,testDetail):æè¿°å°†è¦æµ‹è¯•çš„æ¨¡å—ã€‚</p><p>it(info,function()):æµ‹è¯•è¯­å¥æ”¾åœ¨å›è°ƒå‡½æ•°ä¸­ï¼š</p><ul><li>info æ˜¯æ­£ç¡®è¾“å‡ºæ—¶çš„ç®€å•è¯­å¥æè¿°</li><li>ä¸€ä¸ªitå¯¹åº”ä¸€ä¸ªå®é™…çš„å¯èƒ½æƒ…å†µ</li></ul><p>å…³äºassetsçš„æ›´å¤šçš„APIï¼Œå¯å‚è€ƒ<a href="https://nodejs.org/dist/latest/docs/api/assert.html#assert_assert" target="_blank" rel="noopener">node.jså®˜ç½‘</a></p><p>å…³äºshould.jsçš„æ›´å¤šçš„APIï¼Œå¯å‚è€ƒ<a href="https://shouldjs.github.io/" target="_blank" rel="noopener">should.jså®˜ç½‘</a></p><p>ç„¶åï¼Œåœ¨package.jsonä¸­å†™ä¸€ä¸‹å‘½ä»¤ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">"test"</span><span class="token punctuation">:</span> <span class="token string">"mocha"</span><span class="token punctuation">}</span></code></pre><p>æ‰§è¡Œå‘½ä»¤ï¼Œmochaå³å¯è‡ªåŠ¨æ‰§è¡Œtestæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„æµ‹è¯•è„šæœ¬ã€‚</p><h4 id="å¼‚æ­¥æµ‹è¯•"><a href="#å¼‚æ­¥æµ‹è¯•" class="headerlink" title="å¼‚æ­¥æµ‹è¯•"></a>å¼‚æ­¥æµ‹è¯•</h4><p>ä½¿ç”¨Mochaè¿›è¡Œå¼‚æ­¥æµ‹è¯•ï¼Œåªéœ€è¦åœ¨æµ‹è¯•å®Œæˆä¹‹åå›è°ƒä¸€ä¸ªå›è°ƒå‡½æ•°å³å¯ï¼Œä¾‹å¦‚ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//å¼‚æ­¥æµ‹è¯•</span><span class="token keyword">function</span> <span class="token function">asyncFn</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>    asyncFn<span class="token punctuation">}</span></code></pre><p>æµ‹è¯•ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> lib <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../demo03.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'async.js'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'async'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should wait 1000ms'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            lib<span class="token punctuation">.</span><span class="token function">asyncFn</span><span class="token punctuation">(</span>done<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><h4 id="è·¯ç”±æµ‹è¯•"><a href="#è·¯ç”±æµ‹è¯•" class="headerlink" title="è·¯ç”±æµ‹è¯•"></a>è·¯ç”±æµ‹è¯•</h4><p>éœ€è¦å€Ÿç”¨<code>supertest</code>åº“å¯¹åç«¯çš„APIæ¥å£è¿›è¡Œæµ‹è¯•.</p><p>å®‰è£…ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev supertest</code></pre><p>supertestæ”¯æŒå„ç§æ¡†æ¶ã€‚æœ¬ä¾‹ä»¥Expressä¸ºä¾‹ï¼š</p><pre><code>//æµ‹è¯•è·¯ç”±const express = require(&#39;express&#39;);const app = express();app.get(&#39;/user&#39;,(req,res) =&gt; {    res.status(200).json({        name:&#39;ykx&#39;,        age:24    })});module.exports = app;</code></pre><p>expressè®¾ç½®äº†ä¸€ä¸ªè¿”å›jsonæ ¼å¼çš„/userè·¯ç”±ï¼Œé€šè¿‡getè¯·æ±‚ï¼Œè¿”å›ç”¨æˆ·åå’Œå¹´é¾„ã€‚</p><p>æµ‹è¯•ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'supertest'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../demo04.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'GET /user'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should an name with age'</span><span class="token punctuation">,</span><span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token function">request</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/user'</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span><span class="token string">'application/json;charset=utf-8'</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token punctuation">{</span>            name<span class="token punctuation">:</span><span class="token string">'ykx'</span><span class="token punctuation">,</span>            age<span class="token punctuation">:</span><span class="token number">24</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>done<span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><h4 id="æµ‹è¯•è¦†ç›–ç‡"><a href="#æµ‹è¯•è¦†ç›–ç‡" class="headerlink" title="æµ‹è¯•è¦†ç›–ç‡"></a>æµ‹è¯•è¦†ç›–ç‡</h4><p>æµ‹è¯•è¦†ç›–ç‡ä¸€èˆ¬åŒ…å«å››ä¸ªç»´åº¦ï¼š</p><ul><li>è¡Œè¦†ç›–ç‡ï¼šæ˜¯å¦æ¯ä¸€è¡Œéƒ½æ‰§è¡Œäº†</li><li>å‡½æ•°è¦†ç›–ç‡ï¼šæ˜¯å¦æ¯ä¸€ä¸ªå‡½æ•°éƒ½æ‰§è¡Œäº†</li><li>åˆ†æ”¯è¦†ç›–ç‡ï¼šæ˜¯å¦æ¯ä¸ªifä»£ç å—éƒ½æ‰§è¡Œäº†</li><li>è¯­å¥è¦†ç›–ç‡ã€‚æ˜¯å¦æ¯ä¸ªè¯­å¥éƒ½æ‰§è¡Œäº†</li></ul><p>åœ¨NodeJsä¸­å¯ä»¥ä½¿ç”¨<code>Istanbul</code>ä»£ç è¦†ç›–ç‡å·¥å…·ã€‚</p><p>å®‰è£…ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g istanbul</code></pre><p>ç„¶ååœ¨package.jsonä¸­å»é…ç½®å‘½ä»¤ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token string">"scripts"</span><span class="token keyword">:</span> <span class="token punctuation">{</span>  <span class="token string">"test"</span><span class="token keyword">:</span> <span class="token string">"mocha"</span>,  <span class="token string">"cover"</span><span class="token keyword">:</span><span class="token string">"istanbul cover node_modules/mocha/bin/_mocha test/"</span><span class="token punctuation">}</span></code></pre><p>æ‰§è¡Œ<code>npm run cover</code>å‘½ä»¤ï¼Œä¼šåœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆcoverageæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«æ‰€æœ‰çš„æµ‹è¯•æ•°æ®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Mocha </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mocha </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLè‡ªç„¶è¿æ¥æŸ¥è¯¢</title>
      <link href="/2019/11/24/Mysql/naturalJoin/"/>
      <url>/2019/11/24/Mysql/naturalJoin/</url>
      
        <content type="html"><![CDATA[<h4 id="ä»€ä¹ˆæ˜¯è‡ªç„¶è¿æ¥ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯è‡ªç„¶è¿æ¥ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯è‡ªç„¶è¿æ¥ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯è‡ªç„¶è¿æ¥ï¼Ÿ</h4><p>é€šè¿‡mysqlè‡ªå·±åˆ¤æ–­å®Œæˆè¿æ¥è¿‡ç¨‹,ä¸éœ€è¦æŒ‡å®šè¿æ¥æ¡ä»¶ï¼Œmysqlä¼šæ ¹æ®å¤šä¸ªè¡¨å†…çš„ç›¸åŒå­—æ®µä½œä¸ºè¿æ¥æ¡ä»¶ã€‚</p><h4 id="è‡ªç„¶è¿æ¥çš„åˆ†ç±»"><a href="#è‡ªç„¶è¿æ¥çš„åˆ†ç±»" class="headerlink" title="è‡ªç„¶è¿æ¥çš„åˆ†ç±»"></a>è‡ªç„¶è¿æ¥çš„åˆ†ç±»</h4><p>è‡ªç„¶è¿æ¥åˆ†ä¸ºï¼š<strong><em>å†…è‡ªç„¶è¿æ¥</em></strong>ï¼ˆinner natural joinï¼‰å’Œ <strong><em>å¤–è‡ªç„¶è¿æ¥</em></strong>ã€‚å…¶ä¸­<strong><em>å¤–è‡ªç„¶è¿æ¥</em></strong>åˆå¯åˆ†ä¸º<strong><em>å·¦å¤–è‡ªç„¶è¿æ¥</em></strong>ï¼ˆleft natural join ï¼‰å’Œ <strong><em>å³å¤–è‡ªç„¶è¿æ¥</em></strong>ï¼ˆright natural joinï¼‰ã€‚</p><p>æ³¨æ„ï¼šè‡ªç„¶è¿æ¥æ²¡æœ‰åˆ¤æ–­è¯­å¥ï¼ï¼ï¼</p><h4 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p>å‡å¦‚å­˜åœ¨ä¸¤å¼ è¡¨ï¼štab1å’Œtab2</p><ul><li><p>å†…è‡ªç„¶è¿æ¥</p><pre class=" language-javascript"><code class="language-javascript">select <span class="token operator">*</span> <span class="token keyword">from</span> tab1 natural join tab2<span class="token punctuation">;</span></code></pre><p>å†…è‡ªç„¶è¿æ¥ç›¸å½“äº<strong>usingä¸ºåˆ¤æ–­è¯­å¥çš„å†…è¿æ¥ï¼š</strong>å³ï¼š</p><pre class=" language-javascript"><code class="language-javascript">select <span class="token operator">*</span> <span class="token keyword">from</span> tbl_name1 inner join tbl_name2 using<span class="token punctuation">;</span></code></pre></li><li><p>å·¦å¤–è‡ªç„¶è¿æ¥</p><pre class=" language-javascript"><code class="language-javascript">select <span class="token operator">*</span> <span class="token keyword">from</span> tab1 natural left join tab2<span class="token punctuation">;</span></code></pre><p>ç›¸å½“äºusingä¸ºåˆ¤æ–­è¯­å¥çš„å·¦å¤–è¿æ¥ï¼š</p><pre class=" language-javascript"><code class="language-javascript">select <span class="token operator">*</span> <span class="token keyword">from</span> tab1 left outer join tab2 using<span class="token punctuation">;</span></code></pre></li><li><p>å³å¤–è‡ªç„¶è¿æ¥</p><pre class=" language-javascript"><code class="language-javascript">select <span class="token operator">*</span> <span class="token keyword">from</span> tab1 natural right join tab2<span class="token punctuation">;</span></code></pre><p>ç›¸å½“äºusingä¸ºåˆ¤æ–­è¯­å¥çš„å³å¤–è¿æ¥ï¼š</p><pre class=" language-javascript"><code class="language-javascript">select <span class="token operator">*</span> <span class="token keyword">from</span> tab1 natural right join tab2<span class="token punctuation">;</span></code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> Mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL 8.0+é‡ç½®å¯†ç </title>
      <link href="/2019/11/24/Mysql/resetPassWord/"/>
      <url>/2019/11/24/Mysql/resetPassWord/</url>
      
        <content type="html"><![CDATA[<h4 id="å…³é—­æ•°æ®åº“"><a href="#å…³é—­æ•°æ®åº“" class="headerlink" title="å…³é—­æ•°æ®åº“"></a>å…³é—­æ•°æ®åº“</h4><p>1ã€åœ¨ç»ˆç«¯ä¸­è¾“å…¥ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">sudo</span> /usr/local/mysql/support-files mysql.server stop</code></pre><p>2ã€åœ¨è®¿è¾¾ä¸­æ‰¾åˆ°å®‰è£…å¥½çš„mysqlï¼Œå…³é—­mysqlè¿è¡Œã€‚</p><h4 id="è·³è¿‡éªŒè¯"><a href="#è·³è¿‡éªŒè¯" class="headerlink" title="è·³è¿‡éªŒè¯"></a>è·³è¿‡éªŒè¯</h4><pre class=" language-bash"><code class="language-bash">// è¿›å…¥æ•°æ®åº“æŒ‡ä»¤æ–‡ä»¶<span class="token function">cd</span> /usr/local/mysql/bin// è·³è¿‡æƒé™è®¤è¯<span class="token function">sudo</span> ./mysqld_safe --skip-grant-tables</code></pre><h4 id="å…å¯†ç è¿›å…¥æ•°æ®åº“"><a href="#å…å¯†ç è¿›å…¥æ•°æ®åº“" class="headerlink" title="å…å¯†ç è¿›å…¥æ•°æ®åº“"></a>å…å¯†ç è¿›å…¥æ•°æ®åº“</h4><p>åœ¨ä¸Šè¿°æŒ‡ä»¤è¿è¡Œåï¼Œæ–°å¼€ä¸€ä¸ªç»ˆç«¯ï¼ŒåŒæ—¶ä¿æŒåŸæ¥é‚£ä¸ªç»ˆç«¯ä¹Ÿå¼€ç€ï¼Œåœ¨æ–°çš„ç»ˆç«¯è¾“å…¥æŒ‡ä»¤å¦‚ä¸‹ï¼š</p><pre class=" language-bash"><code class="language-bash">//  æ‰§è¡ŒmysqlæŒ‡ä»¤/usr/local/mysql/bin/mysql// è¿›å…¥åä¸º<span class="token operator">&lt;</span>mysql<span class="token operator">></span>çš„æ•°æ®åº“use mysql<span class="token punctuation">;</span>æŠŠä¹‹å‰å¯†ç æ¸…ç©ºï¼šupdate user <span class="token keyword">set</span> authentication_string<span class="token operator">=</span><span class="token string">''</span>  where user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>// åˆ·æ–°æƒé™flush privileges<span class="token punctuation">;</span>// ä¿®æ”¹å¯†ç  ä½†ä¸é€‚ç”¨äº8.0+çš„ç‰ˆæœ¬// <span class="token keyword">set</span> password <span class="token keyword">for</span> <span class="token string">'root'</span>@<span class="token string">'localhost'</span> <span class="token operator">=</span> password<span class="token punctuation">(</span><span class="token string">'æ–°çš„å¯†ç '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>// 8.0+ç‰ˆæœ¬ä¿®æ”¹å¯†ç ALTER user <span class="token string">'root'</span>@<span class="token string">'localhost'</span> indentified by <span class="token string">'æ–°å¯†ç '</span><span class="token punctuation">;</span>//åˆ·æ–°ä¸€ä¸‹flush privileges<span class="token punctuation">;</span>// é€€å‡ºmysql<span class="token keyword">exit</span></code></pre><p>mysqlå¸¸ç”¨å‘½ä»¤ï¼š</p><pre class=" language-bash"><code class="language-bash">1ã€è¿›å…¥æœ¬åœ°æ•°æ®åº“ï¼š/usr/local/mysql/bin/mysql -u root -p æ ¹æ®æç¤ºè¾“å…¥å¯†ç 2ã€è¿›å…¥è¿œç¨‹æ•°æ®åº“ï¼šå‡è®¾è¿œç¨‹ä¸»æœºçš„IPä¸ºï¼š23.106.134.88ï¼Œç”¨æˆ·åä¸ºroot,å¯†ç ä¸º123456ï¼šmysql -h23.106.134.88 -u root -p æ ¹æ®æç¤ºè¾“å…¥å¯†ç ã€‚3ã€å¯åŠ¨mysqlæœåŠ¡ï¼š<span class="token function">sudo</span> /usr/local/mysql/support-files/mysql.server start<span class="token punctuation">;</span>4ã€ç»ˆæ­¢mysqlæœåŠ¡ï¼š<span class="token function">sudo</span> /usr/local/mysql/support-files/mysql.server stop<span class="token punctuation">;</span>5ã€é‡å¯mysqlæœåŠ¡ï¼š<span class="token function">sudo</span> /usr/local/mysql/support-files/mysql.server restart<span class="token punctuation">;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESCæœåŠ¡å™¨Linuxä¸‹å®‰è£…mysql</title>
      <link href="/2019/11/24/Linux/mysql/"/>
      <url>/2019/11/24/Linux/mysql/</url>
      
        <content type="html"><![CDATA[<p>1ã€é‡å¯æœåŠ¡å™¨ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># reboot</span></code></pre><p>2ã€æ£€æŸ¥æ˜¯å¦å·²ç»å®‰è£…mysqlæœåŠ¡ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># yum list installed | grep mysql</span></code></pre><p>å¦‚æœæ˜¾ç¤ºä¸€ä¸‹å†…å®¹ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰å®‰è£…ï¼š-bash: gerp: command not found<br>3ã€ä¸‹è½½mysqlå®‰è£…åŒ…ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># rpm -ivh http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm</span></code></pre><p>4ã€å®‰è£…mysqlï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># yum install -y mysql-server</span>æˆ–è€…<span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># yum install mysql-community-server</span></code></pre><p>5ã€è®¾ç½®å¼€æœºå¯åŠ¨ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># systemctl enable mysqld.service</span></code></pre><p>6ã€æŸ¥çœ‹æœåŠ¡æ˜¯å¦åŠ å…¥å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># systemctl list-unit-files | grep mysqld</span></code></pre><p>7ã€æŸ¥çœ‹mysqlçš„é»˜è®¤ä¸´æ—¶å¯†ç ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># systemctl list-unit-files | grep mysqld</span></code></pre><p>8ã€rootç”¨æˆ·ç™»å½•mysqlæ•°æ®åº“ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@sir-xiao server<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysql -u root -p </span>Enter password: æ ¹æ®æç¤º è¾“å…¥å¯†ç </code></pre><p>9ã€ä¿®æ”¹rootç”¨æˆ·å¯†ç ï¼š</p><pre class=" language-bash"><code class="language-bash">mysql<span class="token operator">></span> use  mysqlï¼›----åˆ‡æ¢åˆ°mysql dbmysql<span class="token operator">></span> UPDATE user SET authentication_string <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">'newpass'</span><span class="token punctuation">)</span> WHERE user <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span>---æ–°ç‰ˆæœ¬mysqlæ‰§è¡Œmysql<span class="token operator">></span> UPDATE user SET Password <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">'newpass'</span><span class="token punctuation">)</span> WHERE user <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span>---è€ç‰ˆæœ¬mysqlæ‰§è¡Œmysql<span class="token operator">></span> flush privileges<span class="token punctuation">;</span>---å‘½ä»¤ç«‹å³æ‰§è¡Œç”Ÿæ•ˆ</code></pre><p>10ã€å¿˜è®°å¯†ç é‡ç½®å¯†ç ï¼š</p><pre class=" language-bash"><code class="language-bash">1ã€æŸ¥æ‰¾mysqlçš„å¯åŠ¨æ–‡ä»¶ï¼š<span class="token punctuation">[</span>root@sir-xiao etc<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># whereis  my</span>2ã€vim /etc/my.cnfä¿®æ”¹my.cnfå¯åŠ¨å‚æ•°ï¼Œåœ¨æ–‡ä»¶çš„æœ€åå¢åŠ ï¼Œmysqlå¯åŠ¨å‚æ•°â€”â€” --skip-grant-tablesã€‚å¯åŠ¨mysqlæ—¶ä¸å¯åŠ¨æˆæƒè¡¨ grant-tables<span class="token punctuation">[</span>root@sir-xiao etc<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># vi /etc/my.cnf skip-grant-tables</span><span class="token punctuation">[</span>root@sir-xiao etc<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># :wq</span>viæ¨¡å¼Enterè¿›å…¥ï¼ŒæŒ‰â€œiâ€é”®ï¼Œç¼–è¾‘æ–‡ä»¶ï¼ŒæŒ‰â€œescâ€é”®ï¼Œè¾“å…¥:wqå†™å…¥ä¿å­˜é€€å‡ºï¼Œ:q ä¸ä¿å­˜é€€å‡º3ã€é‡å¯mysqlæœåŠ¡4ã€ä¿®æ”¹å¯†ç ï¼šåŒä¸Š5ã€å¯†ç ä¿®æ”¹æˆåŠŸåéœ€è¦è¿›å…¥viæ¨¡å¼ä¸‹é‡æ–°ç¼–è¾‘/etc/my.cnfå»æ‰å¢åŠ çš„skip-grant-tables é‡å¯mysqlæœåŠ¡ï¼Œå°±å¯ä»¥ç”¨å¯†ç ç™»å½•äº†</code></pre>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxåŒåŸŸåä¸‹é…ç½®å¤šé¡¹ç›®</title>
      <link href="/2019/11/23/Nginx/multiProject/"/>
      <url>/2019/11/23/Nginx/multiProject/</url>
      
        <content type="html"><![CDATA[<h4 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h4><pre class=" language-bash"><code class="language-bash">build: <span class="token punctuation">{</span>    index: path.resolve<span class="token punctuation">(</span>__dirname, <span class="token string">'../dist/index.html'</span><span class="token punctuation">)</span>,    // Paths    assetsRoot: path.resolve<span class="token punctuation">(</span>__dirname, <span class="token string">'../dist'</span><span class="token punctuation">)</span>,    assetsSubDirectory: <span class="token string">'static'</span>,    assetsPublicPath: <span class="token string">'/admin/'</span>,    productionSourceMap: true,    devtool: <span class="token string">'#source-map'</span>,    productionGzip: true,    productionGzipExtensions: <span class="token punctuation">[</span><span class="token string">'js'</span>, <span class="token string">'css'</span><span class="token punctuation">]</span>,    bundleAnalyzerReport: process.env.npm_config_report  <span class="token punctuation">}</span></code></pre><p>æŠŠ assetsPublicPathä¿®æ”¹ä¸ºä½ åœ¨nginxé…ç½®çš„è·¯å¾„ã€‚</p><h4 id="router-js"><a href="#router-js" class="headerlink" title="router.js"></a>router.js</h4><pre class=" language-bash"><code class="language-bash">//baseè¦å’Œä¸Šé¢é…ç½®çš„assetsPublicPathé…ç½®çš„ä¸€æ · mode:<span class="token string">'history'</span>, base: <span class="token string">'/admin/'</span>,</code></pre><h4 id="é…ç½®nginxï¼š"><a href="#é…ç½®nginxï¼š" class="headerlink" title="é…ç½®nginxï¼š"></a>é…ç½®nginxï¼š</h4><pre class=" language-bash"><code class="language-bash">keepalive_timeout  65<span class="token punctuation">;</span><span class="token function">gzip</span>  on<span class="token punctuation">;</span>//å¼€å¯Gzipå‹ç¼©gzip_disable <span class="token string">'msie6'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#ä¸ä½¿ç”¨gzip IE6</span>gzip_min_length 100k<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#gzipå‹ç¼©æœ€å°æ–‡ä»¶å¤§å°ï¼Œè¶…å‡ºè¿›è¡Œå‹ç¼©ï¼ˆè‡ªè¡Œè°ƒèŠ‚ï¼‰</span>gzip_buffers 4 16k<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#buffer ä¸ç”¨ä¿®æ”¹</span>gzip_comp_level 3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">#å‹ç¼©çº§åˆ«:1-10ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©çš„è¶Šå¥½ï¼Œæ—¶é—´ä¹Ÿè¶Šé•¿</span>server <span class="token punctuation">{</span>    listen 80<span class="token punctuation">;</span>    server_name www.xxx.cn<span class="token punctuation">;</span>//é…ç½®ä½ çš„åŸŸå    location /<span class="token punctuation">{</span>//é…ç½®é»˜è®¤çš„é¡¹ç›®         root /data/www/web<span class="token punctuation">;</span>         try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>         index index.html index.htm<span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">#proxy_pass http://127.0.0.1:8080;</span>     <span class="token punctuation">}</span>     location ^~/admin<span class="token punctuation">{</span>//é…ç½® åŸŸå/admin å¯¹åº”çš„é¡¹ç›®         <span class="token function">alias</span> /data/www/admin/<span class="token punctuation">;</span>//åˆ«å é…ç½®é¡¹ç›®æ–‡ä»¶è·¯å¾„         try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>         index index.html index.htm<span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>-e <span class="token variable">$request_filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>//é˜²æ­¢äºŒçº§è·¯ç”±ä¸‹é¡µé¢reloadç©ºç™½é¡µé¢             rewrite ^/<span class="token punctuation">(</span>.*<span class="token punctuation">)</span> /admin/index.html last<span class="token punctuation">;</span>             <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token comment" spellcheck="true">#proxy_pass http://127.0.0.1:8080;</span>     <span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxä¸‹é…ç½®Vueé¡¹ç›®</title>
      <link href="/2019/11/23/Nginx/vue/"/>
      <url>/2019/11/23/Nginx/vue/</url>
      
        <content type="html"><![CDATA[<p>1ã€é…ç½®é€‰æ‹©ï¼š</p><ul><li>Linuxç³»ç»Ÿï¼šCentos 6.5 x64</li><li>Nginxç‰ˆæœ¬ï¼š1.7.8</li></ul><p>2ã€å®‰è£…nginxï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> /usr/local//ä¸‹è½½nginx<span class="token function">wget</span> http://nginx.org/download/nginx-1.7.8.tar.gz<span class="token function">cd</span> nginx-1.7.8<span class="token function">make</span><span class="token function">make</span> <span class="token function">install</span></code></pre><p>3ã€å¼€å¯nginxæœåŠ¡ï¼š</p><pre class=" language-bash"><code class="language-bash">/usr/local/nginx-1.7.8/sbin/nginxé‡å¯æˆ–å…³é—­è¿›ç¨‹ï¼š/usr/local/nginx-1.7.8/sbin/nginx -s reload/usr/local/nginx-1.7.8/sbin/nginx -s stop</code></pre><p>4ã€å…³é—­é˜²ç«å¢™ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">service</span> iptables stop</code></pre><p>5ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š</p><pre class=" language-bash"><code class="language-bash">usr/local/nginx-1.7.8/conf/nginx.confserver <span class="token punctuation">{</span>    listen 80<span class="token punctuation">;</span>//ç›‘å¬80ç«¯å£    server_name www.yangkunxiao.cn<span class="token punctuation">;</span>   //é¡¹ç›®å¯¹åº”åŸŸå    location /<span class="token punctuation">{</span>     root /data/www/dist<span class="token punctuation">;</span>     //é¡¹ç›®å­˜æ”¾è·¯å¾„     try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>    //vueé¡¹ç›®é…ç½®historyæ¨¡å¼     index index.html index.htm<span class="token punctuation">;</span>    //é¡¹ç›®é¦–é¡µåç§°     <span class="token comment" spellcheck="true">#proxy_pass http://127.0.0.1:8080;   //åŸŸåå¯¹åº”URLï¼Œè¿™ä¸ªURLå¯¹åº”çš„å°±æ˜¯http://m.horace.spaceï¼Œå¯é€šè¿‡åŸŸåç›´æ¥è®¿é—®</span>    <span class="token punctuation">}</span>    location /assets/<span class="token punctuation">{</span>//é…ç½®èµ„æºæ–‡ä»¶å¤¹        root /usr/<span class="token punctuation">;</span>//èµ„æºæ–‡ä»¶å¤¹è·¯å¾„        autoindex on<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre><p>7ã€å¤šä¸ªé¡¹ç›®é…ç½®å¤šä¸ªserviceå³å¯<br>6ã€é‡å¯å³å¯</p>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxä¸‹é…ç½®é™æ€èµ„æº</title>
      <link href="/2019/11/23/Nginx/staticSource/"/>
      <url>/2019/11/23/Nginx/staticSource/</url>
      
        <content type="html"><![CDATA[<p>1ã€æŸ¥çœ‹nginxå®‰è£…è·¯å¾„ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">whereis</span> nginx</code></pre><p>2ã€æ–°å»ºé™æ€èµ„æºå­˜å‚¨æ–‡ä»¶å¤¹ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">mkdir</span> assets</code></pre><p>3ã€è¿›å…¥nginxç›®å½•ä¸­ï¼Œä¿®æ”¹nginx.confæ–‡ä»¶ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> nginx: /usr/local/nginx/confvim nginx.confå…·ä½“é…ç½®å¦‚ä¸‹ï¼šserver <span class="token punctuation">{</span>    listen 80<span class="token punctuation">;</span>    server_name www.yangkunxiao.cn<span class="token punctuation">;</span>    location /<span class="token punctuation">{</span>     root /data/www/dist<span class="token punctuation">;</span>     try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>     index index.html index.htm<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">#proxy_pass http://127.0.0.1:8080;</span>    <span class="token punctuation">}</span>    location /assets/<span class="token punctuation">{</span>        root /usr/<span class="token punctuation">;</span>        autoindex on<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre><p>4ã€ä¿å­˜å¹¶é‡å¯nginx</p>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpå’ŒmySql</title>
      <link href="/2019/11/22/Php/mysql/"/>
      <url>/2019/11/22/Php/mysql/</url>
      
        <content type="html"><![CDATA[<h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>é€šè¿‡PHPï¼Œå¼€å‘è€…å¯ä»¥å’Œæ•°æ®åº“ç›¸è¿ã€‚<br>åœ¨PHP5.0ç‰ˆæœ¬ä»¥åï¼Œå®˜æ–¹æ¨èä¸€ä¸‹ä¸¤ç§æ–¹å¼è¿›è¡ŒPHPå’Œæ•°æ®åº“çš„è¿æ¥ï¼š</p><ul><li>MySQLi extension (â€œiâ€ æ„ä¸º improved)ï¼šMySQLi åªé’ˆå¯¹ MySQL æ•°æ®åº“</li><li>PDO (PHP Data Objects)ï¼šPDO åº”ç”¨åœ¨ 12 ç§ä¸åŒæ•°æ®åº“ä¸­<br>å› ä¸ºæˆ‘è¿™é‡Œåªå®‰è£…äº†mySqlï¼Œæ‰€ä»¥æœ¬æ–‡æ —å­å‡ä»¥ç¬¬ä¸€ç§æ–¹å¼è¿›è¡Œæ“ä½œã€‚</li></ul><h4 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h4><p>åœ¨è®¿é—®æ•°æ®åº“ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ•°æ®åº“çš„è¿æ¥</p><pre class=" language-bash"><code class="language-bash"><span class="token variable">$serverName</span> <span class="token operator">=</span> <span class="token string">'localhost'</span><span class="token punctuation">;</span>//æ•°æ®åº“åœ°å€<span class="token variable">$serverRoot</span> <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span>//æ•°æ®åº“ç™»å½•åç§°<span class="token variable">$passWord</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>//æ•°æ®åº“å¯†ç <span class="token variable">$dbName</span> <span class="token operator">=</span> <span class="token string">"myDB"</span><span class="token punctuation">;</span><span class="token variable">$conn</span> <span class="token operator">=</span> new mysqli<span class="token punctuation">(</span><span class="token variable">$serverName</span>,<span class="token variable">$userName</span>,<span class="token variable">$userPassword</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//è¿æ¥å¤±è´¥if<span class="token punctuation">(</span><span class="token variable">$conn</span>-<span class="token operator">></span>connect_error<span class="token punctuation">)</span><span class="token punctuation">{</span>    die<span class="token punctuation">(</span><span class="token string">"æ•°æ®åº“è¿æ¥å¤±è´¥ï¼š"</span><span class="token keyword">.</span><span class="token variable">$conn</span>-<span class="token operator">></span>connect_error<span class="token punctuation">)</span><span class="token punctuation">}</span>mysqli_set_charset<span class="token punctuation">(</span><span class="token variable">$this</span>-<span class="token operator">></span>conn, <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//è®¾ç½®å­—ç¬¦ç¼–ç ä¸ºutf8æ ¼å¼ å¦åˆ™æ±‰å­—å¯èƒ½å‡ºç°ä¹±ç çš„æƒ…å†µ//æ•°æ®åº“æ“ä½œå®Œæˆä¹‹å ä¸€å®šè®°å¾—å…³é—­æ•°æ®åº“çš„è¿æ¥<span class="token variable">$conn</span>-<span class="token operator">></span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="æ“ä½œæ•°æ®åº“"><a href="#æ“ä½œæ•°æ®åº“" class="headerlink" title="æ“ä½œæ•°æ®åº“"></a>æ“ä½œæ•°æ®åº“</h4><p>1ã€åˆ›å»ºæ•°æ®åº“ï¼š<code>$sql = &quot;CREATE DATABASE IF NOT EXISTS dbname&quot;</code><br>2ã€åˆ›å»ºè¡¨ï¼šä¸Šé¢çš„è¿æ¥è¯­å¥è¦ä¿®æ”¹ä¸‹ï¼ŒåŠ ä¸ªå‚æ•°ï¼Œç”¨æ¥é€‰æ‹©æ•°æ®åº“ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token variable">$conn</span> <span class="token operator">=</span> new mysqli<span class="token punctuation">(</span><span class="token variable">$serverName</span>,<span class="token variable">$userName</span>,<span class="token variable">$userPassword</span>,<span class="token variable">$dbName</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"CREATE TABLE MyGuests (id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, firstname VARCHAR(30) NOT NULL,lastname VARCHAR(30) NOT NULL,email VARCHAR(50),reg_date TIMESTAMP)"</span><span class="token punctuation">;</span></code></pre><p>å±æ€§è¯´æ˜ï¼š</p><ul><li>NOT NULL - æ¯ä¸€è¡Œéƒ½å¿…é¡»å«æœ‰å€¼ï¼ˆä¸èƒ½ä¸ºç©ºï¼‰ï¼Œnull å€¼æ˜¯ä¸å…è®¸çš„ã€‚</li><li>DEFAULT value - è®¾ç½®é»˜è®¤å€¼</li><li>UNSIGNED - ä½¿ç”¨æ— ç¬¦å·æ•°å€¼ç±»å‹ï¼Œ0 åŠæ­£æ•°</li><li>AUTO INCREMENT - è®¾ç½® MySQL å­—æ®µçš„å€¼åœ¨æ–°å¢è®°å½•æ—¶æ¯æ¬¡è‡ªåŠ¨å¢é•¿ 1</li><li>PRIMARY KEY - è®¾ç½®æ•°æ®è¡¨ä¸­æ¯æ¡è®°å½•çš„å”¯ä¸€æ ‡è¯†ã€‚ é€šå¸¸åˆ—çš„ PRIMARY KEY è®¾ç½®ä¸º ID æ•°å€¼ï¼Œä¸ AUTO_INCREMENT ä¸€èµ·ä½¿ç”¨ã€‚<br>æ¯ä¸ªè¡¨éƒ½åº”è¯¥æœ‰ä¸€ä¸ªä¸»é”®(æœ¬åˆ—ä¸º â€œidâ€ åˆ—)ï¼Œä¸»é”®å¿…é¡»åŒ…å«å”¯ä¸€çš„å€¼</li></ul><p>3ã€æ’å…¥æ•°æ®ï¼š<code>$sql=&#39;INSERT INTO table_name (column1, column2, column3,...)VALUES (value1, value2, value3,...)&#39;</code><br>4ã€æ’å…¥å¤šæ¡æ•°æ®ï¼š</p><pre class=" language-bash"><code class="language-bash"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"INSERT INTO student (column1, column2, column3,...)VALUES (value1, value2, value3,...);"</span><span class="token punctuation">;</span><span class="token variable">$sql</span>.<span class="token operator">=</span><span class="token string">"INSERT INTO student (column1, column2, column3,...)VALUES (value1, value2, value3,...);"</span><span class="token punctuation">;</span><span class="token variable">$sql</span>.<span class="token operator">=</span><span class="token string">"INSERT INTO student (column1, column2, column3,...)VALUES (value1, value2, value3,...);"</span><span class="token punctuation">;</span></code></pre><p>æ³¨æ„ï¼šsqlè¯­å¥ä¹‹é—´ç”¨;éš”å¼€</p><p>5ã€æŸ¥è¯¢æ•°æ®ï¼š<code>$sql = &#39;SELECT * FROM  myDB;&#39;</code><br>6ã€æ›´æ–°æ•°æ®ï¼š<br><code>UPDATE table_nameSET column1=value, column2=value2,...WHERE some_column=some_value</code><br>7ã€åˆ é™¤æ•°æ®ï¼š<code>DELETE FROM table_nameWHERE some_column = some_value</code></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
          <category> mySql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> mySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpåŸºç¡€</title>
      <link href="/2019/11/22/Php/base/"/>
      <url>/2019/11/22/Php/base/</url>
      
        <content type="html"><![CDATA[<h4 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h4><p>ï¼ˆå…¨ç§°ï¼šPHPï¼šHypertext Preprocessorï¼Œå³â€PHPï¼šè¶…æ–‡æœ¬é¢„å¤„ç†å™¨â€ï¼‰æ˜¯ä¸€ç§é€šç”¨å¼€æºè„šæœ¬è¯­è¨€ã€‚</p><h4 id="PHPçš„ä½œç”¨"><a href="#PHPçš„ä½œç”¨" class="headerlink" title="PHPçš„ä½œç”¨"></a>PHPçš„ä½œç”¨</h4><ul><li>PHP å¯ä»¥ç”ŸæˆåŠ¨æ€é¡µé¢å†…å®¹</li><li>PHP å¯ä»¥åˆ›å»ºã€æ‰“å¼€ã€è¯»å–ã€å†™å…¥ã€å…³é—­æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶<ul><li>PHP å¯ä»¥æ”¶é›†è¡¨å•æ•°æ®</li><li>PHP å¯ä»¥å‘é€å’Œæ¥æ”¶ cookies</li><li>PHP å¯ä»¥æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹æ‚¨çš„æ•°æ®åº“ä¸­çš„æ•°æ®</li><li>PHP å¯ä»¥é™åˆ¶ç”¨æˆ·è®¿é—®æ‚¨çš„ç½‘ç«™ä¸Šçš„ä¸€äº›é¡µé¢</li><li>PHP å¯ä»¥åŠ å¯†æ•°æ®</li></ul></li></ul><h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><pre><code>&lt;?php    $x=5;    $y=6;    $z=$x+$y;    echo $z;?&gt;</code></pre><h4 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h4><p>PHPæœ‰å››ç§ä¸åŒçš„å˜é‡ä½œç”¨åŸŸï¼š</p><ul><li>localï¼šå±€éƒ¨ä½œç”¨åŸŸã€‚åœ¨ PHP å‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡æ˜¯å±€éƒ¨å˜é‡ï¼Œä»…èƒ½åœ¨å‡½æ•°å†…éƒ¨è®¿é—®</li><li>globalï¼šå…¨å±€ä½œç”¨åŸŸã€‚åœ¨æ‰€æœ‰å‡½æ•°å¤–éƒ¨å®šä¹‰çš„å˜é‡ï¼Œæ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸã€‚é™¤äº†å‡½æ•°å¤–ï¼Œå…¨å±€å˜é‡å¯ä»¥è¢«è„šæœ¬ä¸­çš„ä»»ä½•éƒ¨åˆ†è®¿é—®ï¼Œè¦åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è®¿é—®ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œéœ€è¦ä½¿ç”¨ global å…³é”®å­—ã€‚</li><li>staticï¼šå½“ä¸€ä¸ªå‡½æ•°å®Œæˆæ—¶ï¼Œå®ƒçš„æ‰€æœ‰å˜é‡é€šå¸¸éƒ½ä¼šè¢«åˆ é™¤ã€‚ç„¶è€Œï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›æŸä¸ªå±€éƒ¨å˜é‡ä¸è¦è¢«åˆ é™¤ï¼Œå¯ä»¥ä½¿ç”¨static</li><li>parameterï¼šå‚æ•°ä½œç”¨åŸŸã€‚å‚æ•°æ˜¯é€šè¿‡è°ƒç”¨ä»£ç å°†å€¼ä¼ é€’ç»™å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚å‚æ•°æ˜¯åœ¨å‚æ•°åˆ—è¡¨ä¸­å£°æ˜çš„ï¼Œä½œä¸ºå‡½æ•°å£°æ˜çš„ä¸€éƒ¨åˆ†</li></ul><h4 id="å±€éƒ¨å’Œå…¨å±€ä½œç”¨åŸŸ"><a href="#å±€éƒ¨å’Œå…¨å±€ä½œç”¨åŸŸ" class="headerlink" title="å±€éƒ¨å’Œå…¨å±€ä½œç”¨åŸŸ"></a>å±€éƒ¨å’Œå…¨å±€ä½œç”¨åŸŸ</h4><pre><code>$x = 5;//å…¨å±€å˜é‡function test(){    global $x;//ä½¿ç”¨globalå…³é”®å­— ä½¿ç”¨å…¨å±€å˜é‡    static $n = 0;//å±€éƒ¨å˜é‡    $y = 10;//å±€éƒ¨å˜é‡    $n++;    echo &#39;x: &#39;.$x.&#39;&lt;br/&gt;&#39;;    echo &#39;y: &#39;.$y.&#39;&lt;br/&gt;&#39;;    echo $n.&#39;&lt;br /&gt;&#39;;};test();test();test();</code></pre><h4 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h4><p>å¸¸é‡å€¼è¢«å®šä¹‰åï¼Œåœ¨è„šæœ¬çš„å…¶ä»–ä»»ä½•åœ°æ–¹éƒ½ä¸èƒ½è¢«æ”¹å˜ã€‚å¸¸é‡æ˜¯ä¸€ä¸ªç®€å•å€¼çš„æ ‡è¯†ç¬¦ã€‚è¯¥å€¼åœ¨è„šæœ¬ä¸­ä¸èƒ½æ”¹å˜ã€‚<br>ä¸€ä¸ªå¸¸é‡ç”±è‹±æ–‡å­—æ¯ã€ä¸‹åˆ’çº¿ã€å’Œæ•°å­—ç»„æˆ,ä½†æ•°å­—ä¸èƒ½ä½œä¸ºé¦–å­—æ¯å‡ºç°ã€‚ (å¸¸é‡åä¸éœ€è¦åŠ  $ ä¿®é¥°ç¬¦)ã€‚<br>è®¾ç½®å¸¸é‡ï¼Œä½¿ç”¨ define() å‡½æ•°ï¼Œå‡½æ•°è¯­æ³•å¦‚ä¸‹ï¼š</p><blockquote><p>bool define ( string $name , mixed $value [, bool $case_insensitive = false ] )<br>è¯¥å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°:</p></blockquote><ul><li>nameï¼šå¿…é€‰å‚æ•°ï¼Œå¸¸é‡åç§°ï¼Œå³æ ‡å¿—ç¬¦</li><li>valueï¼šå¿…é€‰å‚æ•°ï¼Œå¸¸é‡çš„å€¼</li><li>case_insensitive ï¼šå¯é€‰å‚æ•°ï¼Œå¦‚æœè®¾ç½®ä¸º TRUEï¼Œè¯¥å¸¸é‡åˆ™å¤§å°å†™ä¸æ•æ„Ÿã€‚é»˜è®¤æ˜¯å¤§å°å†™æ•æ„Ÿçš„</li></ul><pre><code>&lt;?phpdefine(&quot;GREETING&quot;, &quot;æ¬¢è¿è®¿é—® Runoob.com&quot;);echo GREETING;    // è¾“å‡º &quot;æ¬¢è¿è®¿é—® Runoob.com&quot;echo &#39;&lt;br&gt;&#39;;echo greeting;   // è¾“å‡º &quot;greeting&quot;?&gt;</code></pre><h4 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h4><ul><li>å­—ç¬¦ä¸²</li><li>æ•´å‹ï¼šæ•´æ•°æ˜¯ä¸€ä¸ªæ²¡æœ‰å°æ•°çš„æ•°å­—</li><li>æµ®ç‚¹å‹ï¼šæµ®ç‚¹æ•°æ˜¯å¸¦å°æ•°éƒ¨åˆ†çš„æ•°å­—ï¼Œæˆ–æ˜¯æŒ‡æ•°å½¢å¼ã€‚</li><li>å¸ƒå°”å‹</li><li>æ•°ç»„</li><li>å¯¹è±¡ï¼šåœ¨ PHP ä¸­ï¼Œå¯¹è±¡å¿…é¡»å£°æ˜ã€‚é¦–å…ˆï¼Œä½ å¿…é¡»ä½¿ç”¨classå…³é”®å­—å£°æ˜ç±»å¯¹è±¡ã€‚ç±»æ˜¯å¯ä»¥åŒ…å«å±æ€§å’Œæ–¹æ³•çš„ç»“æ„ã€‚ç„¶åæˆ‘ä»¬åœ¨ç±»ä¸­å®šä¹‰æ•°æ®ç±»å‹ï¼Œç„¶ååœ¨å®ä¾‹åŒ–çš„ç±»ä¸­ä½¿ç”¨æ•°æ®ç±»å‹</li><li>NULL</li></ul>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoåšå®¢æ­å»º</title>
      <link href="/2019/11/22/Hexo/index/"/>
      <url>/2019/11/22/Hexo/index/</url>
      
        <content type="html"><![CDATA[<h4 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h4><p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚Hexo ä½¿ç”¨ Markdownï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚</p><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><ul><li><p>Nodeï¼ˆæœ¬æ–‡ä¸åšå¤šä½™å™è¿°ï¼‰</p></li><li><p>Gitï¼ˆæœ¬æ–‡ä¸åšå¤šä½™å™è¿°ï¼‰</p></li><li><p>Hexo<br><code>$ npm install -g hexo-cli</code><br>å®‰è£…å®Œæˆåï¼Œåˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰“å¼€Git Bashï¼Œæ‰§è¡Œä¸€ä¸‹å‘½ä»¤ï¼š</p><pre><code>$ hexo init &lt;folder&gt;$ cd &lt;folder&gt;$ npm install</code></pre><p>æ–°å»ºå®Œæˆä¹‹åï¼Œæ‰“å¼€æ–°å»ºçš„é¡¹ç›®ï¼ŒæŸ¥çœ‹é¡¹ç›®ç›®å½•ï¼š</p></li><li><p>publicï¼šæ‰§è¡Œhexo generateå‘½ä»¤ï¼Œç”Ÿæˆçš„HTMLé™æ€æ–‡ä»¶</p></li><li><p>scaffoldsï¼šæ¨¡ç‰ˆæ–‡ä»¶å¤¹</p></li><li><p>sourceï¼šèµ„æºæ–‡ä»¶å¤¹ï¼Œæ–‡ç« æºç ç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹çš„markdownå’Œhtmlæ–‡ä»¶å‡ä¼šè¢«hexoå¤„ç†ã€‚è¯¥é¡µé¢å¯¹åº”repoçš„æ ¹ç›®å½•ï¼Œ404æ–‡ä»¶ã€favicon.icoæ–‡ä»¶ï¼ŒCNAMEæ–‡ä»¶ç­‰éƒ½åº”è¯¥æ”¾è¿™é‡Œ</p><ul><li>_dataï¼šä½ çš„æ•°æ®æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚ï¼š<ul><li>friends.jsonï¼šå­˜æ”¾å‹æƒ…é“¾æ¥çš„æ•°æ®</li><li>musics.jsonï¼šå­˜æ”¾éŸ³ä¹æ’­æ”¾å™¨çš„æ•°æ®</li></ul></li><li>_postsï¼šæ–‡ç« å­˜æ”¾æ–‡ä»¶å¤¹</li><li>categoriesï¼šåˆ†ç±»</li><li>tagsï¼šæ ‡ç­¾<ul><li>themsï¼šä¸»é¢˜æ–‡ä»¶å¤¹ï¼ŒHexo ä¼šæ ¹æ®ä¸»é¢˜æ¥ç”Ÿæˆé™æ€é¡µé¢ã€‚ä»¥æˆ‘å½“å‰ä½¿ç”¨çš„meteryä¸»é¢˜ä¸ºä¾‹</li><li>langauagesï¼šå­˜æ”¾è¯­è¨€ç›¸å…³è®¾ç½®çš„ymlæ–‡ä»¶</li><li>layoutï¼šå­˜æ”¾æ–‡ç« çš„ejsæ¨¡ç‰ˆï¼Œå¯ä»¥åœ¨é‡Œé¢ä¿®æ”¹ç›¸å…³çš„HTMLã€CSSã€JSç­‰</li><li>sourceï¼šè¯¥ä¸»é¢˜ä¸‹ä½¿ç”¨çš„èµ„æºæ–‡ä»¶å¤¹</li><li>_config.ymlï¼šè¯¥ä¸»é¢˜çš„é…ç½®æ–‡ä»¶</li></ul></li></ul></li></ul><ul><li>_config.ymlï¼šè¯¥é¡¹ç›®çš„é…ç½®æ–‡ä»¶</li><li>db.jsonï¼šsourceè§£ææ‰€å¾—åˆ°çš„</li><li>package.jsonï¼šé¡¹ç›®æ‰€éœ€æ¨¡å—é¡¹ç›®çš„é…ç½®ä¿¡æ¯</li></ul><h4 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h4><ul><li>GitHubä¸Šæ–°å»ºä¸€ä¸ªé¡¹ç›®</li><li>æœ¬åœ°Git Bashä¸Šé…ç½®githubè´¦æˆ·ä¿¡æ¯<ul><li><code>git config --global user.name &#39;yourName&#39;</code></li><li><code>git config --global user.email &#39;yourEmail&#39;</code><ul><li>åˆ›å»ºSSH</li><li>åœ¨gitbashä¸­è¾“å…¥ï¼š</li><li><code>ssh-keygen -t rsa -C &quot;youremail@example.com</code>ï¼Œç”Ÿæˆsshã€‚</li><li><code>cd ~/.ssh</code> æ‰¾åˆ°id_rsa.pub</li><li><code>cat id_rsa.pub</code>å¤åˆ¶å…¶ä¸­çš„å†…å®¹åˆ°githubä¸Šï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ SSH KEY</li></ul></li></ul></li></ul><ul><li>ä¿®æ”¹_config.yml<pre><code>deploy:type: gitrepo: https://github.com/YourgithubName/YourgithubName.github.io.gitbranch: master</code></pre></li><li>å›åˆ°Git Bash<pre><code>npm i hexo-serverhexo cleanhexo generatehexo server</code></pre></li><li>ä¸Šä¼ åˆ°GitHub<pre><code>npm install hexo-deployer-git --savehexo cleanhexo generatehexo deploy</code></pre>æ³¨æ„deployçš„è¿‡ç¨‹ä¸­è¦è¾“å…¥ä½ çš„usernameåŠpasswardã€‚<br>ç„¶ååœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <a href="http://yourgithubname.github.io" target="_blank" rel="noopener">http://yourgithubname.github.io</a> å°±å¯ä»¥çœ‹åˆ°ä½ çš„ä¸ªäººåšå®¢ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾</title>
      <link href="/2019/11/21/JavaScript/ScopeChain/"/>
      <url>/2019/11/21/JavaScript/ScopeChain/</url>
      
        <content type="html"><![CDATA[<h4 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h4><p>åœ¨JavaScriptä¸­çš„ä½œç”¨åŸŸæœ‰<strong><em>å…¨å±€ä½œç”¨åŸŸ</em></strong>ã€<strong><em>å±€éƒ¨ä½œç”¨åŸŸ</em></strong>ï¼ˆåœ¨JavaScriptä¸­å±€éƒ¨ä½œç”¨åŸŸå³æ˜¯<strong><em>å‡½æ•°ä½œç”¨åŸŸ</em></strong>ï¼‰ä»¥åŠ<strong><em>å—çº§ä½œç”¨åŸŸ</em></strong>ã€‚</p><ul><li><p>å…¨å±€ä½œç”¨åŸŸï¼šåœ¨æœ€å¤–å±‚å‡½æ•°å®šä¹‰çš„å˜é‡å³æ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸï¼Œå¯¹äºä»»æ„å‡½æ•°æ¥è¯´ï¼Œéƒ½å¯ä»¥è®¿é—®åˆ°ã€‚ä¾‹å¦‚ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//1</span>  <span class="token punctuation">}</span>  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre></li></ul><ul><li><p>å±€éƒ¨ä½œç”¨åŸŸï¼šå’Œå…¨å±€ä½œç”¨åŸŸç›¸åï¼Œå±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡å³æ˜¯åœ¨ç‰¹å®šä»£ç å—ä¸­æ‰èƒ½è¿‡è®¿é—®ï¼Œå¯¹äºå¤–éƒ¨æ˜¯ä¸èƒ½å¤Ÿè®¿é—®çš„ã€‚æ³¨æ„ï¼šåœ¨å‡½æ•°å†…éƒ¨å®šä¹‰å˜é‡çš„æ—¶å€™ï¼Œå¦‚æœä¸ç”¨varï¼Œé‚£ä¹ˆä½ å£°æ˜çš„å°±æ˜¯å…¨å±€å˜é‡äº†ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//1</span>  <span class="token punctuation">}</span>  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//b is not defined</span><span class="token punctuation">}</span></code></pre></li><li><p>å—çº§ä½œç”¨åŸŸï¼šåœ¨ä»£ç å—ä¸­ä½¿ç”¨<strong><em>let</em></strong>å®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨å½“å‰ä»£ç å—ä¸­è¿›è¡Œè®¿é—®ã€‚å—çº§ä½œç”¨åŸŸå¯ä»¥å½¢æˆæš‚æ—¶æ€§æ­»åŒºã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//1-9</span>  <span class="token punctuation">}</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//undefined</span><span class="token punctuation">}</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li></ul><h4 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h4><p>ä¸ªäººç†è§£ï¼Œä½œç”¨åŸŸå°±æ˜¯åœ¨å‡½æ•°å†…éƒ¨å¯ä»¥è®¿é—®å¤–éƒ¨å˜é‡çš„æœºåˆ¶ï¼Œä½¿ç”¨é“¾å¼æŸ¥æ‰¾å“ªäº›å˜é‡å¯ä»¥è¢«å‡½æ•°å†…éƒ¨è®¿é—®ã€‚è¯´èµ·ä½œç”¨åŸŸé“¾ï¼Œé‚£ä¹ˆä¸å¾—ä¸è¯´<strong><em>æ‰§è¡Œç¯å¢ƒ</em></strong>äº†ã€‚</p><h4 id="æ‰§è¡Œç¯å¢ƒï¼ˆExecution-Contextï¼‰"><a href="#æ‰§è¡Œç¯å¢ƒï¼ˆExecution-Contextï¼‰" class="headerlink" title="æ‰§è¡Œç¯å¢ƒï¼ˆExecution Contextï¼‰"></a>æ‰§è¡Œç¯å¢ƒï¼ˆExecution Contextï¼‰</h4><p>ECæ˜¯JavaScriptä¸­ä¸€ä¸ªæœ€ä¸ºé‡è¦çš„æ¦‚å¿µã€‚ECå®šä¹‰äº†å˜é‡å’Œå‡½æ•°æœ‰æƒè®¿é—®çš„å…¶ä»–æ•°æ®ã€‚JavaScriptä¸­ï¼Œå‡½æ•°åœ¨è¿è¡Œæ—¶éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ‰§è¡Œç¯å¢ƒï¼Œå¹¶ä¸”JSå¼•æ“è¿˜ä¼šäº§ç”Ÿä¸€ä¸ªä¸å½“å‰ECç›¸å…³è”çš„<strong><em>å˜é‡å¯¹è±¡</em></strong>ï¼ˆVariable Objectï¼Œå³VOï¼‰ã€‚ECä¸­æ‰€æœ‰å®šä¹‰çš„å˜é‡å’Œæ–¹æ³•éƒ½åŒ…å«åœ¨VOä¸­ã€‚å…¨å±€æ‰§è¡Œç¯å¢ƒæ˜¯æœ€å¤–å›´çš„æ‰§è¡Œç¯å¢ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªâ€œå…œåº•â€çš„æ‰§è¡Œç¯å¢ƒã€‚</p><p>JSå¼•æ“åœ¨è¿›å…¥ä¸€æ®µå¯æ‰§è¡Œçš„ä»£ç æ—¶ï¼Œéœ€è¦å®Œæˆä»¥ä¸‹ä¸‰ä¸ªåˆå§‹åŒ–å·¥ä½œï¼š</p><p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª<strong><em>å…¨å±€å¯¹è±¡</em></strong>(Global Objectï¼Œå³GO)ï¼Œå°†Mathã€Stringã€Dataç­‰å¸¸ç”¨çš„jså¯¹è±¡ä½œä¸ºå…¶å±æ€§ï¼Œä½†æ˜¯è¿™ä¸ªGOåœ¨å…¨å±€æ˜¯ä¸å¯è§çš„ï¼Œä¸å¯ç›´æ¥è®¿é—®çš„ã€‚å› æ­¤å®ƒè¿˜æœ‰å¦å¤–ä¸€ä¸ªå±æ€§windowï¼Œå¹¶å°†windowæŒ‡å‘äº†è‡ªèº«ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å…¨å±€é€šè¿‡è®¿é—®windowï¼Œæ¥è®¿é—®GOçš„å±æ€§å’Œæ–¹æ³•äº†ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> globalObject <span class="token operator">=</span> <span class="token punctuation">{</span>  Math<span class="token punctuation">,</span>  String<span class="token punctuation">,</span>  Data<span class="token punctuation">,</span>  Function<span class="token punctuation">,</span>  <span class="token operator">...</span>  window<span class="token punctuation">:</span><span class="token keyword">this</span><span class="token punctuation">}</span></code></pre><p>å…¶æ¬¡ï¼ŒJSå¼•æ“ä¼šåˆ›å»ºä¸€ä¸ª<strong><em>æ‰§è¡Œç¯å¢ƒæ ˆ</em></strong>ï¼ˆExecution Context Stack å³ECSï¼‰ï¼Œä¸æ­¤åŒæ—¶è¿˜ä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€ç¯å¢ƒECã€‚å½“JSçš„æ‰§è¡Œæµæ‰§è¡Œåˆ°ä¸€ä¸ªå‡½æ•°æ—¶ï¼ŒJSå¼•æ“å°±ä¼šæŠŠè¯¥å‡½æ•°çš„ECæ¨åˆ°ECSä¸­ï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œä¹‹åï¼Œå†æŠŠECä»ECSä¸­å¼¹å‡ºï¼Œå°†æ‰§è¡Œæµçš„æ§åˆ¶æƒäº¤è¿˜ç»™ä¸Šä¸€å±‚çš„ECã€‚ECMAScriptçš„æ‰§è¡Œæµå°±æ˜¯ç”±è¿™ç§æœºåˆ¶æ§åˆ¶ç€ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> ecStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰§è¡Œåˆ°å‡½æ•°fn</span>ecStock<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>EC<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰§è¡Œå®Œfn</span>ecStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span>EC<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æœ€åï¼ŒJSå¼•æ“ä¼šåˆ›é€ ä¸€ä¸ªå’ŒECç›¸å…³è¿çš„å˜é‡å¯¹è±¡VOã€‚å¦‚æœè¿™ä¸ªç¯å¢ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™å°†å…¶<strong><em>æ´»åŠ¨å¯¹è±¡</em></strong>ï¼ˆAction Objectï¼Œå³AOï¼‰ä½œä¸ºå…¶å˜é‡å¯¹è±¡ã€‚åˆå§‹æ—¶AOåªåŒ…å«ä¸€ä¸ªå˜é‡ï¼Œå³argumentsã€‚ä½œç”¨åŸŸé“¾çš„ä¸‹ä¸€ä¸ªå˜é‡å¯¹è±¡æ¥è‡ªäºå¤–éƒ¨åŒ…å«ç¯å¢ƒï¼Œè€Œä¸‹ä¸€ä¸ªå˜é‡å¯¹è±¡æ¥è‡ªä¸‹ä¸€ä¸ªåŒ…å«ç¯å¢ƒï¼Œè¿™æ ·ä¸€ç›´å»¶ä¼¸åˆ°å…¨å±€ç¯å¢ƒã€‚å…¨å±€å˜é‡å¯¹è±¡ï¼ˆGOï¼‰å§‹ç»ˆéƒ½æ˜¯ä½œç”¨åŸŸé“¾çš„æœ€åä¸€ä¸ªå¯¹è±¡ã€‚</p><p>æ¯ä¸€ä¸ªå‡½æ•°åœ¨å®šä¹‰çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªä¸ä¹‹å…³è”çš„<strong><em>[[scopes]]</em></strong>å±æ€§ï¼Œè¯¥scopeæ€»æ˜¯æŒ‡å‘å®šä¹‰å‡½æ•°æ—¶çš„æ‰§è¡Œç¯å¢ƒECã€‚ä¸¾ä¸ªğŸŒ°ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="http://cdn.yangkunxiao.cn/xv64Ki.png" alt="scopes"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå‡½æ•°fnçš„[[scopes]][0]å³æ˜¯å®ƒçš„æ‰§è¡Œç¯å¢ƒï¼ŒGOã€‚</p><p>å†çœ‹ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">var</span> b <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span></code></pre><p><img src="http://cdn.yangkunxiao.cn/KL9FAg.png" alt="scopes"></p><p>fnä¸­å§‹ç»ˆéƒ½æ²¡æœ‰å®šä¹‰å˜é‡aï¼Œé‚£ä¹ˆJSå¼•æ“å°±ä¼šæ²¿ç€Scope Chainä¸€ç›´å‘ä¸Šå¯»æ‰¾aï¼Œæœ€ç»ˆåœ¨GOä¸­æ‰¾åˆ°äº†aã€‚</p><h4 id="ä½œç”¨åŸŸé“¾-1"><a href="#ä½œç”¨åŸŸé“¾-1" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h4><p>å½“JavaScriptçš„ä»£ç å—åœ¨è¿è¡Œæ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸ä¹‹ç›¸å…³çš„ä½œç”¨åŸŸé“¾ã€‚</p><blockquote><p>ä½œç”¨åŸŸé“¾çš„ä½œç”¨å°±æ˜¯ä¿è¯å½“å‰ç¯å¢ƒå¯¹å…¶æœ‰æƒè®¿é—®çš„å˜é‡å’Œæ–¹æ³•è¿›è¡Œæœ‰åºçš„è®¿é—® â€”â€”JavaScripté«˜çº§ç¨‹åºè®¾è®¡</p></blockquote><p>ä½œç”¨åŸŸé“¾çš„å‰ç«¯ï¼ˆä¹Ÿå°±æ˜¯å¼€å¤´ï¼‰å°±æ˜¯å½“å‰æ‰§è¡Œç¯å¢ƒECçš„å˜é‡å¯¹è±¡ï¼Œå®ƒçš„å˜é‡å¯¹è±¡æ¥è‡ªäºå®ƒçš„å¤–éƒ¨åŒ…å«ç¯å¢ƒï¼Œå†ä¸‹ä¸€ä¸ªå˜é‡å¯¹è±¡åŒæ—¶ä¹Ÿæ¥è‡ªå†ä¸‹ä¸€ä¸ªå¤–éƒ¨åŒ…å«ç¯å¢ƒï¼Œè¿™æ ·ä¸€ç›´å»¶ä¼¸åˆ°å…¨å±€æ‰§è¡Œç¯å¢ƒï¼ŒåŒæ—¶ï¼ŒGOä¹Ÿæ˜¯ä½œç”¨åŸŸé“¾çš„æœ€åä¸€ä¸ªå¯¹è±¡ã€‚</p><h4 id="æ ‡è¯†ç¬¦è§£æ"><a href="#æ ‡è¯†ç¬¦è§£æ" class="headerlink" title="æ ‡è¯†ç¬¦è§£æ"></a>æ ‡è¯†ç¬¦è§£æ</h4><p>å½“åœ¨æŸä¸ªç¯å¢ƒä¸­ä¸ºäº†è¯»å–æˆ–å†™å…¥ä»è€Œå¼•å…¥ä¸€ä¸ªæ ‡è¯†ç¬¦æ—¶ï¼Œå¿…é¡»é€šè¿‡æœç´¢æ¥ç¡®å®šè¯¥æ ‡è¯†ç¬¦ä»£è¡¨äº†ä»€ä¹ˆã€‚æœç´¢è¿‡ç¨‹ä»å½“æœŸä½œç”¨åŸŸé“¾çš„å‰ç«¯å¼€å§‹ï¼Œå‘ä¸Šé€çº§æœç´¢ï¼Œå¦‚æœåœ¨å±€éƒ¨ç¯å¢ƒä¸­æŸ¥æ‰¾åˆ°äº†è¯¥æ ‡è¯†ç¬¦çš„å®šä¹‰ï¼Œåˆ™åœæ­¢æœç´¢â€˜å¦åˆ™å°†ä¸€ç›´æ²¿ç€ä½œç”¨åŸŸé“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°GOä¸Šã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</p><h4 id="å»¶é•¿ä½œç”¨åŸŸ"><a href="#å»¶é•¿ä½œç”¨åŸŸ" class="headerlink" title="å»¶é•¿ä½œç”¨åŸŸ"></a>å»¶é•¿ä½œç”¨åŸŸ</h4><p>è™½ç„¶ä½œç”¨åŸŸåªæœ‰ä¸¤ç§ï¼šå…¨å±€å’Œå±€éƒ¨ï¼ˆå‡½æ•°ï¼‰ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å…¶ä»–åŠæ³•å¯ä»¥ç”¨æ¥å»¶é•¿ä½œç”¨åŸŸé“¾ã€‚å…¶ä¸»è¦æ€è·¯å°±æ˜¯ï¼šæœ‰äº›è¯­å¥å¯ä»¥åœ¨ä½œç”¨åŸŸé“¾çš„å‰ç«¯ä¸´æ—¶å¢åŠ ä¸€ä¸ªå˜é‡å¯¹è±¡ï¼Œè¯¥å˜é‡å¯¹è±¡åœ¨ä»£ç æ‰§è¡Œåå°±è¢«é”€æ¯ã€‚</p><p>1ã€try-catchè¯­å¥çš„catchå—</p><p>2ã€withè¯­å¥</p><h4 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h4><p>ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿä¸ªäººç†è§£å°±æ˜¯ç”±äºå‡½æ•°çš„åµŒå¥—ï¼Œå¹¶ä¸”å¯¹å¤–æä¾›è®¿é—®æ¥å£å°±ä¼šäº§ç”Ÿé—­åŒ…ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> b  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//2</span></code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå‡½æ•°fnæ‰§è¡Œå®Œä¹‹åï¼Œåº”è¯¥<strong><em>JSçš„åƒåœ¾å›æ”¶æœºåˆ¶</em></strong>è¢«æ ‡è®°â€œç­‰å¾…æ¸…é™¤â€ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æœºåˆ¶æ‰§è¡Œçš„æ—¶å€™è¢«æ¸…é™¤ï¼Œä½†æ˜¯ç”±äºè¿”å›å‡½æ•°ä¸­å¼•ç”¨äº†fnä¸­çš„å˜é‡bï¼Œæ‰€ä»¥å‡½æ•°fnå¹¶ä¸ä¼šè¢«æ¸…é™¤ï¼Œè€Œæ˜¯ä¸€ç›´ä¿å­˜ç€å†…å­˜ä¸­ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•å¼•ç”¨ï¼Œæ‰ä¼šè¢«æ¸…é™¤ã€‚</p><p>ä»ä¸Šé¢çš„ğŸŒ°æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œé—­åŒ…æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><ul><li>é—­åŒ…å¯ä»¥ä½¿å¾—ç¨‹åºåœ¨å‡½æ•°å¤–éƒ¨å¯ä»¥è®¿é—®åˆ°å‡½æ•°å†…éƒ¨çš„å˜é‡</li><li>é—­åŒ…å¯ä»¥åœ¨å†…å­˜ä¸­ç»´æŒä¸€ä¸ªå˜é‡</li></ul><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token keyword">return</span> i    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>    <span class="token keyword">return</span> array<span class="token punctuation">}</span><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//10</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//10</span></code></pre><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœŸå¾…çš„ç»“æœå°±æ˜¯è¿”å›0å’Œ1,ä½†æ˜¯ç»“æœå‡ºäººæ„æ–™ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å…¶å®æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸‹arr[0]æ‰§è¡Œæ—¶ï¼Œå®ƒçš„scope chainï¼š</p><p><img src="http://cdn.yangkunxiao.cn/r0f77m.png" alt="scopes"></p><p>æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œæ­¤æ—¶arr[0]ä¸­å¹¶æ²¡æœ‰içš„å®šä¹‰ï¼Œå®ƒä¼šæ²¿ç€ä½œç”¨åŸŸé“¾å‘ä¸Šæ‰¾iï¼Œé‚£ä¹ˆå°±ä¼šæ‰¾åˆ°fnä¸­çš„iï¼Œä½†æ˜¯æ­¤æ—¶ï¼Œiå·²ç»å˜æˆ10äº†ã€‚</p><p>ä»æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š</p><blockquote><p>JSçš„å‡½æ•°ä¸­çš„å˜é‡çš„å€¼ä¸æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™ç¡®å®šçš„ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶å†å»å¯»æ‰¾çš„ã€‚</p></blockquote><p>å¦‚æœæˆ‘ä»¬æƒ³è®©ä¸Šé¢çš„ğŸŒ°æŒ‰ç…§æˆ‘ä»¬é¢„æœŸçš„æ‰§è¡Œï¼Œé‚£ä¹ˆè€ƒè™‘ä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å‡½æ•°å‚æ•°çš„ä¼ é€’æ˜¯æŒ‰å€¼ä¼ é€’ï¼Œä¼šåˆ›å»ºiçš„å‰¯æœ¬ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨å˜é‡i</span>      <span class="token keyword">return</span> num    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> array<span class="token punctuation">}</span><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨åŸç”ŸJavaScriptå®ç°callã€applyå’Œbind</title>
      <link href="/2019/11/21/JavaScript/this/"/>
      <url>/2019/11/21/JavaScript/this/</url>
      
        <content type="html"><![CDATA[<h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>åœ¨JavaScriptä¸­thisçš„æŒ‡å‘é—®é¢˜ä¸­æåˆ°ï¼Œä½œä¸ºå¯¹è±¡æ–¹æ³•çš„è°ƒç”¨ã€‚å‡½æ•°è¿˜å¯ä»¥ä½œä¸ºæŸä¸ªå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ï¼Œè¿™æ—¶thiså°±æŒ‡è¿™ä¸ªä¸Šçº§å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶è¯´çš„ï¼Œè°è°ƒç”¨ï¼Œthiså°±æŒ‡å‘è°ã€‚</p><blockquote><p>å®ç°æ–¹æ³•ï¼šåœ¨ä¼ å…¥çš„å‚æ•°ä¸­ä¼ å…¥ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶åæ‰§è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œæœ€ååˆ é™¤è¯¥æ–¹æ³•ï¼ˆä¸ºäº†ä¿æŒå¯¹è±¡çš„å‰åä¸€è‡´æ€§ï¼‰ã€‚</p></blockquote><h4 id="call"><a href="#call" class="headerlink" title="call"></a>call</h4><pre class=" language-bash"><code class="language-bash">var obj <span class="token operator">=</span> <span class="token punctuation">{</span>    age <span class="token punctuation">;</span> 10<span class="token punctuation">}</span>var fn <span class="token operator">=</span> function<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    this.value <span class="token operator">=</span> 100<span class="token punctuation">;</span><span class="token punctuation">}</span>/**å°†newCallç»‘å®šåœ¨Functionçš„åŸå‹ä¸Š context:ä¸Šä¸‹æ–‡ å³this<span class="token punctuation">..</span>.rest ES6è¯­æ³•ç³– ç”¨æ¥å–ä»£arguments*/Function.prototype.newCall <span class="token operator">=</span> function<span class="token punctuation">(</span>context,<span class="token punctuation">..</span>.rest<span class="token punctuation">)</span><span class="token punctuation">{</span>    if<span class="token punctuation">(</span> context instanceof Object <span class="token punctuation">)</span><span class="token punctuation">{</span>        context <span class="token operator">=</span> context <span class="token operator">||</span> window<span class="token punctuation">;</span>    <span class="token punctuation">}</span>else<span class="token punctuation">{</span>        context <span class="token operator">=</span> Object.create<span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    //ä½¿ç”¨symbal é¿å…åŸæ¥çš„contextä¸Šæœ‰å‡½æ•°fn    const fn <span class="token operator">=</span> Symbal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> this<span class="token punctuation">;</span>//æ­¤æ—¶this è°è°ƒç”¨ æŒ‡å‘è°    context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">..</span>.rest<span class="token punctuation">)</span><span class="token punctuation">;</span>//context è°ƒç”¨fn,æ”¹å˜thisæŒ‡å‘    delete context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">;</span>//åˆ é™¤fnå±æ€§ ä¿æŒåŸå¯¹è±¡çš„ç»Ÿä¸€<span class="token punctuation">}</span>var fun <span class="token operator">=</span> function<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console.log<span class="token punctuation">(</span>this.age<span class="token punctuation">)</span><span class="token punctuation">;</span>//10    // fn.newCall<span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>    //console.log<span class="token punctuation">(</span>this.value<span class="token punctuation">)</span><span class="token punctuation">;</span> 100<span class="token punctuation">}</span>fun.newCall<span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h4><p>å’Œcallç±»ä¼¼ï¼Œåªæ˜¯ä¼ å‚çš„ä¸åŒï¼Œä¸å¤šè¯´ ï¼Œç›´æ¥ä¸Šä»£ç ï¼š </p><pre class=" language-bash"><code class="language-bash">Function.prototype.newCall <span class="token operator">=</span> function<span class="token punctuation">(</span>context,parames<span class="token punctuation">)</span><span class="token punctuation">{</span>    if<span class="token punctuation">(</span> context instanceof Object <span class="token punctuation">)</span><span class="token punctuation">{</span>        context <span class="token operator">=</span> context <span class="token operator">||</span> window<span class="token punctuation">;</span>    <span class="token punctuation">}</span>else<span class="token punctuation">{</span>        context <span class="token operator">=</span> Object.create<span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    //ä½¿ç”¨symbal é¿å…åŸæ¥çš„contextä¸Šæœ‰å‡½æ•°fn    const fn <span class="token operator">=</span> Symbal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span> <span class="token operator">=</span> this<span class="token punctuation">;</span>//æ­¤æ—¶this è°è°ƒç”¨ æŒ‡å‘è°    context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span>parames<span class="token punctuation">)</span><span class="token punctuation">;</span>//context è°ƒç”¨fn,æ”¹å˜thisæŒ‡å‘    delete context<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">;</span>//åˆ é™¤fnå±æ€§ ä¿æŒåŸå¯¹è±¡çš„ç»Ÿä¸€<span class="token punctuation">}</span></code></pre><h4 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h4><p>bindå’Œcallã€applyçš„åŒºåˆ«ï¼Œè¿™é‡Œä¸å†å¤šåšèµ˜è¿°ã€‚ç›´æ¥ä¸Šä»£ç ï¼š</p><pre class=" language-bash"><code class="language-bash">Function.prototype.bind <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>context,<span class="token punctuation">..</span>.innerArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>  var self <span class="token operator">=</span> this  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">..</span>.finnalyArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> self.call<span class="token punctuation">(</span>context,<span class="token punctuation">..</span>.innerArgs,<span class="token punctuation">..</span>.finnalyArgs<span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptåŸå‹ã€åŸå‹é“¾å’Œç»§æ‰¿</title>
      <link href="/2019/11/21/JavaScript/prototype/"/>
      <url>/2019/11/21/JavaScript/prototype/</url>
      
        <content type="html"><![CDATA[<h4 id="åŸå‹å¯¹è±¡"><a href="#åŸå‹å¯¹è±¡" class="headerlink" title="åŸå‹å¯¹è±¡"></a>åŸå‹å¯¹è±¡</h4><p>æ— è®ºæˆ‘ä»¬ä»€ä¹ˆæ—¶å€™åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå®ƒéƒ½ä¼šæœ‰ä¸€ä¸ªå±æ€§prototypeï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒæŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œè¯¥åŸå‹å¯¹è±¡æ‰€æ‹¥æœ‰çš„å±æ€§å’Œæ–¹æ³•éƒ½å¯è¢«å‡½æ•°çš„å®ä¾‹æ‰€å…±äº«ã€‚ä¸¾ä¸ªğŸŒ°ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">;</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>todo <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'todo'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> newFn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//æŸ¥çœ‹fnæ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newFn<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//'a'</span>newFn<span class="token punctuation">.</span><span class="token function">todo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ‰€æœ‰çš„åŸå‹å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨æ‹¥æœ‰ä¸€ä¸ªå±æ€§constructor(æ„é€ å‡½æ•°)ï¼Œè¿™ä¸ªå±æ€§åŒ…å«ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆã€‚å³ï¼š</p><pre class=" language-javascript"><code class="language-javascript">fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> fn<span class="token punctuation">;</span></code></pre><blockquote><p>å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ˆå†…éƒ¨å±æ€§ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚ECMA-262ç¬¬5ç‰ˆä¸­ç®¡è¿™ä¸ªæŒ‡é’ˆå«[[Prototype]]ã€‚è™½ç„¶åœ¨è„šæœ¬ä¸­æ²¡æœ‰æ ‡å‡†çš„æ–¹å¼è®¿é—®[[Prototype]]ï¼Œä½†Firefoxã€Safariå’ŒChromeåœ¨æ¯ä¸ªå¯¹è±¡ä¸Šéƒ½æ”¯æŒä¸€ä¸ªå±æ€§__proto__ï¼›è€Œåœ¨å…¶ä»–å®ç°ä¸­ï¼Œè¿™ä¸ªå±æ€§å¯¹è„šæœ¬åˆ™æ˜¯å®Œå…¨ä¸å¯è§çš„ã€‚â€”â€”JavaScripté«˜çº§ç¨‹åºè®¾è®¡</p></blockquote><p><img src="http://cdn.yangkunxiao.cn/prototype.png" alt=""></p><p>è¯¥å±æ€§æ˜¯å®ä¾‹å’Œæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´çš„è”ç³»ï¼Œå’Œæ„é€ å‡½æ•°å¹¶æ— ç›´æ¥å…³è”ï¼Œå…¶å®å®ä¾‹ä¹‹æ‰€ä»¥å¯ä»¥è°ƒç”¨æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šé¢çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¹Ÿæ˜¯é€šè¿‡è¯¥å±æ€§å®ç°çš„ã€‚</p><p>å°ç»“ï¼š</p><ul><li>æ‰€æœ‰çš„å¼•ç”¨ç±»å‹éƒ½å¯ä»¥è‡ªç”±çš„æ‰©å±•å…¶å±æ€§ï¼ˆé™¤nullï¼‰</li><li>æ‰€æœ‰çš„å¼•ç”¨ç±»å‹éƒ½æœ‰_proto_å±æ€§ï¼ˆé™¤nullï¼‰</li><li>æ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰prototypeå±æ€§</li><li>æ‰€æœ‰çš„å¼•ç”¨ç±»å‹çš„_proto_éƒ½æŒ‡å‘å®ƒä»¬çš„æ„é€ å‡½æ•°çš„prototype</li><li>å½“å¯»æ‰¾ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§æ—¶ï¼Œå¦‚æœåœ¨å½“å‰å¯¹è±¡æ‰¾ä¸åˆ°è¯¥å±æ€§çš„å®šä¹‰ï¼Œå°±ä¼šæ²¿ç€_proro_ä¸€ç›´å‘ä¸Šå¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢æˆ–è€…æ‰¾åˆ°Object.prototype(å³null)ä¸ºæ­¢ã€‚</li></ul><p>æ³¨æ„ï¼šå¤§å®¶å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œå‡½æ•°æ—¢æœ‰prototypeå±æ€§ï¼Œä¹Ÿæœ‰_proto_å±æ€§ã€‚ä¸‹é¢å°±é’ˆå¯¹å‡½æ•°åšä¸€ä¸ªè§£é‡Šï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> Fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>Fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'yellow'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>Fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>todo <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'todo'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> fn1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>fn1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//Fn.prototype</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>fn1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//Object.prototye</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>fn1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//null</span></code></pre><blockquote><p>è¯·è®°ä½ï¼šä¸‡ç‰©çš†å¯¹è±¡ã€‚ä¸€åˆ‡å¼•ç”¨ç±»å‹éƒ½æœ‰ä¸€ä¸ªéšå¼åŸå‹Object.prototypeã€‚</p></blockquote><p><img src="http://cdn.yangkunxiao.cn/scopeChain.jpeg" alt="åŸå‹é“¾"></p><h4 id="åŸå‹å¯¹è±¡çš„é—®é¢˜"><a href="#åŸå‹å¯¹è±¡çš„é—®é¢˜" class="headerlink" title="åŸå‹å¯¹è±¡çš„é—®é¢˜"></a>åŸå‹å¯¹è±¡çš„é—®é¢˜</h4><p>åŸå‹å¯¹è±¡æœ€å¤§çš„é—®é¢˜å°±æ˜¯å› å…¶å…±äº«æ€§æ‰€å¯¼è‡´çš„ã€‚çœ‹ä¸ªğŸŒ°ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//åŸå‹</span><span class="token keyword">var</span> Fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>Fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'yellow'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>Fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>todo <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'todo'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> fn1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fn1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> fn2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ["red", "yellow", "blue"]</span></code></pre><h4 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åŸå‹å¯¹è±¡"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åŸå‹å¯¹è±¡" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åŸå‹å¯¹è±¡"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åŸå‹å¯¹è±¡</h4><p>é¦–å…ˆï¼Œçœ‹ä¸€æ®µä»£ç ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//æ–°å»ºä¸€ä¸ªæ„é€ å‡½æ•° </span><span class="token keyword">var</span> Person <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'drink'</span><span class="token punctuation">)</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>eat <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'eat'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>person<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«åœ¨Personå’ŒPerson.prototyeä¸ŠæŒ‚è½½äº† eat å’Œ drink å‡½æ•°ï¼Œç„¶åä½¿ç”¨ new å…³é”®å­—å¯¹æ„é€ å‡½æ•° Person è¿›è¡Œäº†å®ä¾‹åŒ–ã€‚</p><p>å¯¹äº drink å‡½æ•°ï¼šæ¯è¿›è¡Œä¸€æ¬¡å®ä¾‹åŒ–ï¼Œéƒ½è¦é‡æ–°åœ¨å†…å­˜ä¸­å ç”¨ä¸€äº›èµ„æºã€‚</p><p>å¯¹äº eat å‡½æ•°ï¼šæˆ‘ä»¬å°† eat å‡½æ•°æŒ‚è½½åœ¨ Person çš„åŸå‹ä¸Šï¼ŒPerson çš„å®ä¾‹æ¯æ¬¡åªéœ€è¦è°ƒç”¨åŸå‹ä¸Šçš„æ–¹æ³•å³å¯ï¼ŒèŠ‚çº¦äº†å†…å­˜å ç”¨ã€‚</p><h4 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h4><p>ECMAScriptä¸­å®ç°ç»§æ‰¿çš„ä¸»è¦å°±æ˜¯ä¾é åŸå‹é“¾æ¥å®ç°çš„ã€‚</p><h4 id="åŸå‹é“¾ç»§æ‰¿"><a href="#åŸå‹é“¾ç»§æ‰¿" class="headerlink" title="åŸå‹é“¾ç»§æ‰¿"></a>åŸå‹é“¾ç»§æ‰¿</h4><p>æœ€ä¸ºECMAScriptæœ€ä¸»è¦çš„ç»§æ‰¿æ–¹æ³•ï¼Œå…¶åŸºæœ¬æ€æƒ³å°±æ˜¯è®©ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§æ‰¿å¦ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ã€‚åœ¨ä¸Šé¢æˆ‘ä»¬è¯´è¿‡ï¼Œæ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆconstructorï¼Œæ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½å¯ä»¥ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œæ¯ä¸€ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ_proto_ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> Fn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">var</span> Test <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Fn<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Fn<span class="token punctuation">;</span>fn<span class="token punctuation">.</span>_proto_ <span class="token operator">=</span><span class="token operator">></span> Fn<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span></code></pre><p>å¦‚æœæ­¤æ—¶æˆ‘ä»¬è®©ä¸€ä¸ªFnçš„åŸå‹å¯¹è±¡æŒ‡å‘å¦ä¸€ä¸ªç±»å‹çš„å®ä¾‹å‘¢ï¼Ÿ</p><pre><code>Fn.prototype = new Test();</code></pre><p>é‚£ä¹ˆæ­¤æ—¶ï¼ŒåŸå‹å¯¹è±¡å°±ä¼šæœ‰ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªåŸå‹çš„æŒ‡é’ˆï¼Œå¦ä¸€ä¸ªåŸå‹ä¹Ÿä¼šåŒ…å«ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„æŒ‡é’ˆã€‚å¦‚æ­¤å±‚å±‚é€’è¿›ï¼Œå³æ„æˆäº†åŸå‹é“¾ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span>SuperType<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>Fun <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//ç»§æ‰¿äº†SuperType</span>SubType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">alert</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//"red,blue,green,black"</span><span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">alert</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//"red,blue,green,black"</span></code></pre><blockquote><p>ä¼˜ç‚¹ï¼šå¯ä»¥é€šè¿‡ instanceOf å’Œ isPrototypeOf æ£€æµ‹</p><p>ç¼ºç‚¹ï¼š</p><p>1ã€çˆ¶ç±»å‹ä¸­çš„ç§æœ‰å±æ€§ä¼šå˜ä¸ºå­ç±»å‹ä¸­çš„å…¬æœ‰å±æ€§</p><p>2ã€åˆ›å»ºå­ç±»å‹çš„æ—¶å€™ï¼Œä¸èƒ½åƒçˆ¶ç±»å‹çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’å‚æ•°ã€‚</p></blockquote><h4 id="æ„é€ å‡½æ•°ç»§æ‰¿"><a href="#æ„é€ å‡½æ•°ç»§æ‰¿" class="headerlink" title="æ„é€ å‡½æ•°ç»§æ‰¿"></a>æ„é€ å‡½æ•°ç»§æ‰¿</h4><blockquote><p>JavaScriptè§„å®šï¼Œæ¯ä¸€ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­çš„æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•éƒ½ä¼šè¢«æ„é€ å‡½æ•°çš„å®ä¾‹æ‰€ç»§æ‰¿ã€‚</p></blockquote><p>æ„é€ å‡½æ•°çš„ç»§æ‰¿æ˜¯é€šè¿‡newå…³é”®å­—ï¼Œç”Ÿæˆå®ä¾‹å®Œæˆçš„ã€‚ä½¿ç”¨newå…³é”®å­—ç”Ÿæˆå®ä¾‹çš„è¿‡ç¨‹ä¸­ï¼Œå°±ä¼šæŠŠthisç»‘å®šåˆ°å®ä¾‹ä¸Šï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>åœ¨å†…å­˜ä¸­å…ˆç”Ÿæˆä¸€ä¸ªobjectçš„å®ä¾‹å¯¹è±¡ï¼Œ</p></li><li><p>å°†å®ä¾‹å¯¹è±¡çš„_proto_æŒ‡å‘æ„é€ å‡½æ•°çš„prototypeï¼ˆå³æ„é€ å‡½æ•°çš„åŸå‹ï¼‰ï¼Œ</p></li><li><p>è¿è¡Œæ„é€ å‡½æ•°ï¼Œ</p></li><li><p>æ£€æŸ¥è¿”å›å€¼ï¼Œå¦‚æœè¿”å›å€¼ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ™æ— è§†è¯¥è¿”å›å€¼ï¼Œè€Œå°†ç”Ÿæˆçš„å¯¹è±¡è¿”å›ã€‚å¦‚æœä¸ºå¼•ç”¨ç±»å‹ï¼Œåˆ™å°†è¯¥è¿”å›å€¼è¿”å›ã€‚</p></li></ol><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">{</span>  SuperType<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'ykx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subtype</span><span class="token punctuation">(</span><span class="token string">'lhd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span></code></pre><blockquote><p>ä¼˜ç‚¹ï¼š</p><p>1ã€å®ä¾‹åŒ–å­ç±»å‹çš„æ—¶å€™å¯ä»¥ä¼ å‚</p><p>2ã€çˆ¶ç±»å‹ä¸­çš„å±æ€§ä¸ä¼šå˜ä¸ºå…¬å…±çš„å±æ€§</p><p>ç¼ºç‚¹ï¼šè™½ç„¶æ„é€ å‡½æ•°å®ç°ç»§æ‰¿çš„æ–¹å¼æ¯”è¾ƒå¥½ç”¨ï¼Œä½†æ˜¯å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ã€‚æ„é€ å‡½æ•°ç»§æ‰¿å­˜åœ¨å†…å­˜æµªè´¹çš„æƒ…å†µï¼Œæ¯ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œéƒ½ä¼šå ç”¨ä¸€äº›å†…å­˜ã€‚</p></blockquote><h4 id="å¯„ç”Ÿå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿå¼ç»§æ‰¿"></a>å¯„ç”Ÿå¼ç»§æ‰¿</h4><p>å¯„ç”Ÿå¼ç»§æ‰¿æœ‰ç‚¹ç±»ä¼¼ä¸å·¥å‚æ¨¡å¼ï¼Œå³ä»…åˆ›å»ºä¸€ä¸ªå°è£…ç»§æ‰¿è¿‡ç¨‹çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨æŸç§æ–¹å¼å¢å¼ºå¯¹è±¡ï¼Œæœ€åå†è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">inhertprototype</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">var</span> child <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">creata</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span>  child<span class="token punctuation">.</span>say <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> child<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>    age<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token keyword">var</span> boy <span class="token operator">=</span> <span class="token function">inhertprototype</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">;</span>boy<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ä½¿ç”¨å¯„ç”Ÿå¼ç»§æ‰¿æ¥ä¸ºå¯¹è±¡æ·»åŠ å‡½æ•°ï¼Œä¸èƒ½å¤Ÿä½¿å‡½æ•°å¾—åˆ°æ›´å¤šçš„å¤ç”¨ï¼Œé™ä½äº†æ•ˆç‡ï¼Œç±»ä¼¼äºæ„é€ å‡½æ•°ã€‚</p><h4 id="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"></a>å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿</h4><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Man</span><span class="token punctuation">(</span>age<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>eat <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>something<span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">+</span> <span class="token string">'å²çš„'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'æ­£åœ¨åƒ: '</span> <span class="token operator">+</span> something<span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>Man<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>drink <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>something<span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">'æ­£åœ¨å–:'</span> <span class="token operator">+</span> something<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">Boy</span><span class="token punctuation">(</span>age<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">{</span>   Man<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>age<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç»„åˆç»§æ‰¿</span>   <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/**ä¸æ¨èä½¿ç”¨ Boy.prototype = new Man();//ç»„åˆç»§æ‰¿å› ä¸ºåœ¨JavaScriptä¸­æ²¡æœ‰æ˜¾å¼çš„constructorï¼Œæ‰€ä»¥ä½¿ç”¨newå…³é”®å­—å®ä¾‹åŒ–çš„æ—¶å€™ è¯¥å‡½æ•°ä¼šè¢«è°ƒç”¨ä¸€æ¬¡*/</span><span class="token keyword">function</span> inhertprototype <span class="token punctuation">(</span>child<span class="token punctuation">,</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">var</span> prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>  prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> child<span class="token punctuation">;</span>  child<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//Boy.prototype = Object.create(Man.prototype);</span><span class="token comment" spellcheck="true">//Boy.prototype.constructor = Boy;//é¿å…åŸå‹é”™ä¹±</span><span class="token function">inhertprototype</span><span class="token punctuation">(</span>Boy<span class="token punctuation">,</span>Man<span class="token punctuation">)</span><span class="token keyword">var</span> boy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boy</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'ykx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>boy<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token string">'apple'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>boy<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token string">'water'</span><span class="token punctuation">)</span></code></pre><p>åŸå‹é”™ä¹±ï¼š</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  SuperType<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span>Sub<span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>SuperType<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>Sub<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="http://cdn.yangkunxiao.cn/prototypeError.jpg" alt="åŸå‹é”™ä¹±"></p><p>æ­£ç¡®çš„ç»§æ‰¿ç»“æœåº”è¯¥å¦‚ä¸‹ï¼š</p><p><img src="http://cdn.yangkunxiao.cn/prototypeRight.jpg" alt="åŸå‹æ­£å¸¸"></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptæ•°æ®ç±»å‹</title>
      <link href="/2019/11/21/JavaScript/dataType/"/>
      <url>/2019/11/21/JavaScript/dataType/</url>
      
        <content type="html"><![CDATA[<p>JavaScriptä¸­æœ‰ä¸€ä¸‹ä¸ƒç§æ•°æ®ç±»å‹ï¼šNumberã€Stringã€Nullã€Undefinedã€Boolã€Objectä»¥åŠSymbalã€‚</p><h4 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h4><p>Numberã€Stringã€Nullã€Undefinedã€Boolã€‚<br>JavaScriptçš„åŸºæœ¬æ•°æ®ç±»å‹çš„è®¿é—®æ˜¯æŒ‰å€¼è®¿é—®çš„ï¼Œå› ä¸ºåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼æ˜¯ä¿å­˜åœ¨æ ˆä¸­çš„ã€‚</p><h4 id="å¼•ç”¨æ•°æ®ç±»å‹"><a href="#å¼•ç”¨æ•°æ®ç±»å‹" class="headerlink" title="å¼•ç”¨æ•°æ®ç±»å‹"></a>å¼•ç”¨æ•°æ®ç±»å‹</h4><p>Objectã€Functionã€Arrayç­‰ã€‚<br>JavaScriptçš„å¼•ç”¨æ•°æ®ç±»å‹çš„è®¿é—®æ˜¯æŒ‰å¼•ç”¨è®¿é—®çš„ï¼Œå¼•ç”¨æ•°æ®ç±»å‹çš„å€¼æ˜¯å­˜æ”¾åœ¨æ ˆå’Œå †ä¸­çš„ï¼šæŒ‡é’ˆå­˜æ”¾åœ¨æ ˆä¸­ï¼Œå€¼å­˜æ”¾åœ¨å †ä¸­ã€‚æ ˆåŒºå†…å­˜ä¿å­˜å˜é‡æ ‡è¯†ç¬¦å’ŒæŒ‡å‘å †å†…å­˜ä¸­è¯¥å¯¹è±¡çš„æŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯è¯¥å¯¹è±¡åœ¨å †å†…å­˜çš„åœ°å€ã€‚</p><h4 id="æ•°æ®ç±»å‹çš„åŒºåˆ†"><a href="#æ•°æ®ç±»å‹çš„åŒºåˆ†" class="headerlink" title="æ•°æ®ç±»å‹çš„åŒºåˆ†"></a>æ•°æ®ç±»å‹çš„åŒºåˆ†</h4><ol><li>typeof æ£€æŸ¥</li></ol><pre class=" language-bash"><code class="language-bash">typeof   123ã€€ã€€ //Numbertypeof   <span class="token string">'abc'</span>ã€€ã€€//Stringtypeof    <span class="token boolean">true</span>       //Booleantypeof    undefined   //Undefinedtypeof    null        //Object     typeof    <span class="token punctuation">{</span> <span class="token punctuation">}</span>           //Objecttypeof    <span class="token punctuation">[</span> <span class="token punctuation">]</span>           //Objecttypeof    console.log<span class="token punctuation">(</span><span class="token punctuation">)</span>       //Function</code></pre><p>å¯ä»¥çœ‹å‡º typeof æ˜¯æ£€æŸ¥ä¸å‡ºæ¥ nullã€{} ã€[] çš„ã€‚<br>æ¨èä½¿ç”¨ä¸€ä¸‹æ–¹æ³•ï¼š</p><pre class=" language-bash"><code class="language-bash">åˆ¤æ–­åŸºæœ¬ç±»å‹ï¼šObject.prototype.toString.call<span class="token punctuation">(</span>null<span class="token punctuation">)</span> //<span class="token string">"[object Null]"</span>Object.prototype.toString.call<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> //<span class="token string">"[object Array]"</span>Object.prototype.toString.call<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> //<span class="token string">"[object Object]"</span>Object.prototype.toString.call<span class="token punctuation">(</span>123<span class="token punctuation">)</span> //<span class="token string">"[object Number]"</span>Object.prototype.toString.call<span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span> //<span class="token string">"[object String]"</span>Object.prototype.toString.call<span class="token punctuation">(</span>undefined<span class="token punctuation">)</span> //<span class="token string">"[object Undefined]"</span>Object.prototype.toString.call<span class="token punctuation">(</span>true<span class="token punctuation">)</span> //<span class="token string">"[object Boolean]"</span>åˆ¤æ–­å¼•ç”¨ç±»å‹ï¼šFunction fn<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console.log<span class="token punctuation">(</span>â€œtestâ€<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>Object.prototype.toString.call<span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>//<span class="token string">"[object Function]"</span>var <span class="token function">date</span> <span class="token operator">=</span> new Date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Object.prototype.toString.call<span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>//<span class="token string">"[object Date]"</span>var reg <span class="token operator">=</span> /<span class="token punctuation">[</span>hbc<span class="token punctuation">]</span>at/gi<span class="token punctuation">;</span>Object.prototype.toString.call<span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">;</span>//<span class="token string">"[object RegExp]"</span></code></pre><h4 id="æ•°æ®åŒ…è£…ç±»å‹"><a href="#æ•°æ®åŒ…è£…ç±»å‹" class="headerlink" title="æ•°æ®åŒ…è£…ç±»å‹"></a>æ•°æ®åŒ…è£…ç±»å‹</h4><p>æ•°æ®åŒ…è£…ç±»å‹åŒ…å«ï¼šNumberã€Stringã€Booleanã€‚æ•°æ®åŒ…è£…ç±»å‹æ˜¯ç‰¹æ®Šçš„å¼•ç”¨ç±»å‹ï¼Œæ¯å½“åˆ›å»ºä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨åå°åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„æ•°æ®åŒ…è£…ç±»å‹å¯¹è±¡ï¼Œç”¨æ¥ä½¿åŸºæœ¬æ•°æ®ç±»å‹å¯ä»¥è®¿é—®å¯¹è±¡ä¸Šçš„æ–¹æ³•å’Œå±æ€§ã€‚<br>ä¸¾ä¸ªğŸŒ°ï¼š</p><pre class=" language-bash"><code class="language-bash">var str <span class="token operator">=</span> <span class="token string">'123'</span><span class="token punctuation">;</span>str.split<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//åå°åˆ›å»ºå¯¹åº”çš„æ•°æ®åŒ…è£…ç±»å‹var str <span class="token operator">=</span> new String<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span>//åˆ›å»ºstrå¯¹è±¡str.split<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//æ‰§è¡Œæ–¹æ³•str <span class="token operator">=</span> null//é”€æ¯str</code></pre><p>è€Œä¸”ï¼Œé€šè¿‡æ„é€ å‡½æ•°å’Œå¯¹è±¡å­—é¢é‡åˆ›å»ºçš„å¯¹è±¡æ˜¯ä¸ä¸€æ ·çš„ï¼š</p><pre class=" language-bash"><code class="language-bash">var str <span class="token operator">=</span> <span class="token string">'123'</span><span class="token punctuation">;</span>typeof str // stringvar str1 <span class="token operator">=</span> new String<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>typeof str1 // object</code></pre><p>å…¶ä»–çš„ Boolean å’Œ Number ä¹Ÿå’Œ String ç±»ä¼¼ã€‚</p><h4 id="ä¸ºä»€ä¹ˆä½¿ç”¨Object-prototype-toString-call"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨Object-prototype-toString-call" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨Object.prototype.toString.call()?"></a>ä¸ºä»€ä¹ˆä½¿ç”¨Object.prototype.toString.call()?</h4><p>å› ä¸ºtoStringæ–¹æ³•æ˜¯ObjectåŸå‹ä¸Šçš„æ–¹æ³•ï¼Œè€ŒArrayã€functionç­‰ç±»å‹ä½œä¸ºObjectçš„å®ä¾‹ï¼Œéƒ½é‡å†™äº†toStringæ–¹æ³•ã€‚ä¸åŒçš„å¯¹è±¡çš„è°ƒç”¨toStringæ–¹æ³•çš„æ—¶å€™ï¼Œè°ƒç”¨çš„éƒ½æ˜¯é‡å†™çš„toStringæ–¹æ³•ï¼Œè€Œä¸æ˜¯ObjectåŸå‹é“¾ä¸Šçš„æ–¹æ³•ã€‚æ‰€ä»¥å¦‚æœè¦å¾—åˆ°å¯¹è±¡çš„å…·ä½“çš„ç±»å‹ï¼Œéœ€è¦è°ƒç”¨ObjectåŸå‹ä¸Šçš„toStringæ–¹æ³•ï¼Œå³ä½¿ç”¨callå°†toStringçš„thisæŒ‡å‘æ”¹å˜ã€‚</p><pre class=" language-bash"><code class="language-bash">var fun <span class="token operator">=</span> function<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    alert<span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>console.log<span class="token punctuation">(</span>fun.toString<span class="token punctuation">(</span><span class="token punctuation">))</span>//è¿”å›çš„æ˜¯ å‡½æ•°çš„å­—ç¬¦ä¸²å½¢å¼delete Function.prototype.toString<span class="token punctuation">;</span>console.log<span class="token punctuation">(</span>fun.toString<span class="token punctuation">(</span><span class="token punctuation">))</span>// è¿”å›çš„æ˜¯<span class="token punctuation">[</span>object Function<span class="token punctuation">]</span></code></pre><p>å› ä¸ºåˆ é™¤äº†Function.prototypeä¸Šçš„toStringæ–¹æ³•ä¹‹åï¼Œæ ¹æ®åŸå‹é“¾ï¼Œå®ƒä¼šæ²¿ç€åŸå‹é“¾æŸ¥æ‰¾åˆ°Object.prototype.toStringæ–¹æ³•</p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³å¤šå›¾ç‰‡å‹ç¼©ä¸Šä¼ å’ŒiOSç«¯å›¾ç‰‡ä¸Šä¼ é€‰æ‹©90åº¦çš„é—®é¢˜</title>
      <link href="/2019/11/20/JavaScript/multiImageUpload/"/>
      <url>/2019/11/20/JavaScript/multiImageUpload/</url>
      
        <content type="html"><![CDATA[<p>é€»è¾‘æ€è·¯ï¼š<br>1ã€ç›‘å¬inputæ–‡ä»¶å€¼çš„changeäº‹ä»¶<br>2ã€è·å–æ–‡ä»¶åˆ—è¡¨<br>3ã€ä½¿ç”¨FileReader()å‡½æ•°è¯»å–å›¾ç‰‡ä¿¡æ¯ï¼Œå¹¶è½¬ä¸ºbase64æ ¼å¼<br>4ã€æ ¹æ®é¢„è®¾çš„é˜€å€¼ï¼Œåˆ¤æ–­æ˜¯å¦å‹ç¼©<br>5ã€å¦‚æœä¸å‹ç¼©ï¼Œå°†å›¾ç‰‡è½¬ä¸ºblobæ ¼å¼ï¼Œä½¿ç”¨FormData()å‡½æ•°ï¼Œä¸Šä¼ å›¾ç‰‡<br>6ã€å¦‚æœå‹ç¼©å›¾ç‰‡ï¼Œä½¿ç”¨canvasé‡æ–°ç»˜åˆ¶å›¾ç‰‡ï¼Œæ ¹æ®éœ€è¦ï¼Œé€‰æ‹©æ˜¯å¦ä½¿ç”¨ç“¦ç‰‡canvas<br>7ã€ä½¿ç”¨Exif.jsï¼Œè·å–å›¾ç‰‡æ–¹å‘ä¿¡æ¯ï¼Œç¡®å®šæ˜¯å¦éœ€è¦ä½¿ç”¨canvasçš„rotate()å‡½æ•°è¿›è¡Œæ—‹è½¬å›¾ç‰‡<br>8ã€ä¸Šä¼ å›¾ç‰‡</p><h4 id="è‡ªå®šä¹‰å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼š"><a href="#è‡ªå®šä¹‰å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼š" class="headerlink" title="è‡ªå®šä¹‰å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼š"></a>è‡ªå®šä¹‰å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼š</h4><pre class=" language-bash"><code class="language-bash">//æ¨è<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">'file'</span> id<span class="token operator">=</span><span class="token string">'upload'</span> accept<span class="token operator">=</span><span class="token string">'image/gif,image/jpeg,image/png,image/jpg'</span> @change<span class="token operator">=</span><span class="token string">'upload'</span> <span class="token operator">></span>//ä¸æ¨èä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹æ³•ï¼Œè¯¥å½¢å¼åœ¨Chromeæµè§ˆå™¨ä¸­ï¼Œé€‰æ‹©æ–‡ä»¶å¼¹æ¡†ä¼šæ»ç•™ä¸€æ®µæ—¶é—´æ‰å¼¹å‡º<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">'file'</span> name<span class="token operator">=</span><span class="token string">'file'</span> class<span class="token operator">=</span><span class="token string">'element'</span> accept<span class="token operator">=</span><span class="token string">'image/*'</span><span class="token operator">></span></code></pre><h4 id="å¼•å…¥exif-js"><a href="#å¼•å…¥exif-js" class="headerlink" title="å¼•å…¥exif.js"></a>å¼•å…¥exif.js</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">import</span> Exif from <span class="token string">'exif-js'</span></code></pre><h4 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h4><pre class=" language-bash"><code class="language-bash">upload<span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> files <span class="token operator">=</span> e.target.files <span class="token operator">||</span> e.dataTransfer.files<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>files.length<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>    this.picValue <span class="token operator">=</span> files<span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">;</span>    this.imgPreview<span class="token punctuation">(</span>this.picValue<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>,//å›¾ç‰‡é¢„è§ˆã€å¤„ç†ã€ä¸Šä¼ imgPreview<span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> self <span class="token operator">=</span> this<span class="token punctuation">;</span>    <span class="token keyword">let</span> Orientation<span class="token punctuation">;</span>    //å»è·å–æ‹ç…§æ—¶çš„ä¿¡æ¯ï¼Œè§£å†³æ‹å‡ºæ¥çš„ç…§ç‰‡æ—‹è½¬é—®é¢˜    Exif.getData<span class="token punctuation">(</span>file, function<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        Orientation <span class="token operator">=</span> Exif.getTag<span class="token punctuation">(</span>this, <span class="token string">'Orientation'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    // alert<span class="token punctuation">(</span>Orientation,<span class="token string">'console.log(Orientation)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    debugger    // çœ‹æ”¯æŒä¸æ”¯æŒFileReader    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file <span class="token operator">||</span> <span class="token operator">!</span>window.FileReader<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>    // alert<span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    // åˆ›å»ºä¸€ä¸ªreader    <span class="token keyword">let</span> reader <span class="token operator">=</span> new FileReader<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    // å°†å›¾ç‰‡2å°†è½¬æˆ base64 æ ¼å¼    reader.readAsDataURL<span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>    // è¯»å–æˆåŠŸåçš„å›è°ƒ    reader.onloadend <span class="token operator">=</span> function<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> result <span class="token operator">=</span> this.result<span class="token punctuation">;</span>        <span class="token keyword">let</span> img <span class="token operator">=</span> new Image<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        img.onload <span class="token operator">=</span> function<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">let</span> data <span class="token operator">=</span> self.compress<span class="token punctuation">(</span>img, Orientation<span class="token punctuation">)</span><span class="token punctuation">;</span>            /*self.headerImage <span class="token operator">=</span> data<span class="token punctuation">;</span>  */            var blob <span class="token operator">=</span> self.dataURItoBlob<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>            var fd <span class="token operator">=</span> new FormData<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            fd.append<span class="token punctuation">(</span><span class="token string">"file"</span>, blob, <span class="token string">'image.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            fd.fileName <span class="token operator">=</span> blob<span class="token punctuation">;</span>            console.log<span class="token punctuation">(</span>fd, <span class="token string">'fd'</span><span class="token punctuation">)</span>            axios.post<span class="token punctuation">(</span><span class="token string">'/sunrise-gateway/oss/ossUpload'</span>, fd<span class="token punctuation">)</span>.then<span class="token punctuation">((</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> res            <span class="token punctuation">}</span><span class="token punctuation">)</span>.then<span class="token punctuation">((</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                console.log<span class="token punctuation">(</span>res, <span class="token string">'res'</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>res.data.code <span class="token operator">==</span> <span class="token string">'000000'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    self.list.push<span class="token punctuation">(</span><span class="token punctuation">..</span>.res.data.data<span class="token punctuation">)</span><span class="token punctuation">;</span>                    self.objUrl <span class="token operator">=</span> res.data.data<span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">;</span>                    self.picNum++<span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                    MessageBox.alert<span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ å¤±è´¥0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                Indicator.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>.catch<span class="token punctuation">((</span>err<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>                Indicator.close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                MessageBox.alert<span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ å¤±è´¥1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>            // alert<span class="token punctuation">(</span>blob<span class="token punctuation">)</span>        <span class="token punctuation">}</span>        img.src <span class="token operator">=</span> result<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>,//base64è½¬blobdataURItoBlob<span class="token punctuation">(</span>base64Data<span class="token punctuation">)</span> <span class="token punctuation">{</span>    var byteString<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>base64Data.split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span>.indexOf<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span> <span class="token operator">>=</span> 0<span class="token punctuation">)</span> <span class="token punctuation">{</span>        byteString <span class="token operator">=</span> atob<span class="token punctuation">(</span>base64Data.split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        byteString <span class="token operator">=</span> unescape<span class="token punctuation">(</span>base64Data.split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    var mimeString <span class="token operator">=</span> base64Data.split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span>.split<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>1<span class="token punctuation">]</span>.split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">;</span>    var ia <span class="token operator">=</span> new Uint8Array<span class="token punctuation">(</span>byteString.length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>var i <span class="token operator">=</span> 0<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> byteString.length<span class="token punctuation">;</span> i++<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> byteString.charCodeAt<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> new Blob<span class="token punctuation">(</span><span class="token punctuation">[</span>ia<span class="token punctuation">]</span>, <span class="token punctuation">{</span>        type: mimeString    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>,//å›¾ç‰‡æ—‹è½¬rotateImg<span class="token punctuation">(</span>img, direction, canvas<span class="token punctuation">)</span> <span class="token punctuation">{</span>    //æœ€å°ä¸æœ€å¤§æ—‹è½¬æ–¹å‘ï¼Œå›¾ç‰‡æ—‹è½¬4æ¬¡åå›åˆ°åŸæ–¹å‘    const min_step <span class="token operator">=</span> 0<span class="token punctuation">;</span>    const max_step <span class="token operator">=</span> 3<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>img <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>    //imgçš„é«˜åº¦å’Œå®½åº¦ä¸èƒ½åœ¨imgå…ƒç´ éšè—åè·å–ï¼Œå¦åˆ™ä¼šå‡ºé”™    <span class="token keyword">let</span> height <span class="token operator">=</span> img.height<span class="token punctuation">;</span>    <span class="token keyword">let</span> width <span class="token operator">=</span> img.width<span class="token punctuation">;</span>    <span class="token keyword">let</span> step <span class="token operator">=</span> 2<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>step <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        step <span class="token operator">=</span> min_step<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>direction <span class="token operator">==</span> <span class="token string">'right'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        step++<span class="token punctuation">;</span>        //æ—‹è½¬åˆ°åŸä½ç½®ï¼Œå³è¶…è¿‡æœ€å¤§å€¼        step <span class="token operator">></span> max_step <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>step <span class="token operator">=</span> min_step<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        step--<span class="token punctuation">;</span>        step <span class="token operator">&lt;</span> min_step <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>step <span class="token operator">=</span> max_step<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    //æ—‹è½¬è§’åº¦ä»¥å¼§åº¦å€¼ä¸ºå‚æ•°    <span class="token keyword">let</span> degree <span class="token operator">=</span> step * 90 * Math.PI / 180<span class="token punctuation">;</span>    <span class="token keyword">let</span> ctx <span class="token operator">=</span> canvas.getContext<span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    switch <span class="token punctuation">(</span>step<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> 0:            canvas.width <span class="token operator">=</span> width<span class="token punctuation">;</span>            canvas.height <span class="token operator">=</span> height<span class="token punctuation">;</span>            ctx.drawImage<span class="token punctuation">(</span>img, 0, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> 1:            canvas.width <span class="token operator">=</span> height<span class="token punctuation">;</span>            canvas.height <span class="token operator">=</span> width<span class="token punctuation">;</span>            ctx.rotate<span class="token punctuation">(</span>degree<span class="token punctuation">)</span><span class="token punctuation">;</span>            ctx.drawImage<span class="token punctuation">(</span>img, 0, -height<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> 2:            canvas.width <span class="token operator">=</span> width<span class="token punctuation">;</span>            canvas.height <span class="token operator">=</span> height<span class="token punctuation">;</span>            ctx.rotate<span class="token punctuation">(</span>degree<span class="token punctuation">)</span><span class="token punctuation">;</span>            ctx.drawImage<span class="token punctuation">(</span>img, -width, -height<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> 3:            canvas.width <span class="token operator">=</span> height<span class="token punctuation">;</span>            canvas.height <span class="token operator">=</span> width<span class="token punctuation">;</span>            ctx.rotate<span class="token punctuation">(</span>degree<span class="token punctuation">)</span><span class="token punctuation">;</span>            ctx.drawImage<span class="token punctuation">(</span>img, -width, 0<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>,//å›¾ç‰‡å‹ç¼©compress<span class="token punctuation">(</span>img, Orientation<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> canvas <span class="token operator">=</span> document.createElement<span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> ctx <span class="token operator">=</span> canvas.getContext<span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    //ç“¦ç‰‡canvas    <span class="token keyword">let</span> tCanvas <span class="token operator">=</span> document.createElement<span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> tctx <span class="token operator">=</span> tCanvas.getContext<span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> initSize <span class="token operator">=</span> img.src.length<span class="token punctuation">;</span>    <span class="token keyword">let</span> width <span class="token operator">=</span> img.width<span class="token punctuation">;</span>    <span class="token keyword">let</span> height <span class="token operator">=</span> img.height<span class="token punctuation">;</span>    //å¦‚æœå›¾ç‰‡å¤§äºå››ç™¾ä¸‡åƒç´ ï¼Œè®¡ç®—å‹ç¼©æ¯”å¹¶å°†å¤§å°å‹è‡³400ä¸‡ä»¥ä¸‹    <span class="token keyword">let</span> ratio<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">((</span>ratio <span class="token operator">=</span> width * height / 4000000<span class="token punctuation">)</span> <span class="token operator">></span> 1<span class="token punctuation">)</span> <span class="token punctuation">{</span>        // console.log<span class="token punctuation">(</span><span class="token string">'å¤§äº400ä¸‡åƒç´ '</span><span class="token punctuation">)</span>        ratio <span class="token operator">=</span> Math.sqrt<span class="token punctuation">(</span>ratio<span class="token punctuation">)</span><span class="token punctuation">;</span>        width /<span class="token operator">=</span> ratio<span class="token punctuation">;</span>        height /<span class="token operator">=</span> ratio<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        ratio <span class="token operator">=</span> 1<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    canvas.width <span class="token operator">=</span> width<span class="token punctuation">;</span>    canvas.height <span class="token operator">=</span> height<span class="token punctuation">;</span>    //é“ºåº•è‰²    ctx.fillStyle <span class="token operator">=</span> <span class="token string">'#fff'</span><span class="token punctuation">;</span>    ctx.fillRect<span class="token punctuation">(</span>0, 0, canvas.width, canvas.height<span class="token punctuation">)</span><span class="token punctuation">;</span>    //å¦‚æœå›¾ç‰‡åƒç´ å¤§äº100ä¸‡åˆ™ä½¿ç”¨ç“¦ç‰‡ç»˜åˆ¶    <span class="token keyword">let</span> count<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">((</span>count <span class="token operator">=</span> width * height / 1000000<span class="token punctuation">)</span> <span class="token operator">></span> 1<span class="token punctuation">)</span> <span class="token punctuation">{</span>        // console.log<span class="token punctuation">(</span><span class="token string">'è¶…è¿‡100Wåƒç´ '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        count <span class="token operator">=</span> ~~<span class="token punctuation">(</span>Math.sqrt<span class="token punctuation">(</span>count<span class="token punctuation">)</span> + 1<span class="token punctuation">)</span><span class="token punctuation">;</span> //è®¡ç®—è¦åˆ†æˆå¤šå°‘å—ç“¦ç‰‡        //è®¡ç®—æ¯å—ç“¦ç‰‡çš„å®½å’Œé«˜        <span class="token keyword">let</span> nw <span class="token operator">=</span> ~~<span class="token punctuation">(</span>width / count<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">let</span> nh <span class="token operator">=</span> ~~<span class="token punctuation">(</span>height / count<span class="token punctuation">)</span><span class="token punctuation">;</span>        tCanvas.width <span class="token operator">=</span> nw<span class="token punctuation">;</span>        tCanvas.height <span class="token operator">=</span> nh<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>let i <span class="token operator">=</span> 0<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i++<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>let j <span class="token operator">=</span> 0<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> j++<span class="token punctuation">)</span> <span class="token punctuation">{</span>                tctx.drawImage<span class="token punctuation">(</span>img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh<span class="token punctuation">)</span><span class="token punctuation">;</span>                ctx.drawImage<span class="token punctuation">(</span>tCanvas, i * nw, j * nh, nw, nh<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        ctx.drawImage<span class="token punctuation">(</span>img, 0, 0, width, height<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    //ä¿®å¤iosä¸Šä¼ å›¾ç‰‡çš„æ—¶å€™ è¢«æ—‹è½¬çš„é—®é¢˜    <span class="token keyword">if</span> <span class="token punctuation">(</span>Orientation <span class="token operator">!=</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> Orientation <span class="token operator">!=</span> 1<span class="token punctuation">)</span> <span class="token punctuation">{</span>        switch <span class="token punctuation">(</span>Orientation<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">case</span> 6: //éœ€è¦é¡ºæ—¶é’ˆï¼ˆå‘å·¦ï¼‰90åº¦æ—‹è½¬                this.rotateImg<span class="token punctuation">(</span>img, <span class="token string">'left'</span>, canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> 8: //éœ€è¦é€†æ—¶é’ˆï¼ˆå‘å³ï¼‰90åº¦æ—‹è½¬                this.rotateImg<span class="token punctuation">(</span>img, <span class="token string">'right'</span>, canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> 3: //éœ€è¦180åº¦æ—‹è½¬                this.rotateImg<span class="token punctuation">(</span>img, <span class="token string">'right'</span>, canvas<span class="token punctuation">)</span><span class="token punctuation">;</span> //è½¬ä¸¤æ¬¡                this.rotateImg<span class="token punctuation">(</span>img, <span class="token string">'right'</span>, canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    //è¿›è¡Œæœ€å°å‹ç¼©        <span class="token keyword">let</span> ndata <span class="token operator">=</span> canvas.toDataURL<span class="token punctuation">(</span><span class="token string">'image/jpeg'</span>, 0.1<span class="token punctuation">)</span><span class="token punctuation">;</span>    tCanvas.width <span class="token operator">=</span> tCanvas.height <span class="token operator">=</span> canvas.width <span class="token operator">=</span> canvas.height <span class="token operator">=</span> 0<span class="token punctuation">;</span>    <span class="token keyword">return</span> ndata<span class="token punctuation">;</span><span class="token punctuation">}</span>,</code></pre><p>å¤‡æ³¨ï¼š<br>canvas.toDataURL() æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«å›¾ç‰‡å±•ç¤ºçš„ data URI ã€‚å¯ä»¥ä½¿ç”¨ type å‚æ•°å…¶ç±»å‹ï¼Œé»˜è®¤ä¸º image/png æ ¼å¼ã€‚å›¾ç‰‡çš„åˆ†è¾¨ç‡ä¸º96dpiã€‚</p><p>åœ¨æŒ‡å®šå›¾ç‰‡æ ¼å¼ä¸º image/jpeg æˆ– image/webpçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä» 0 åˆ° 1 çš„åŒºé—´å†…é€‰æ‹©å›¾ç‰‡çš„è´¨é‡ã€‚å¦‚æœè¶…å‡ºå–å€¼èŒƒå›´ï¼Œå°†ä¼šä½¿ç”¨é»˜è®¤å€¼ 0.92ã€‚å…¶ä»–å‚æ•°ä¼šè¢«å¿½ç•¥ã€‚</p><p>è¿”å›å€¼ï¼šåŒ…å«dataURIçš„DOMStringã€‚</p><p> DataURIæ ¼å¼ï¼šdata:[<mediatype>][;base64],<data>ã€‚å…¶ä¸­mediatypeå£°æ˜äº†æ–‡ä»¶ç±»å‹ï¼Œéµå¾ªMIMEè§„åˆ™ï¼Œå¦‚â€œimage/pngâ€ã€â€œtext/plainâ€ï¼›ä¹‹åæ˜¯ç¼–ç ç±»å‹ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ¶‰åŠ base64ï¼›ç´§æ¥ç€å°±æ˜¯æ–‡ä»¶ç¼–ç åçš„å†…å®¹äº†ã€‚</p><p>URIï¼ˆUniform Resource Identifierï¼‰:ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦,æœåŠ¡å™¨èµ„æºåè¢«ç§°ä¸ºç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦.å¦‚ï¼š<code>img src=&#39;images/image.png&#39;</code></p><p>URLï¼ˆUniform Resource Locatorï¼‰:ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œæè¿°äº†ä¸€å°ç‰¹å®šæœåŠ¡å™¨ä¸ŠæŸèµ„æºçš„ç‰¹å®šä½ç½®ã€‚å¦‚:</p><pre><code>img src=&#39;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAWCAYAAAArdgcFAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAAsTAAALEwEAmpwYAAABSUlEQVQ4Ee1VPUsDQRB9s3dBRCRNQvCjkDQW/hJ/gb9AOwWDoIXFgYXYXGP+hYW1/gIr7WzsE8VGxZBcwt04dznCJWw2twtWutXMmzdvlrd7t4SZVbvi1ZihZuCFqT9A/B7Qd5FI44RpPcQpE1oC1IsEq5jRBeGyc0zXaV8mvhbyOREurIRMZMZhp0VthYB9mXBi4jrUztIev1bNbKg6CMxvIWwg5GWVDOHNZ7lX6l/wrG+Fzbh/ca1bf9QWBhKtHznobgtjKF92ZBL3TUWpRbK7LhiVCY8kY3xK/iTiexNcEywSXxKBrfHvrdBN2JRsp4BoQ3dbtHLT4K+JqxWw8vr4YDaf+vR+SmXRWw99lT9N96VaypIYtwgoyWyJRtiX3T+X7TXxROcxGeAo5chlyNcBVxrb2JVpTUHsz4IQi/DL6wPucENxqvoDx69PXP8OKn4AAAAASUVORK5CYII=&#39;/</code></pre>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macå¼€å¯æœ¬åœ°æœåŠ¡å™¨</title>
      <link href="/2019/11/20/Other/server/"/>
      <url>/2019/11/20/Other/server/</url>
      
        <content type="html"><![CDATA[<h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ª IMAP/POP3/SMTP ä»£ç†æœåŠ¡å™¨ã€‚</p><pre class=" language-bash"><code class="language-bash">å®‰è£…ï¼šæœç´¢è½¯ä»¶ï¼šbrew search nginxå®‰è£…è½¯ä»¶ï¼šbrew <span class="token function">install</span> nginxå¸è½½è½¯ä»¶ï¼šbrew uninstall nginxå‡çº§brewï¼šsudo brew updateæŸ¥çœ‹å®‰è£…ä¿¡æ¯ï¼šsudo brew info nginxæŸ¥çœ‹å·²ç»å®‰è£…çš„è½¯ä»¶ï¼šbrew list</code></pre><p>nginxå¸¸ç”¨å‘½ä»¤ï¼š</p><pre class=" language-bash"><code class="language-bash">nginx -v //æŸ¥çœ‹ä¸‹å®‰è£…å¥½çš„nginxç‰ˆæœ¬<span class="token function">sudo</span> nginx  // å¯åŠ¨nginx<span class="token function">sudo</span> nginx              //å¯åŠ¨nginx<span class="token function">sudo</span> nginx -s reload    //ä¿®æ”¹é…ç½®åé‡æ–°åŠ è½½ç”Ÿæ•ˆ<span class="token comment" spellcheck="true">#ç®€å•è§£é‡Šä¸‹ï¼Œä¸Šé¢è¿™ç§æ–¹æ³•é‡å¯ï¼Œnginxåœ¨é‡å¯çš„æ—¶å€™ä¸ä¼šä¸­æ–­æœåŠ¡ï¼Œå› ä¸º  nginxåœ¨å¯åŠ¨åï¼Œä¼šæœ‰ä¸€ä¸ªmasterè¿›ç¨‹å’Œå¤šä¸ªworkerè¿›ç¨‹ï¼Œé‡å¯æ˜¯ä¼šå…ˆç”Ÿæˆæ–°çš„workerè¿›ç¨‹å»æ¥å—reloadå‘½ä»¤ï¼Œç­‰è€çš„workerè¿›ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œmasterè¿›ç¨‹åœ¨å…³é—­ä»–ä»¬ï¼Œæ‰€ä»¥æœåŠ¡å™¨ä¸ä¼šä¸­æ–­ã€‚</span><span class="token function">sudo</span> nginx -s  reopen   //é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶<span class="token function">sudo</span> nginx -s stop  //å¿«é€Ÿåœæ­¢nginx<span class="token function">sudo</span> nginx -s quit  //å®Œæ•´æœ‰åºçš„åœæ­¢nginx<span class="token function">sudo</span> nginx -t     //æµ‹è¯•å½“å‰é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®</code></pre><p>nginxå¸¸è§ç›®å½•ï¼š</p><pre class=" language-bash"><code class="language-bash">/usr/local/Cellar/  <span class="token comment" spellcheck="true">#nginxé»˜è®¤å®‰è£…çš„ç›®å½•,æ‰€æœ‰ä½¿ç”¨brewå®‰è£…çš„è½¯ä»¶é»˜è®¤éƒ½åœ¨è¿™é‡Œ</span>/usr/local/Cellar/nginx/1.8.0/html  ï¼ƒé»˜è®¤çš„è®¿é—®ç›®å½•ï¼Œå°±æ˜¯æˆ‘ä»¬è¯´çš„ç½‘ç«™æ ¹ç›®å½•/usr/local/etc/nginx/     <span class="token comment" spellcheck="true"># nginx.confæ‰€åœ¨çš„ç›®å½•</span>ä¿®æ”¹é»˜è®¤è·¯å¾„ä»nginx/htmlæ”¹æˆä½ è‡ªå·±æ”¾ç½®ä»£ç çš„è·¯å¾„vim /usr/local/etc/nginx/nginx.conf</code></pre><p>æ¥ä¸‹æ¥çš„ä»»åŠ¡å°±å¾ˆæ˜ç¡®äº†ï¼ŒæŠŠlisten 80ä¸‹é¢çš„ä¸¤ä¸ª root htmlä¸­çš„è·¯å¾„ï¼Œæ”¹æˆæˆ‘ä»¬è‡ªå·±æ”¾ä»£ç çš„æ–‡ä»¶å¤¹ã€‚ä¾‹å¦‚åœ¨æ¡Œé¢ä¸‹é¢æ–°å»ºä¸€ä¸ªhomeçš„æ–‡ä»¶å¤¹ï¼Œå†åœ¨ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªwwwçš„æ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆè·¯å¾„å°±æ˜¯ï¼šæ¡Œé¢:homewwwï¼ŒæŠŠtask1.htmlæ”¾è¿›å»ï¼Œç„¶åä¿®æ”¹é…ç½®ä¿®æ”¹å®Œæˆåï¼Œç‚¹å‡»Escé”®<code>Â·shift+: è¾“å…¥ï¼šwq</code>ï¼Œä¿å­˜ä¿®æ”¹ã€‚</p><h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><p>æ‰“å¼€ç»ˆç«¯ï¼Œå¼€å¯Apache:</p><pre class=" language-bash"><code class="language-bash">//å¼€å¯apache:  <span class="token function">sudo</span> apachectl start//é‡å¯apache:  <span class="token function">sudo</span> apachectl restart//å…³é—­apache:  <span class="token function">sudo</span> apachectl stop//æŸ¥çœ‹apacheç‰ˆæœ¬ <span class="token function">sudo</span> apachectl -v</code></pre><p>å›è½¦ä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œä¹Ÿå°±æ˜¯ä½ ç”µè„‘çš„å¯†ç ï¼Œ<a href="http://127.0.0.1/æµ‹è¯•ä¸€ä¸‹ã€‚" target="_blank" rel="noopener">http://127.0.0.1/æµ‹è¯•ä¸€ä¸‹ã€‚</a><br>ç‚¹å‡»Finder,ç„¶åCommand+Shift+G,å‰å¾€ApacheæœåŠ¡å™¨çš„æ–‡ä»¶è·¯å¾„(/Library/WebServer/Documents)ï¼Œåœ¨æ­¥éª¤1ä¸­åªè¾“å…¥ä¸€ä¸ª<a href="http://127.0.0.1å…¶å®é»˜è®¤æ‰“å¼€çš„æ˜¯index.html.en(htmlæ˜¯ä¸€ä¸ªç½‘é¡µæ–‡ä»¶)ï¼Œè¯¥æ–‡ä»¶çš„å†…å®¹å°±æ˜¯åœ¨æ­¥éª¤1ä¸­æµ‹è¯•æ—¶æµè§ˆå™¨æ‰€æ˜¾ç¤ºçš„å†…å®¹" target="_blank" rel="noopener">http://127.0.0.1å…¶å®é»˜è®¤æ‰“å¼€çš„æ˜¯index.html.en(htmlæ˜¯ä¸€ä¸ªç½‘é¡µæ–‡ä»¶)ï¼Œè¯¥æ–‡ä»¶çš„å†…å®¹å°±æ˜¯åœ¨æ­¥éª¤1ä¸­æµ‹è¯•æ—¶æµè§ˆå™¨æ‰€æ˜¾ç¤ºçš„å†…å®¹</a></p>]]></content>
      
      
      <categories>
          
          <category> other </category>
          
      </categories>
      
      
        <tags>
            
            <tag> other </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vueä½¿ç”¨webpackä¼˜åŒ–æ„å»ºæµç¨‹</title>
      <link href="/2019/11/20/Vue/webpack%E6%9E%84%E5%BB%BA/"/>
      <url>/2019/11/20/Vue/webpack%E6%9E%84%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>åˆè¡·ï¼šå¦‚æœæˆ‘ä»¬çš„ Vue é¡¹ç›®æ¯”è¾ƒå¤§ï¼æˆ–è€…è¯´é¡¹ç›®ä¸­å¼•å…¥äº†è®¸å¤šç¬¬ä¸‰æ–¹åº“ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œ npm run build æ„å»ºé¡¹ç›®çš„æ—¶å€™ä¼šæå…¶çš„æ…¢ï¼æ¯”å¦‚æˆ‘ç°åœ¨çš„é¡¹ç›®å°±æ¯æ¬¡æ‰“åŒ…å°±è¦ 83sã€‚<br>ä¸‹é¢æä¾›ä¸€äº›æ–¹æ³•ç”¨æ¥æä¾›ä¼˜åŒ–æ‰“åŒ…é€Ÿåº¦ï¼š</p><h4 id="resolve-modules"><a href="#resolve-modules" class="headerlink" title="resolve.modules"></a>resolve.modules</h4><p>æ€è·¯ï¼šwebpack çš„ resolve.modules æ˜¯ç”¨æ¥é…ç½®æ¨¡å—åº“ï¼ˆå³ node_modulesï¼‰æ‰€åœ¨çš„ä½ç½®ã€‚å½“ js é‡Œå‡ºç° import â€˜vueâ€™ è¿™æ ·ä¸æ˜¯ç›¸å¯¹ã€ä¹Ÿä¸æ˜¯ç»å¯¹è·¯å¾„çš„å†™æ³•æ—¶ï¼Œå®ƒä¾¿ä¼šåˆ° node_modules ç›®å½•ä¸‹å»æ‰¾ã€‚åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œwebpack ä¼šé‡‡ç”¨å‘ä¸Šé€’å½’æœç´¢çš„æ–¹å¼å»å¯»æ‰¾ã€‚ä½†é€šå¸¸é¡¹ç›®ç›®å½•é‡Œåªæœ‰ä¸€ä¸ª node_modulesï¼Œä¸”æ˜¯åœ¨é¡¹ç›®æ ¹ç›®å½•ã€‚ä¸ºäº†å‡å°‘æœç´¢èŒƒå›´ï¼Œå¯æˆ‘ä»¬ä»¥ç›´æ¥å†™æ˜ node_modules çš„å…¨è·¯å¾„ã€‚</p><pre><code>æ‰“å¼€ build/webpack.base.conf.js æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼šmodule.exports = {  resolve: {    extensions: [&#39;.js&#39;, &#39;.vue&#39;, &#39;.json&#39;],    modules: [      resolve(&#39;src&#39;),      resolve(&#39;node_modules&#39;)    ],    alias: {      &#39;vue$&#39;: &#39;vue/dist/vue.esm.js&#39;,      &#39;@&#39;: resolve(&#39;src&#39;),    }  },</code></pre><h4 id="webpack-parallel-uglify-plugin"><a href="#webpack-parallel-uglify-plugin" class="headerlink" title="webpack-parallel-uglify-plugin"></a>webpack-parallel-uglify-plugin</h4><p>åŸç†ï¼šwebpacké»˜è®¤æä¾›äº†UglifyJSæ’ä»¶æ¥å‹ç¼©JSä»£ç ï¼Œä½†æ˜¯å®ƒä½¿ç”¨çš„æ˜¯å•çº¿ç¨‹å‹ç¼©ä»£ç ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šä¸ªjsæ–‡ä»¶éœ€è¦è¢«å‹ç¼©ï¼Œå®ƒéœ€è¦ä¸€ä¸ªä¸ªæ–‡ä»¶è¿›è¡Œå‹ç¼©ã€‚æ‰€ä»¥è¯´åœ¨æ­£å¼ç¯å¢ƒæ‰“åŒ…å‹ç¼©ä»£ç é€Ÿåº¦éå¸¸æ…¢(å› ä¸ºå‹ç¼©JSä»£ç éœ€è¦å…ˆæŠŠä»£ç è§£ææˆç”¨ObjectæŠ½è±¡è¡¨ç¤ºçš„ASTè¯­æ³•æ ‘ï¼Œå†å»åº”ç”¨å„ç§è§„åˆ™åˆ†æå’Œå¤„ç†ASTï¼Œå¯¼è‡´è¿™ä¸ªè¿‡ç¨‹è€—æ—¶éå¸¸å¤§)ã€‚æºç ï¼š</p><pre><code>module.exports = {  plugins: [    new webpack.optimize.UglifyJsPlugin({      sourceMap: true,      compress: {        warnings: false      }    }),  ]}</code></pre><p>æˆ‘ä»¬å¯ä»¥æ”¹ç”¨ webpack-parallel-uglify-plugin æ’ä»¶ï¼Œå®ƒå¯ä»¥å¹¶è¡Œè¿è¡Œ UglifyJS æ’ä»¶ï¼Œä»è€Œæ›´åŠ å……åˆ†ã€åˆç†çš„ä½¿ç”¨ CPU èµ„æºï¼Œä»è€Œå¤§å¤§å‡å°‘æ„å»ºæ—¶é—´ã€‚<br>å½“webpackæœ‰å¤šä¸ªJSæ–‡ä»¶éœ€è¦è¾“å‡ºå’Œå‹ç¼©æ—¶å€™ï¼ŒåŸæ¥ä¼šä½¿ç”¨UglifyJSå»ä¸€ä¸ªä¸ªå‹ç¼©å¹¶ä¸”è¾“å‡ºï¼Œä½†æ˜¯ParallelUglifyPluginæ’ä»¶åˆ™ä¼šå¼€å¯å¤šä¸ªå­è¿›ç¨‹ï¼ŒæŠŠå¯¹å¤šä¸ªæ–‡ä»¶å‹ç¼©çš„å·¥ä½œåˆ†åˆ«ç»™å¤šä¸ªå­è¿›ç¨‹å»å®Œæˆï¼Œä½†æ˜¯æ¯ä¸ªå­è¿›ç¨‹è¿˜æ˜¯é€šè¿‡UglifyJSå»å‹ç¼©ä»£ç ã€‚æ— éå°±æ˜¯å˜æˆäº†å¹¶è¡Œå¤„ç†è¯¥å‹ç¼©äº†ï¼Œå¹¶è¡Œå¤„ç†å¤šä¸ªå­ä»»åŠ¡ï¼Œæ•ˆç‡ä¼šæ›´é«˜ã€‚</p><pre><code>å®‰è£…ï¼šnpm i webpack-parallel-uglify-pluginæ‰“å¼€ build/webpack.prod.conf.js æ–‡ä»¶ï¼Œå¹¶ä½œå¦‚ä¸‹ä¿®æ”¹ï¼šconst ParallelUglifyPlugin = require(&#39;webpack-parallel-uglify-plugin&#39;);// åˆ æ‰webpackæä¾›çš„UglifyJSæ’ä»¶    //new UglifyJsPlugin({    //  uglifyOptions: {    //    compress: {    //      warnings: false    //    }    //  },    //  sourceMap: config.build.productionSourceMap,    //  parallel: true    //}),    // å¢åŠ  webpack-parallel-uglify-pluginæ¥æ›¿æ¢    new ParallelUglifyPlugin({      cacheDir: &#39;.cache/&#39;,      uglifyJS:{        output: {          comments: false        },        compress: {          warnings: false,          drop_debugger: true,          drop_console: true        }      }    }),</code></pre><h4 id="HappyPack"><a href="#HappyPack" class="headerlink" title="HappyPack"></a>HappyPack</h4><p>åŸç†ï¼šç”±äºè¿è¡Œåœ¨ Node.js ä¹‹ä¸Šçš„ Webpack æ˜¯å•çº¿ç¨‹æ¨¡å‹çš„ï¼Œæ‰€ä»¥ Webpack éœ€è¦å¤„ç†çš„äº‹æƒ…åªèƒ½ä¸€ä»¶ä¸€ä»¶åœ°åšï¼Œä¸èƒ½å¤šä»¶äº‹ä¸€èµ·åšã€‚è€Œ HappyPack çš„å¤„ç†æ€è·¯æ˜¯ï¼šå°†åŸæœ‰çš„ webpack å¯¹ loader çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä»å•ä¸€è¿›ç¨‹çš„å½¢å¼æ‰©å±•å¤šè¿›ç¨‹æ¨¡å¼ï¼Œä»è€ŒåŠ é€Ÿä»£ç æ„å»ºã€‚</p><pre><code>å®‰è£…ï¼šnpm i happypackæ‰“å¼€ build/webpack.base.conf.js æ–‡ä»¶ï¼Œå¹¶ä½œå¦‚ä¸‹ä¿®æ”¹ï¼šconst HappyPack = require(&#39;happypack&#39;);const os = require(&#39;os&#39;);const happyThreadPool = HappyPack.ThreadPool({ size: os.cpus().length });module.exports = {  module: {    rules: [      {        test: /.js$/,        //æŠŠå¯¹.js çš„æ–‡ä»¶å¤„ç†äº¤ç»™idä¸ºhappyBabel çš„HappyPack çš„å®ä¾‹æ‰§è¡Œ        loader: &#39;happypack/loader?id=happyBabel&#39;,        include: [resolve(&#39;src&#39;)],        //æ’é™¤node_modules ç›®å½•ä¸‹çš„æ–‡ä»¶        exclude: /node_modules/      },    ]  },  plugins: [    new HappyPack({        //ç”¨idæ¥æ ‡è¯† happypackå¤„ç†é‚£é‡Œç±»æ–‡ä»¶      id: &#39;happyBabel&#39;,      //å¦‚ä½•å¤„ç†  ç”¨æ³•å’Œloader çš„é…ç½®ä¸€æ ·      loaders: [{        loader: &#39;babel-loader?cacheDirectory=true&#39;,      }],      //å…±äº«è¿›ç¨‹æ±       threadPool: happyThreadPool,      //å…è®¸ HappyPack è¾“å‡ºæ—¥å¿—      verbose: true,    })  ]}</code></pre><h4 id="DllPlugin-å’Œ-DllReferencePlugin"><a href="#DllPlugin-å’Œ-DllReferencePlugin" class="headerlink" title="DllPlugin å’Œ DllReferencePlugin"></a>DllPlugin å’Œ DllReferencePlugin</h4><p>åŸç†ï¼šæˆ‘ä»¬çš„é¡¹ç›®ä¾èµ–ä¸­é€šå¸¸ä¼šå¼•ç”¨å¤§é‡çš„ npm åŒ…ï¼Œè€Œè¿™äº›åŒ…åœ¨æ­£å¸¸çš„å¼€å‘è¿‡ç¨‹ä¸­å¹¶ä¸ä¼šè¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯åœ¨æ¯ä¸€æ¬¡æ„å»ºè¿‡ç¨‹ä¸­å´éœ€è¦åå¤çš„å°†å…¶è§£æï¼Œè€Œä¸‹é¢ä»‹ç»çš„ä¸¤ä¸ªæ’ä»¶å°±æ˜¯ç”¨æ¥è§„é¿æ­¤ç±»æŸè€—çš„ï¼š<br>DllPlugin æ’ä»¶ï¼šä½œç”¨æ˜¯é¢„å…ˆç¼–è¯‘ä¸€äº›æ¨¡å—ã€‚<br>DllReferencePlugin æ’ä»¶ï¼šå®ƒçš„æ‰€ç”¨åˆ™æ˜¯æŠŠè¿™äº›é¢„å…ˆç¼–è¯‘å¥½çš„æ¨¡å—å¼•ç”¨èµ·æ¥ã€‚<br>æ³¨æ„ï¼šDllPlugin å¿…é¡»è¦åœ¨ DllReferencePlugin æ‰§è¡Œå‰å…ˆæ‰§è¡Œä¸€æ¬¡ã€‚</p><pre><code>1ã€åœ¨ build æ–‡ä»¶å¤¹ä¸­æ–°å»º webpack.dll.conf.js æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼ˆä¸»è¦æ˜¯é…ç½®ä¸‹éœ€è¦æå‰ç¼–è¯‘æ‰“åŒ…çš„åº“ï¼‰ï¼šconst path = require(&#39;path&#39;);const webpack = require(&#39;webpack&#39;);module.exports = {  entry: {    vendor: [&#39;vue/dist/vue.common.js&#39;,            &#39;vue-router&#39;,            &#39;axios&#39;,            &#39;vuex&#39;,            &#39;element-ui&#39;]  },  output: {    path: path.join(__dirname, &#39;../static/js&#39;),    filename: &#39;[name].dll.js&#39;,    library: &#39;[name]_library&#39;       // vendor.dll.jsä¸­æš´éœ²å‡ºçš„å…¨å±€å˜é‡å  },  plugins: [    new webpack.DllPlugin({      path: path.join(__dirname, &#39;.&#39;, &#39;[name]-manifest.json&#39;),      name: &#39;[name]_library&#39;    }),    new webpack.optimize.UglifyJsPlugin({      compress: {        warnings: false      }    })  ]};2ã€ç¼–è¾‘ package.json æ–‡ä»¶ï¼Œæ·»åŠ ä¸€æ¡ç¼–è¯‘å‘½ä»¤ï¼š    dll: webpack --config webpack.dll.conf.jsæ¥ç€æ‰§è¡Œ npm run dll å‘½ä»¤æ¥ç”Ÿæˆ vendor.dll.jsã€‚æ³¨æ„ï¼šå¦‚æœä¹‹åè¿™äº›éœ€è¦é¢„ç¼–è¯‘çš„åº“åˆæœ‰å˜åŠ¨ï¼Œåˆ™éœ€å†æ¬¡æ‰§è¡Œ npm run dll å‘½ä»¤æ¥é‡æ–°ç”Ÿæˆ vendor.dll.js3ã€index.html è¿™è¾¹å°† vendor.dll.js å¼•å…¥è¿›æ¥ï¼š&lt;script src=â€˜./static/js/vendor.dll.jsâ€™&gt;&lt;/script&gt;4ã€æ‰“å¼€ build/webpack.base.conf.js æ–‡ä»¶ï¼Œç¼–è¾‘æ·»åŠ å¦‚ä¸‹é«˜äº®é…ç½®ï¼Œä½œç”¨æ˜¯é€šè¿‡ DLLReferencePlugin æ¥ä½¿ç”¨ DllPlugin ç”Ÿæˆçš„ DLL Bundleã€‚const webpack = require(&#39;webpack&#39;);module.exports = {  context: path.resolve(__dirname, &#39;../&#39;),  entry: {    app: &#39;./src/main.js&#39;  },  //.....  plugins: [     // æ·»åŠ DllReferencePluginæ’ä»¶     new webpack.DllReferencePlugin({       context: path.resolve(__dirname, &#39;..&#39;),       manifest: require(&#39;./vendor-manifest.json&#39;)     }),  ]}</code></pre>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
          <category> webpack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
